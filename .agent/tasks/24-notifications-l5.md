# 任务指示：升级 Notifications 模块至 L5 成熟度

## 当前状态与目标
- **模块名称**：`notifications`（通知）
- **当前等级**：L4 (7.1分)
- **目标等级**：L5 (全维度稳定 ≥9分)
- **短板分析**：测试覆盖 D3(7分)，文档 D4(6分)，UI/UX D5(6分)，性能优化 D8(6分)

## 具体任务分解

### 1. 增加测试覆盖 (D3 目标: 9)
该模块拥有优良的设计模式 (adapters 适配器)，但覆盖率仅为 45.6%。
- 补充适配器分发测试：使用 mock 构建发送流程分支流的单元测试。
- 完成对核心 `actions/` 的成功、失败及异常状态触发的校验覆盖。

### 2. 补充底层说明文档 (D4 目标: 9)
当前仅 36 个 JSDoc。虽然有 32k 字需求文档，但代码内嵌注释相对不足。
- 为每个短信/邮件/站内信的具体渠道 `adapter` 加入详细参数说明与返回结构的 JSDoc。
- 对于各种常量、enum 与 DB schema 操作予以明晰。

### 3. 增强性能与可运维性 (D8 & D7 目标: 9)
目前 2 缓存, 4 分页。对于历史记录拉取操作，必须提供更好的分页能力。
- 增加历史通知清单分页（查询或 action 方法增加游标/页码机制，且添加对响应数据的分页封套）。
- 确保所有 adapter 发送失败的时都有规范的 `logger.error` 回溯记录，同时包含 trace ID 与发送负载，以达到 D7 >= 9 的运维要求。

### 4. 补充 UI 状态展示 (D5 目标: 9)
目前前台仅有 2 个组件，1 个路由。
- 确保通知气泡、列表框使用了 WebSocket 或轮询的合理策略，并加入恰当的微交互。
- 加入空状态(Empty State)展示设计与错误组件(Error Boundary)。

## 验收标准
1. `pnpm test src/features/notifications` 测试全部稳定通过。
2. 保持 D2 质量 (0 any)，所有改动符合 Typescript 严谨语法。
3. `pnpm run lint` 验证无瑕疵。
4. **必须使用中文**进行代码注释、提交记录和进度反馈。

完成上述所有修改后，使用 `verification-before-completion` 验证。
