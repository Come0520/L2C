# 任务指示：升级 Products 模块至 L5 成熟度

## 当前状态与目标
- **模块名称**：`products`（商品）
- **当前等级**：L4 (7.5分)
- **目标等级**：L5 (全维度稳定 ≥9分)
- **短板分析**：测试覆盖 D3(7分)，文档 D4(7分)，性能优化 D8(7分)

## 具体任务分解

### 1. 增加全面的测试覆盖 (D3 目标: 9)
代码量大（6.3k行），测试覆盖率 34.4% 不够充分。
- 特别针对 `src/features/products/actions/` 内的各种计算（如模板解析、上下架策略计算等）增加边界测试。
- 确保所有的写入行为和抛错均包含 `vitest` 支持的并发校验或数据库 mock 测试。

### 2. 精密化文档体系 (D4 目标: 9)
尽管已经有 96 JSDoc 和需求文档，因为模块功能较多（商品、供应商、包件、模板），JSDoc 的完备性需要深入到所有内部服务层方法。
- 清理掉全模块最后遗留的仅仅 1 个 `any` 对象。
- 所有的数据访问方法补充完整输入与输出参数含义、可能的抛错类型（Raises）之中文 JSDoc。

### 3. 层叠性性能优化 (D8 目标: 9)
模块当前有 55 个缓存与 14 个分页，依然被评价为 7 分，说明深层级商品关系拉取和大规模检索对 DB 可能有压力。
- 校验现有查询是否缺乏并列索引、或者是 n+1 查询问题。
- 将热点聚合接口使用 `unstable_cache` 进一步加固。
- 确保查询包含强分页。

### 4. 继续巩固强项 (D5 & D6 & D7)
- 对于其已经比较强的 UI(17组件) 和安全治理(244 Zod / 40个以上日志和审计)不能出现疏漏或倒退。新加的代码必须全部带上这些合规约束。

## 验收标准
1. `pnpm test src/features/products` 测试全部稳定通过，并发与异常处理表现良好。
2. 消除此模块中最后的一处 `any` 声明。不抛出新的 tsc/lint 错误。
3. `pnpm run lint` 验证无瑕疵。
4. **必须使用中文**进行代码注释、提交记录和进度反馈。

完成上述所有修改后，使用 `verification-before-completion` 验证。
