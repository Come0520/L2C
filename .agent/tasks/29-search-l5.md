# Search (全局搜索) 模块 L5 升级任务

## 任务目标
将 `search` 模块从 **L3 (5.8)** 提升至 **L5**。目前测试覆盖率为 71%，该模块承担着系统检索的流量入口重任，其安全性和性能都需要补强。

## 当前短板与改进方向

### 1. D8: 性能优化 (当前: 5分) 🟡
- **现状**：发现 3 个缓存点，但由于是频繁触发的搜索功能，缺少必需的前端防抖（Debounce）或更为强力的缓存策略。
- **任务**：
  - 排查其 React 组件（如果有搜索栏UI），必须确保应用了合理的防抖逻辑。
  - 全局搜索的只读查询后端（Actions）考虑结合 `unstable_cache` 提供短时缓存缓解数据库压力。

### 2. D6: 安全规范 (当前: 5分) 🟡
- **现状**：Zod 和 tenantId 使用不足。
- **任务**：
  - 对于传递到数据库执行 ILIKE / MATCH 搜索的参数，必须先用 Zod 确认长度和特殊字符剔除。
  - 并发或联合搜索的所有子查询都必须受到 `eq(table.tenantId, tenantId)` 的拦截限制。

### 3. D4: 文档完整性 (当前: 5分) 🟡
- **现状**：10个 JSDoc。全局搜索包含复杂的倒排或联合查询逻辑。
- **任务**：
  - 对核心的执行引擎动作和接口提供详细的 **中文 JSDoc** 解释各参数行为。

## 执行要求
1. **语言**：全工作流务必使用简体中文。
2. **测试要求**：现有测试覆盖率要保持不降，最好补写一两个由于防抖/参数校验引发的新增测试。
3. **日志规范**：所有的异常检索结果都应该被捕获记录 `logger.error`。
