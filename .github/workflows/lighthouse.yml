name: Lighthouse Performance Audit

on:
  pull_request:
    branches: [main, master]

jobs:
  lighthouse-audit:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Install pnpm
      uses: pnpm/action-setup@v3
      with:
        version: 9.15.0

    - name: Install dependencies
      run: pnpm install --frozen-lockfile

    - name: Build Application
      run: pnpm build

    # 由于这里是复杂后台系统，通常需要会话和数据库运行，Lighthouse CI
    # 的执行环境通常更具挑战。此处建立占位或静态检测骨架。
    - name: Run Lighthouse CI (Mock implementation)
      run: |
        echo "Lighthouse CI audit starting..."
        # TODO: 接入真实的 lighthouse-ci 并配置本地或 mock server
        # 例如 npx lhci autorun
        echo "Lighthouse audit passed setup phase."
