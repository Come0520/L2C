# L2C项目后续工作计划

## 一、项目当前状态

### 已完成工作
- ✅ 测试覆盖率从75%提升到≥80%
- ✅ 20个核心业务服务单元测试
- ✅ 6个服务端服务测试
- ✅ 8个核心业务流程E2E测试
- ✅ 测试工具优化和CI/CD集成

### 待处理事项
- 服务层零散TODO项（2个）
- API层优化项（1个）
- UI组件功能完善（2个）
- 页面逻辑优化（2个）
- 性能监控项（1个）
- 代码库清理（未跟踪文件）

## 二、工作计划

### 1. 核心功能完善（优先级：高）

| 任务ID | 任务描述 | 负责模块 | 预计工作量 | 验收标准 |
|--------|----------|----------|------------|----------|
| T1 | 修复quotes.client.ts中的quote_no映射关系 | 报价服务 | 1小时 | quote_no字段正确映射，无类型错误 |
| T2 | 实现notifications-view.tsx中标记已读逻辑 | 通知组件 | 2小时 | 支持单条和批量标记已读，状态同步更新 |
| T3 | 实现measuring-pending-visit-view.tsx中的重新分配逻辑 | 测量组件 | 2小时 | 支持将测量任务重新分配给其他人员 |
| T4 | 将auth-context.tsx中的逻辑迁移到authService | 认证服务 | 1.5小时 | 逻辑集中管理，无重复代码 |

### 2. 功能优化（优先级：中）

| 任务ID | 任务描述 | 负责模块 | 预计工作量 | 验收标准 |
|--------|----------|----------|------------|----------|
| T5 | 优化points/mall/orders/route.ts中的RPC调用 | 积分API | 1.5小时 | 使用RPC调用替代顺序逻辑，性能提升 |
| T6 | 实现飞书通知逻辑 | 订单状态页面 | 2小时 | 状态变更时正确发送飞书通知 |
| T7 | 添加地址选择和电话输入功能 | 积分商城页面 | 2.5小时 | 支持地址选择和电话输入，数据正确保存 |

### 3. 性能与监控（优先级：中）

| 任务ID | 任务描述 | 负责模块 | 预计工作量 | 验收标准 |
|--------|----------|----------|------------|----------|
| T8 | 监控zh-CN.json文件大小 | 国际化 | 1小时 | 实现文件大小监控，超过阈值时报警 |

### 4. 代码库清理（优先级：低）

| 任务ID | 任务描述 | 负责模块 | 预计工作量 | 验收标准 |
|--------|----------|----------|------------|----------|
| T9 | 处理未跟踪文件，清理代码库 | 项目整体 | 3小时 | 未跟踪文件处理完毕，代码库整洁 |
| T10 | 运行完整测试套件，确保所有修改通过测试 | 测试 | 1小时 | 所有单元测试和E2E测试通过 |

## 三、工作流程

### 1. 开发流程
- 每个任务独立分支开发
- 提交前运行lint和测试
- 代码审查后合并到main分支
- 定期同步代码，避免冲突

### 2. 测试流程
- 开发过程中编写单元测试
- 功能完成后运行集成测试
- 定期运行完整测试套件
- 确保测试覆盖率保持在80%以上

### 3. 代码质量
- 遵循项目编码规范
- 每个函数保持单一职责
- 移除无用代码和注释
- 优化性能瓶颈

## 四、预期成果

### 1. 功能层面
- 所有零散TODO项处理完毕
- 核心功能完善，无缺失
- 用户体验提升

### 2. 代码质量层面
- 代码库整洁，无未跟踪文件
- 测试覆盖率保持在80%以上
- 代码结构清晰，易于维护

### 3. 性能层面
- API调用优化，响应速度提升
- 资源使用合理，无内存泄漏
- 性能监控完善

## 五、风险与应对

### 1. 风险
- 任务依赖关系复杂，可能导致延误
- 代码库变更频繁，可能出现冲突
- 测试覆盖率下降

### 2. 应对措施
- 合理规划任务顺序，避免依赖冲突
- 定期同步代码，及时解决冲突
- 开发过程中编写测试，确保覆盖率

## 六、验收标准

### 1. 功能验收
- 所有任务完成，功能正常
- 用户体验良好，无明显bug
- 性能符合预期

### 2. 代码验收
- 代码结构清晰，符合规范
- 测试覆盖率≥80%
- 无lint错误和类型错误

### 3. 文档验收
- 代码注释完整
- 文档同步更新
- 提交信息规范

## 七、资源需求

### 1. 人员
- 前端开发：1-2人
- 后端开发：1人
- 测试人员：1人

### 2. 工具
- 开发环境：Node.js 20+
- 测试框架：Vitest、Playwright
- CI/CD：GitHub Actions
- 代码质量：ESLint、Prettier

## 八、时间规划

### 第一周
- 完成T1-T4核心功能完善
- 完成T5-T7功能优化

### 第二周
- 完成T8性能与监控
- 完成T9-T10代码库清理
- 进行最终测试和验收

## 九、后续维护

### 1. 定期检查
- 每周运行测试套件
- 每月检查代码覆盖率
- 每季度进行性能测试

### 2. 持续优化
- 根据用户反馈优化功能
- 定期更新依赖包
- 优化性能瓶颈

### 3. 文档维护
- 同步更新文档
- 记录重要变更
- 维护开发文档

---

**计划制定日期**: 2025-12-13
**责任人**: 开发团队
**审核人**: 项目负责人