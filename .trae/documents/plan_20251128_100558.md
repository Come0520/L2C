# 报价单状态调整方案

## 1. 状态简化设计

根据用户需求，将报价单版本状态简化为三个核心状态：

| 状态值 | 状态名称 | 描述 |
|--------|----------|------|
| `draft` | 草稿 | 报价单正在创建中，尚未完成 |
| `preliminary` | 初稿 | 报价单已完成，可提供给客户参考 |
| `confirmed` | 已确认 | 客户已确认该报价单版本 |
| `cancelled` | 已取消 | 报价单版本被取消（保留异常状态） |
| `expired` | 已过期 | 报价单版本超出有效期（保留异常状态） |

## 2. 状态流转调整

### 2.1 简化的状态流转图

```
draft → preliminary → confirmed
       ↓          ↓
       cancelled  expired
```

### 2.2 流转规则
- 草稿状态可直接转为初稿或取消
- 初稿状态可转为已确认、取消或过期
- 已确认状态为最终状态，不可再修改
- 支持从任意状态创建新版本

## 3. 多版本管理优化

### 3.1 版本创建时机
- 获得需求时即可创建多个报价版本
- 支持同时编辑多个版本
- 每个版本独立保存，互不影响

### 3.2 版本关系
- 支持从现有版本复制创建新版本
- 支持设置默认版本，方便客户查看
- 保留所有版本的完整历史记录

## 4. 调整内容

### 4.1 文档更新
- 更新《报价单多版本设计方案.md》，简化状态流转
- 更新《单据状态设计.md》中的报价单状态定义

### 4.2 前端类型定义
- 更新 `quote.ts` 中的状态类型
- 更新 `lead.ts` 中的报价详情状态

### 4.3 前端状态配置
- 更新 `quote-status.ts` 中的状态配置
- 移除审核相关的状态和操作

### 4.4 业务流程
- 移除报价单审核环节
- 简化报价单创建和发送流程
- 优化多版本创建和管理流程

## 5. 实施建议

1. **后端实现**：
   - 简化报价单版本的状态管理
   - 移除审核相关的API和逻辑
   - 优化版本创建和复制功能

2. **前端实现**：
   - 更新报价详情组件，支持新的状态流转
   - 优化版本创建和管理界面
   - 简化操作流程，提高用户体验

3. **数据库设计**：
   - 保持现有表结构不变
   - 仅更新状态字段的枚举值

## 6. 预期效果

- 简化报价单管理流程，提高效率
- 支持在获得需求时创建多版方案
- 方便客户选择和确认报价
- 保留完整的版本历史记录
- 降低系统复杂度，便于维护

该调整方案完全符合用户需求，简化了报价单状态管理，同时保持了对多版本管理的支持，能够更好地适应实际业务场景。