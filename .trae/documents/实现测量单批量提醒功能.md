# 实现测量单批量提醒功能

## 1. 功能分析

当前 `measuring-pending-visit-view.tsx` 组件已经有了单个测量单的催单功能，但批量提醒功能还在 TODO 状态。需要实现：

- 批量选择 UI：在表格中添加复选框，允许用户选择多个测量单
- 批量提醒逻辑：调用通知服务批量发送提醒
- 验证测试：确保功能正常工作

## 2. 实现步骤

### 2.1 添加批量选择状态管理

在 `MeasuringPendingVisitView` 组件中添加：
- `selectedMeasurements` 状态：用于存储选中的测量单 ID
- `isAllSelected` 状态：用于全选功能

### 2.2 修改表格 UI

1. 在表格头部添加全选复选框
2. 在表格行中添加单行选择复选框
3. 实现选择逻辑：
   - 单行选择/取消选择
   - 全选/取消全选
   - 批量选择状态同步

### 2.3 完善批量提醒功能

1. 修改 `handleBatchRemind` 函数：
   - 检查是否有选中的测量单
   - 调用批量提醒 API
   - 显示操作结果

2. 在 `measurementService` 中添加批量提醒方法：
   - 实现 `batchRemindMeasurements` 函数
   - 调用通知服务发送批量提醒

### 2.4 测试验证

1. 测试批量选择功能：
   - 单个选择
   - 全选/取消全选
   - 部分选择

2. 测试批量提醒功能：
   - 选择多个测量单后点击批量提醒
   - 检查通知是否发送成功
   - 检查操作结果提示

## 3. 代码实现

### 3.1 修改 `measuring-pending-visit-view.tsx`

1. 添加选择状态管理
2. 修改表格添加复选框
3. 实现选择逻辑
4. 完善批量提醒函数

### 3.2 修改 `measurements.client.ts`

添加 `batchRemindMeasurements` 方法，用于调用批量提醒 API

## 4. 预期效果

- 用户可以在表格中选择多个测量单
- 点击批量提醒按钮后，系统会发送批量提醒通知
- 操作完成后显示成功或失败提示
- 功能符合 VibeCoding 敏捷 5S 规则，代码简洁、结构清晰

## 5. 遵循的规则

- 代码符合团队命名规范
- 函数职责单一
- 无无用代码和注释
- 遵循 React 最佳实践
- 符合 VibeCoding 敏捷 5S 规则

## 6. 测试计划

1. 手动测试批量选择功能
2. 手动测试批量提醒功能
3. 确保现有功能不受影响
4. 验证代码符合规范