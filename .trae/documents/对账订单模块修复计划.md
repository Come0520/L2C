## 对账订单模块修复计划

### 问题分析
1. **缺少模块文件**：在AppModule中导入了`ReconciliationOrdersModule`，但在reconciliation-orders目录下没有找到对应的模块文件
2. **销售订单缺少金额关联**：SalesOrder实体中没有定义与SalesOrderAmount的反向关联（amount字段），但在服务中使用了`salesOrder.amount.totalAmount`
3. **状态管理不规范**：对账订单状态使用硬编码字符串，建议使用枚举类型
4. **缺少DTO验证**：创建和更新对账单时没有使用DTO进行数据验证
5. **错误处理不一致**：控制器中的错误处理返回格式不一致

### 修复方案

#### 1. 创建ReconciliationOrdersModule模块文件
- 路径：`src/reconciliation-orders/reconciliation-orders.module.ts`
- 内容：定义对账订单模块，导入TypeOrmModule和相关控制器、服务

#### 2. 修复SalesOrder实体
- 在SalesOrder实体中添加与SalesOrderAmount的反向关联
- 添加`@OneToOne`装饰器，关联到SalesOrderAmount实体

#### 3. 优化状态管理
- 创建对账订单状态枚举类型
- 在实体和服务中使用枚举类型替代硬编码字符串

#### 4. 添加DTO验证
- 创建`CreateReconciliationOrderDto`和`UpdateReconciliationOrderDto`
- 使用class-validator进行数据验证
- 在控制器中使用DTO替代any类型

#### 5. 统一错误处理
- 规范控制器中的错误处理返回格式
- 确保所有错误都返回一致的JSON格式

#### 6. 优化服务层代码
- 确保销售订单金额关联正确获取
- 添加必要的验证逻辑
- 优化查询性能

### 实施步骤
1. 创建ReconciliationOrdersModule模块文件
2. 修改SalesOrder实体，添加amount关联
3. 创建对账订单状态枚举
4. 创建DTO验证类
5. 更新控制器，使用DTO和统一错误处理
6. 优化服务层代码
7. 测试修复后的功能

### 预期结果
- 对账订单模块能够正常启动
- 销售订单金额能够正确关联和获取
- 状态管理更加规范和类型安全
- 数据验证能够防止无效数据进入系统
- 错误处理返回格式统一
- 服务层代码更加健壮和高效