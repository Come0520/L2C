# 开单模块完善计划

## 需求分析
根据26状态流程图，开单模块需要支持以下核心功能：
1. 两种开单触发方式：从线索跟踪页面报价或直接开单
2. 报价单多版本管理（草稿、初稿等状态）
3. 报价单生成与导出功能（Excel、PDF）
4. 线索"已报价"标签自动更新
5. 报价单状态流转管理

## 当前实现情况

### 前端实现
- ✅ 已实现开单页面和表单组件
- ✅ 支持从线索ID初始化开单
- ✅ 支持套餐选择和商品管理
- ✅ 支持保存草稿和提交订单
- ❌ 缺少报价单多版本管理
- ❌ 缺少报价单状态管理
- ❌ 缺少报价单导出功能
- ❌ 缺少线索"已报价"标签自动更新

### 数据库支持
- ✅ 销售订单表支持关联线索和客户
- ✅ 支持套餐和商品管理
- ❌ 缺少独立的报价单表
- ❌ 缺少报价单状态字段
- ❌ 缺少报价单版本管理
- ❌ 缺少线索"已报价"标签字段

## 完善计划

### 1. 数据库设计优化
- 创建独立的报价单表（quotes），支持多版本管理
- 为报价单添加状态字段（草稿、初稿、正式等）
- 为线索表添加"已报价"标签字段
- 建立报价单与销售订单的关联关系

### 2. 前端功能完善
- 实现报价单多版本管理界面
- 添加报价单状态流转功能
- 实现报价单导出为Excel和PDF功能
- 实现线索"已报价"标签自动更新
- 优化开单流程，支持从线索直接生成报价单

### 3. API接口开发
- 报价单CRUD接口
- 报价单状态流转接口
- 报价单导出接口
- 线索标签更新接口

### 4. 集成测试
- 测试从线索生成报价单的流程
- 测试报价单多版本管理
- 测试报价单导出功能
- 测试线索标签自动更新

## 预期效果
- 完全支持26状态流程图中的开单需求
- 实现报价单的完整生命周期管理
- 支持多种开单触发方式
- 提供完善的报价单导出功能
- 实现线索状态的自动更新

## 实施步骤
1. 数据库表结构调整
2. API接口开发
3. 前端功能实现
4. 集成测试
5. 部署上线