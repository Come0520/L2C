# 重新设计状态变更权限矩阵

## 1. 订单全流程顺序梳理

根据文档内容，订单的全流程顺序为：

1. 线索分配
2. 安排测量
3. 分配测量师
4. 确认测量
5. 推单处理
6. 审核下单
7. 生成采购单
8. 整单发货
9. 填写快递单号
10. 安排安装
11. 分配安装师
12. 安装师接单
13. 完成安装
14. 上传安装图片
15. 审核安装结果
16. 财务对账
17. 开具发票
18. 确认回款
19. 取消订单
20. 修改备注

## 2. 角色梳理

根据文档内容，系统中涉及的角色包括：

| 角色    | 描述              |
| ----- | --------------- |
| 销售人员  | 负责线索跟踪、方案确认、推单等 |
| 派单员   | 负责分配测量师和安装师     |
| 测量师   | 负责上门测量          |
| 安装师   | 负责上门安装          |
| 订单客服  | 负责审核下单、填写快递单号等  |
| 财务    | 负责对账、开票、确认回款等   |
| 销售负责人 | 负责销售团队管理        |
| 渠道负责人 | 负责渠道管理          |
| 领导    | 负责审批等高级权限       |
| 客户    | 负责确认方案、查看订单等    |
| 业务    | 负责线索分配等         |
| 管理员   | 拥有所有权限          |

## 3. 权限矩阵设计

### 3.1 矩阵结构

| 状态流转   | 销售人员 | 派单员 | 测量师 | 安装师 | 订单客服 | 财务 | 销售负责人 | 渠道负责人 | 领导 | 客户 | 业务 | 管理员 |
| ------ | ---- | --- | --- | --- | ---- | -- | ----- | ----- | -- | -- | -- | --- |
| 线索分配   | ❌    | ❌   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ✅  | ✅   |
| 安排测量   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ✅     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 分配测量师  | ❌    | ✅   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 确认测量   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ✅     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 推单处理   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 审核下单   | ❌    | ❌   | ❌   | ❌   | ✅    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 生成采购单  | ❌    | ❌   | ❌   | ❌   | ✅    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 整单发货   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 填写快递单号 | ❌    | ❌   | ❌   | ❌   | ✅    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 安排安装   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ✅     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 分配安装师  | ❌    | ✅   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 安装师接单  | ❌    | ❌   | ❌   | ✅   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 完成安装   | ❌    | ❌   | ❌   | ✅   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 上传安装图片 | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 审核安装结果 | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 财务对账   | ❌    | ❌   | ❌   | ❌   | ❌    | ✅  | ❌     | ❌     | ✅  | ❌  | ❌  | ✅   |
| 开具发票   | ❌    | ❌   | ❌   | ❌   | ❌    | ✅  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 确认回款   | ❌    | ❌   | ❌   | ❌   | ❌    | ✅  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |
| 取消订单   | ✅    | ❌   | ❌   | ❌   | ❌    | ❌  | ✅     | ❌     | ❌  | ✅  | ❌  | ✅   |
| 修改备注   | ✅    | ❌   | ❌   | ❌   | ✅    | ✅  | ❌     | ❌     | ❌  | ❌  | ❌  | ✅   |

## 4. 关键调整说明

### 4.1 生成采购单权限调整

- **调整原因**：根据用户反馈，L2C系统专注销售，采购单由订单客服填写，采购单的由来由其他系统处理
- **调整内容**：将生成采购单的权限从销售人员调整为订单客服

### 4.2 确认安装的明确

- **确认安装**：指安装师完成上门安装后，销售人员审核安装结果的步骤，对应文档中的"审核安装结果"，已调整为"审核安装结果"以避免歧义

### 4.3 安装流程细化

- 将安装流程细化为：分配安装师 → 安装师接单 → 完成安装 → 上传安装图片 → 审核安装结果
- 确保每个步骤的权限明确，符合业务流程

## 5. 设计原则

1. **全流程顺序**：状态流转按照订单的实际业务流程顺序排列
2. **最小权限原则**：每个角色只拥有完成其职责所需的最小权限
3. **职责分离原则**：不同职责的操作由不同角色执行
4. **清晰明确**：权限矩阵清晰易懂，避免歧义
5. **业务聚焦**：聚焦L2C系统的销售流程，不涉及其他系统的职责

## 6. 实施步骤

1. 更新状态变更权限矩阵表格，按照订单全流程顺序排列状态流转
2. 调整生成采购单的权限为订单客服
3. 细化安装流程，明确每个步骤的含义
4. 确保矩阵与文档中各状态的权限控制描述一致
5. 验证每个角色的权限是否符合其职责
6. 检查是否遗漏了任何关键状态流转
7. 检查是否遗漏了任何角色

## 7. 预期成果

* 按照订单全流程顺序排列的状态变更权限矩阵
* 包含所有角色和关键状态流转
* 权限矩阵与文档中各状态的权限控制描述一致
* 权限设置符合业务聚焦原则，生成采购单由订单客服负责
* 安装流程细化，每个步骤含义明确
* 权限矩阵清晰易懂，便于团队理解和使用

## 8. 验证方法

* 与文档中各状态的权限控制描述进行对比
* 与业务流程进行对比，确保权限设置合理
* 邀请相关角色代表进行评审，确保权限设置符合实际需求

