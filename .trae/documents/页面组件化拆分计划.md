# 页面组件化拆分计划

## 问题分析

通过对代码库的分析，我发现以下页面体量偏大，需要进行组件化拆分：

1. **线索管理页面** (`src/app/leads/page.tsx`) - 38KB
2. **商品管理页面** (`src/app/products/page.tsx`) - 35KB

这些页面包含了大量的业务逻辑、UI组件和状态管理，导致代码难以维护和扩展。

## 拆分目标

1. 每个组件职责单一，代码量控制在合理范围内
2. 提高代码复用性和可维护性
3. 优化页面加载性能
4. 便于团队协作开发

## 拆分计划

### 1. 线索管理页面 (`src/app/leads/page.tsx`)

#### 现有结构分析
- 包含模拟数据（278-277行）
- 统计卡片区域（574-613行）
- 预约提醒区域（615-649行）
- 多个对话框和抽屉组件
- 复杂的状态管理和过滤逻辑

#### 拆分方案

| 组件名称 | 职责 | 拆分内容 | 文件路径 |
|---------|------|----------|----------|
| `LeadMockData` | 提供模拟数据 | 提取模拟数据到单独文件 | `src/features/leads/utils/mock-data.ts` |
| `LeadStatsCards` | 展示线索状态统计 | 提取统计卡片区域 | `src/features/leads/components/dashboard/lead-stats-cards.tsx` |
| `AppointmentReminders` | 展示预约提醒 | 提取预约提醒区域 | `src/features/leads/components/dashboard/appointment-reminders.tsx` |
| `LeadImportDialog` | 处理线索导入 | 提取导入对话框逻辑 | `src/features/leads/components/import/lead-import-dialog.tsx` |
| `LeadDedupeDialog` | 处理线索去重 | 提取去重对话框逻辑 | `src/features/leads/components/dedupe/lead-dedupe-dialog.tsx` |
| `LeadNotificationsPanel` | 展示通知 | 提取通知面板逻辑 | `src/features/leads/components/notifications/lead-notifications-panel.tsx` |
| `useLeadFilters` | 处理过滤逻辑 | 提取过滤逻辑到自定义hook | `src/features/leads/hooks/use-lead-filters.ts` |

### 2. 商品管理页面 (`src/app/products/page.tsx`)

#### 现有结构分析
- 包含5个标签页内容
- 商品详情模态框
- 复杂的分类选项生成逻辑
- 筛选和搜索功能

#### 拆分方案

| 组件名称 | 职责 | 拆分内容 | 文件路径 |
|---------|------|----------|----------|
| `ProductArchivesTab` | 商品档案标签页 | 提取商品档案标签页内容 | `src/features/products/components/tabs/product-archives-tab.tsx` |
| `CategoryManagementTab` | 分类管理标签页 | 提取分类管理标签页内容 | `src/features/products/components/tabs/category-management-tab.tsx` |
| `StoreStrategyTab` | 门店策略标签页 | 提取门店策略标签页内容 | `src/features/products/components/tabs/store-strategy-tab.tsx` |
| `SpecialCraftsTab` | 特殊工艺标签页 | 提取特殊工艺标签页内容 | `src/features/products/components/tabs/special-crafts-tab.tsx` |
| `ApprovalsTab` | 审批管理标签页 | 提取审批管理标签页内容 | `src/features/products/components/tabs/approvals-tab.tsx` |
| `ProductDetailModal` | 商品详情模态框 | 提取并优化商品详情模态框 | `src/features/products/components/details/product-detail-modal.tsx` |
| `useProductFilters` | 处理商品过滤 | 提取过滤逻辑到自定义hook | `src/features/products/hooks/use-product-filters.ts` |
| `categoryUtils` | 分类选项生成 | 提取分类选项生成逻辑 | `src/features/products/utils/category-utils.ts` |

## 实施步骤

1. **第一步**：创建组件目录结构
   - 在 `src/features/leads/components` 和 `src/features/products/components` 下创建相应的子目录

2. **第二步**：拆分通用逻辑
   - 提取模拟数据、工具函数和自定义hooks

3. **第三步**：拆分UI组件
   - 按照计划逐步拆分各个UI组件

4. **第四步**：优化导入方式
   - 确保组件按需导入，优化页面加载性能

5. **第五步**：测试和验证
   - 确保拆分后的页面功能正常
   - 检查是否有性能提升

## 预期效果

1. 页面代码量减少，便于维护
2. 组件复用性提高
3. 页面加载性能优化
4. 便于团队协作开发
5. 符合单一职责原则

## 技术规范

- 组件命名：使用 PascalCase 格式
- 文件命名：组件文件使用 PascalCase，工具文件使用 camelCase
- 状态管理：尽量使用 React Hooks，避免复杂的组件状态
- 代码风格：遵循项目现有的代码风格规范
- 类型定义：完善组件的 TypeScript 类型定义

## 风险评估

1. **拆分过度**：避免将组件拆分得过于细碎，导致组件数量过多，增加维护成本
2. **性能影响**：确保组件拆分不会导致性能下降，合理使用 React.memo 和 useMemo
3. **依赖关系**：注意组件之间的依赖关系，避免出现循环依赖
4. **测试覆盖**：确保拆分后的组件有足够的测试覆盖

## 实施时间

建议在1-2周内完成所有页面的组件化拆分，具体时间可根据团队资源和优先级调整。