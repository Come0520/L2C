# 云展厅 (Showroom) 模块

## 1. 业务愿景与核心职能
“云展厅”为销售及商务代表（Sales/B端用户）提供线上向采购方（C端用户）分享数字化互动资产的统一容器。
主要承载能力包含：
- **核心素材库 (Showroom Items)**：能够根据各种类别(`categoryId`)、标签及热度得分(`score`)展示和维护可被浏览的商品或通用组件资产。可以快速进行搜索及按最新(latest)、热点(views/score) 维度下钻排列。
- **自定义分享链 (Showroom Shares)**：销售可以将单一或组合类的素材通过配置特定的“临时改价”(overridePrice) 封装并产生唯一对外公开链接用于投喂客户。

## 2. 素材与计分引擎
所有的素材 (Items) 都被纳入自动评估打分机制 (Scoring Algorithm)。
- **维度参考：** 除了创建时间影响时效热度外，更侧重在客户查看 (Views) 和转换时的反馈。
- 该系统底层要求任何涉及更改内容的动作都将强制使用 `AuditService.log` 收口记录留痕。

## 3. 分享与防刷架构机制 (Shares Anti-Spam)
面对不特定的公网读取（通常会分享在微信/邮箱中），需要重点防止数据库穿透和资源滥刷。
- **Ip 限流处理**：使用公用 Redis 限流池，`ratelimit:showroom` 控制特定来源。
- **采样回写机制**：因为高并发分享链点击，若每次 View 都回写 DB จะ大幅加重主库负担。当前采用了 **10%** 采样阈值：客户端每次点击必推向 Redis 加速器并记数，但仅在满足概率阀门时（`Math.random() < 0.1`），再连带之前累加积攒的水位统一更新回 `showroomShares` 实体主表中的 `views` 字段内。

## 4. 全局概览仪表盘 (Dashboard Stats)
租户的管理者可以直接获取租户级别的数据全局统计（`getShareDashboardStats` API），它提供当前总计发行了多少分享包？所有分享包汇聚总产生了多少有效受众游览量？以及近期（7 天内）生成了多数新的活跃分享活动。

*本文档建立/更新于 Showroom L4 级升档期间，旨在保留数据驱动策略的底层设计背景与逻辑限制。*
