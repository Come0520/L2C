# ç½—è±L2Cé”€å”®ç®¡ç†ç³»ç»Ÿ - æ ¸å¿ƒä¸šåŠ¡æ¨¡å—é›†æˆè®¾è®¡æ–¹æ¡ˆ

## æ–‡æ¡£ä¿¡æ¯
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
- **åˆ›å»ºæ—¥æœŸ**: 2024å¹´12æœˆ
- **æ–‡æ¡£çŠ¶æ€**: æ­£å¼ç‰ˆ
- **é€‚ç”¨èŒƒå›´**: ç¬¬ä¸€æœŸMVPæ ¸å¿ƒä¸šåŠ¡æ¨¡å—

## 1. æ ¸å¿ƒä¸šåŠ¡æ¨¡å—æ€»è§ˆ

### 1.1 æ¨¡å—æ¶æ„å›¾
```mermaid
graph TB
    subgraph "æ ¸å¿ƒä¸šåŠ¡å±‚"
        A[åº“å­˜ç®¡ç†æ¨¡å—] --> G[è®¢å•ç®¡ç†æ¨¡å—]
        B[è´¢åŠ¡ç®¡ç†æ¨¡å—] --> G
        C[ç‰©æµç®¡ç†æ¨¡å—] --> G
        D[å®¢æˆ·å…³ç³»ç®¡ç†æ¨¡å—] --> G
        E[ä¾›åº”å•†ç®¡ç†æ¨¡å—] --> A
        F[åˆåŒç®¡ç†æ¨¡å—] --> G
    end
    
    subgraph "åŸºç¡€æœåŠ¡å±‚"
        H[ç”¨æˆ·è®¤è¯æ¨¡å—]
        I[æƒé™ç®¡ç†æ¨¡å—]
        J[é€šçŸ¥ç³»ç»Ÿæ¨¡å—]
        K[æ–‡ä»¶ç®¡ç†æ¨¡å—]
    end
    
    subgraph "æ•°æ®å±‚"
        L[MySQLæ•°æ®åº“]
        M[Redisç¼“å­˜]
        N[æ¶ˆæ¯é˜Ÿåˆ—]
    end
    
    A --> H
    B --> H
    C --> H
    D --> H
    E --> H
    F --> H
    
    G --> L
    A --> L
    B --> L
    C --> L
    D --> L
    E --> L
    F --> L
    
    A --> M
    B --> M
    G --> N
```

### 1.2 æ¨¡å—ä¾èµ–å…³ç³»
```typescript
interface ModuleDependencies {
  // æ ¸å¿ƒä¾èµ–å…³ç³»
  dependencies: {
    è®¢å•ç®¡ç†: ["åº“å­˜ç®¡ç†", "è´¢åŠ¡ç®¡ç†", "ç‰©æµç®¡ç†", "å®¢æˆ·å…³ç³»ç®¡ç†", "åˆåŒç®¡ç†"];
    åº“å­˜ç®¡ç†: ["ä¾›åº”å•†ç®¡ç†", "äº§å“ç®¡ç†"];
    è´¢åŠ¡ç®¡ç†: ["è®¢å•ç®¡ç†", "ä¾›åº”å•†ç®¡ç†", "åˆåŒç®¡ç†"];
    ç‰©æµç®¡ç†: ["è®¢å•ç®¡ç†", "åº“å­˜ç®¡ç†"];
    å®¢æˆ·å…³ç³»ç®¡ç†: ["è®¢å•ç®¡ç†", "çº¿ç´¢ç®¡ç†"];
    ä¾›åº”å•†ç®¡ç†: ["åº“å­˜ç®¡ç†", "è´¢åŠ¡ç®¡ç†"];
    åˆåŒç®¡ç†: ["è®¢å•ç®¡ç†", "è´¢åŠ¡ç®¡ç†", "å®¢æˆ·å…³ç³»ç®¡ç†"];
  };
  
  // æ•°æ®æµå‘
  dataFlow: {
    "çº¿ç´¢ â†’ å®¢æˆ· â†’ è®¢å• â†’ åº“å­˜ â†’ ç‰©æµ â†’ è´¢åŠ¡": "ä¸»ä¸šåŠ¡æµç¨‹";
    "ä¾›åº”å•† â†’ åº“å­˜ â†’ è®¢å•": "ä¾›åº”é“¾æµç¨‹";
    "åˆåŒ â†’ è®¢å• â†’ è´¢åŠ¡": "åˆåŒæ‰§è¡Œæµç¨‹";
  };
}
```

## 2. åº“å­˜ç®¡ç†æ¨¡å—å¢å¼ºè®¾è®¡

### 2.1 æ ¸å¿ƒåŠŸèƒ½å¢å¼º
```typescript
interface EnhancedInventoryService {
  // æ™ºèƒ½åº“å­˜é¢„è­¦
  smartInventoryAlert: {
    dynamicThreshold: "åŸºäºé”€å”®è¶‹åŠ¿åŠ¨æ€è°ƒæ•´é¢„è­¦é˜ˆå€¼";
    seasonalForecast: "å­£èŠ‚æ€§éœ€æ±‚é¢„æµ‹";
    supplierLeadTime: "ä¾›åº”å•†äº¤æœŸé¢„æµ‹";
    autoReorder: "è‡ªåŠ¨è¡¥è´§å»ºè®®";
  };
  
  // å¤šä»“åº“ååŒ
  multiWarehouseSync: {
    realTimeSync: "å®æ—¶åº“å­˜åŒæ­¥";
    crossWarehouseTransfer: "è·¨ä»“åº“è°ƒæ‹¨";
    distributedInventory: "åˆ†å¸ƒå¼åº“å­˜ç®¡ç†";
    warehouseOptimization: "ä»“åº“å¸ƒå±€ä¼˜åŒ–";
  };
  
  // åº“å­˜æˆæœ¬ä¼˜åŒ–
  costOptimization: {
    fifoLifoWeighted: "å¤šç§æˆæœ¬æ ¸ç®—æ–¹æ³•";
    batchTracking: "æ‰¹æ¬¡è¿½è¸ªç®¡ç†";
    expiryManagement: "ä¿è´¨æœŸç®¡ç†";
    obsoleteInventory: "å‘†æ»åº“å­˜å¤„ç†";
  };
}
```

### 2.2 åº“å­˜çŠ¶æ€æµè½¬å¢å¼º
```typescript
enum EnhancedInventoryStatus {
  AVAILABLE = "available",           // å¯ç”¨åº“å­˜
  RESERVED = "reserved",             // å·²é¢„ç•™
  IN_TRANSIT = "in_transit",         // åœ¨é€”åº“å­˜
  QUALITY_CHECK = "quality_check",   // è´¨æ£€ä¸­
  DAMAGED = "damaged",               // æŸå
  EXPIRED = "expired",               // è¿‡æœŸ
  OBSOLETE = "obsolete",             // å‘†æ»
  ALLOCATED = "allocated",           // å·²åˆ†é…
  PICKED = "picked",                 // å·²æ‹£è´§
  SHIPPED = "shipped"                // å·²å‘è´§
}

interface InventoryStatusFlow {
  transitions: {
    [key in EnhancedInventoryStatus]: EnhancedInventoryStatus[];
  };
  
  businessRules: {
    autoTransition: "è‡ªåŠ¨çŠ¶æ€è½¬æ¢è§„åˆ™";
    manualApproval: "éœ€è¦äººå·¥å®¡æ‰¹çš„çŠ¶æ€è½¬æ¢";
    systemTrigger: "ç³»ç»Ÿè§¦å‘çš„çŠ¶æ€å˜æ›´";
  };
}
```

## 3. è´¢åŠ¡ç®¡ç†æ¨¡å—å®Œå–„è®¾è®¡

### 3.1 è´¢åŠ¡æ ¸å¿ƒæ¶æ„
```typescript
interface FinancialManagementSystem {
  // æ”¶æ¬¾ç®¡ç†
  receivableManagement: {
    orderPayment: "è®¢å•æ”¶æ¬¾ç®¡ç†";
    installmentPayment: "åˆ†æœŸä»˜æ¬¾ç®¡ç†";
    advancePayment: "é¢„æ”¶æ¬¾ç®¡ç†";
    refundManagement: "é€€æ¬¾ç®¡ç†";
    paymentReconciliation: "æ”¶æ¬¾å¯¹è´¦";
  };
  
  // åº”ä»˜ç®¡ç†
  payableManagement: {
    supplierPayment: "ä¾›åº”å•†ä»˜æ¬¾";
    expensePayment: "è´¹ç”¨æ”¯ä»˜";
    employeeReimbursement: "å‘˜å·¥æŠ¥é”€";
    taxPayment: "ç¨è´¹ç¼´çº³";
    paymentApproval: "ä»˜æ¬¾å®¡æ‰¹æµç¨‹";
  };
  
  // æˆæœ¬æ ¸ç®—
  costAccounting: {
    productCost: "äº§å“æˆæœ¬æ ¸ç®—";
    serviceCost: "æœåŠ¡æˆæœ¬æ ¸ç®—";
    operatingCost: "è¿è¥æˆæœ¬æ ¸ç®—";
    profitAnalysis: "åˆ©æ¶¦åˆ†æ";
    costAllocation: "æˆæœ¬åˆ†æ‘Š";
  };
  
  // è´¢åŠ¡æŠ¥è¡¨
  financialReporting: {
    incomeStatement: "æŸç›Šè¡¨";
    balanceSheet: "èµ„äº§è´Ÿå€ºè¡¨";
    cashFlowStatement: "ç°é‡‘æµé‡è¡¨";
    salesReport: "é”€å”®æŠ¥è¡¨";
    costReport: "æˆæœ¬æŠ¥è¡¨";
  };
}
```

### 3.2 è´¢åŠ¡æ•°æ®æ¨¡å‹
```sql
-- è´¢åŠ¡ç§‘ç›®è¡¨
CREATE TABLE financial_accounts (
    id BIGSERIAL PRIMARY KEY,
    account_code VARCHAR(20) NOT NULL UNIQUE COMMENT 'ç§‘ç›®ç¼–ç ',
    account_name VARCHAR(100) NOT NULL COMMENT 'ç§‘ç›®åç§°',
    account_type VARCHAR(20) NOT NULL COMMENT 'ç§‘ç›®ç±»å‹ï¼šasset-èµ„äº§,liability-è´Ÿå€º,equity-æƒç›Š,revenue-æ”¶å…¥,expense-è´¹ç”¨',
    parent_id BIGINT COMMENT 'çˆ¶ç§‘ç›®ID',
    level INT NOT NULL DEFAULT 1 COMMENT 'ç§‘ç›®çº§åˆ«',
    is_leaf BOOLEAN DEFAULT TRUE COMMENT 'æ˜¯å¦å¶å­èŠ‚ç‚¹',
    is_active BOOLEAN DEFAULT TRUE COMMENT 'æ˜¯å¦å¯ç”¨',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (parent_id) REFERENCES financial_accounts(id),
    INDEX idx_account_code (account_code),
    INDEX idx_account_type (account_type),
    INDEX idx_parent_id (parent_id)
);

-- è´¢åŠ¡å‡­è¯è¡¨
CREATE TABLE financial_vouchers (
    id BIGSERIAL PRIMARY KEY,
    voucher_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'å‡­è¯å·',
    voucher_date DATE NOT NULL COMMENT 'å‡­è¯æ—¥æœŸ',
    voucher_type VARCHAR(20) NOT NULL COMMENT 'å‡­è¯ç±»å‹ï¼šreceipt-æ”¶æ¬¾,payment-ä»˜æ¬¾,transfer-è½¬è´¦',
    business_type VARCHAR(30) NOT NULL COMMENT 'ä¸šåŠ¡ç±»å‹ï¼šorder_payment-è®¢å•æ”¶æ¬¾,supplier_payment-ä¾›åº”å•†ä»˜æ¬¾',
    reference_id BIGINT COMMENT 'å…³è”ä¸šåŠ¡ID',
    reference_no VARCHAR(50) COMMENT 'å…³è”ä¸šåŠ¡å•å·',
    total_amount DECIMAL(15,2) NOT NULL COMMENT 'å‡­è¯æ€»é‡‘é¢',
    description TEXT COMMENT 'æ‘˜è¦è¯´æ˜',
    status VARCHAR(20) DEFAULT 'draft' COMMENT 'çŠ¶æ€ï¼šdraft-è‰ç¨¿,approved-å·²å®¡æ ¸,posted-å·²è¿‡è´¦',
    created_by BIGINT NOT NULL COMMENT 'åˆ¶å•äºº',
    approved_by BIGINT COMMENT 'å®¡æ ¸äºº',
    approved_at TIMESTAMP COMMENT 'å®¡æ ¸æ—¶é—´',
    posted_by BIGINT COMMENT 'è¿‡è´¦äºº',
    posted_at TIMESTAMP COMMENT 'è¿‡è´¦æ—¶é—´',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (created_by) REFERENCES users(id),
    FOREIGN KEY (approved_by) REFERENCES users(id),
    FOREIGN KEY (posted_by) REFERENCES users(id),
    INDEX idx_voucher_no (voucher_no),
    INDEX idx_voucher_date (voucher_date),
    INDEX idx_voucher_type (voucher_type),
    INDEX idx_business_type (business_type),
    INDEX idx_reference (reference_id, reference_no),
    INDEX idx_status (status)
);

-- è´¢åŠ¡å‡­è¯æ˜ç»†è¡¨
CREATE TABLE financial_voucher_entries (
    id BIGSERIAL PRIMARY KEY,
    voucher_id BIGINT NOT NULL COMMENT 'å‡­è¯ID',
    account_id BIGINT NOT NULL COMMENT 'ç§‘ç›®ID',
    debit_amount DECIMAL(15,2) NOT NULL DEFAULT 0 COMMENT 'å€Ÿæ–¹é‡‘é¢',
    credit_amount DECIMAL(15,2) NOT NULL DEFAULT 0 COMMENT 'è´·æ–¹é‡‘é¢',
    description TEXT COMMENT 'æ‘˜è¦',
    auxiliary_info JSON COMMENT 'è¾…åŠ©ä¿¡æ¯ï¼šå®¢æˆ·ã€ä¾›åº”å•†ã€é¡¹ç›®ç­‰',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (voucher_id) REFERENCES financial_vouchers(id),
    FOREIGN KEY (account_id) REFERENCES financial_accounts(id),
    INDEX idx_voucher_id (voucher_id),
    INDEX idx_account_id (account_id)
);
```

## 4. ç‰©æµç®¡ç†æ¨¡å—è®¾è®¡

### 4.1 ç‰©æµç®¡ç†æ¶æ„
```typescript
interface LogisticsManagementSystem {
  // é…é€ç®¡ç†
  deliveryManagement: {
    routePlanning: "é…é€è·¯çº¿è§„åˆ’";
    vehicleScheduling: "è½¦è¾†è°ƒåº¦ç®¡ç†";
    driverAssignment: "å¸æœºåˆ†é…";
    deliveryTracking: "é…é€è·Ÿè¸ª";
    deliveryConfirmation: "é…é€ç¡®è®¤";
  };
  
  // ä»“å‚¨ç®¡ç†
  warehouseManagement: {
    warehouseLayout: "ä»“åº“å¸ƒå±€ç®¡ç†";
    pickingOptimization: "æ‹£è´§è·¯å¾„ä¼˜åŒ–";
    packingManagement: "åŒ…è£…ç®¡ç†";
    shippingManagement: "å‘è´§ç®¡ç†";
    returnProcessing: "é€€è´§å¤„ç†";
  };
  
  // ç¬¬ä¸‰æ–¹ç‰©æµ
  thirdPartyLogistics: {
    carrierIntegration: "æ‰¿è¿å•†é›†æˆ";
    shippingRateComparison: "è¿è´¹æ¯”è¾ƒ";
    trackingIntegration: "ç‰©æµè·Ÿè¸ªé›†æˆ";
    performanceMonitoring: "ç‰©æµç»©æ•ˆç›‘æ§";
  };
  
  // å®‰è£…æœåŠ¡
  installationService: {
    appointmentScheduling: "å®‰è£…é¢„çº¦";
    installerAssignment: "å®‰è£…å¸ˆå‚…åˆ†é…";
    installationTracking: "å®‰è£…è¿›åº¦è·Ÿè¸ª";
    qualityInspection: "å®‰è£…è´¨é‡æ£€æŸ¥";
    customerSatisfaction: "å®¢æˆ·æ»¡æ„åº¦è°ƒæŸ¥";
  };
}
```

### 4.2 ç‰©æµæ•°æ®æ¨¡å‹
```sql
-- ç‰©æµä»»åŠ¡è¡¨
CREATE TABLE logistics_tasks (
    id BIGSERIAL PRIMARY KEY,
    task_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'ä»»åŠ¡ç¼–å·',
    order_id BIGINT NOT NULL COMMENT 'è®¢å•ID',
    task_type VARCHAR(20) NOT NULL COMMENT 'ä»»åŠ¡ç±»å‹ï¼šdelivery-é…é€,pickup-å–è´§,installation-å®‰è£…',
    priority VARCHAR(10) DEFAULT 'normal' COMMENT 'ä¼˜å…ˆçº§ï¼šhigh-é«˜,normal-æ™®é€š,low-ä½',
    scheduled_date DATE COMMENT 'è®¡åˆ’æ—¥æœŸ',
    scheduled_time_start TIME COMMENT 'è®¡åˆ’å¼€å§‹æ—¶é—´',
    scheduled_time_end TIME COMMENT 'è®¡åˆ’ç»“æŸæ—¶é—´',
    actual_start_time TIMESTAMP COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time TIMESTAMP COMMENT 'å®é™…ç»“æŸæ—¶é—´',
    status VARCHAR(20) DEFAULT 'pending' COMMENT 'çŠ¶æ€ï¼špending-å¾…å¤„ç†,assigned-å·²åˆ†é…,in_progress-è¿›è¡Œä¸­,completed-å·²å®Œæˆ,cancelled-å·²å–æ¶ˆ',
    assigned_to BIGINT COMMENT 'åˆ†é…ç»™ï¼ˆå¸æœº/å®‰è£…å¸ˆå‚…ï¼‰',
    vehicle_id BIGINT COMMENT 'è½¦è¾†ID',
    delivery_address TEXT NOT NULL COMMENT 'é…é€åœ°å€',
    contact_person VARCHAR(50) COMMENT 'è”ç³»äºº',
    contact_phone VARCHAR(15) COMMENT 'è”ç³»ç”µè¯',
    special_instructions TEXT COMMENT 'ç‰¹æ®Šè¯´æ˜',
    completion_notes TEXT COMMENT 'å®Œæˆå¤‡æ³¨',
    customer_signature TEXT COMMENT 'å®¢æˆ·ç­¾å',
    photos JSON COMMENT 'ç°åœºç…§ç‰‡',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (order_id) REFERENCES sales_orders(id),
    FOREIGN KEY (assigned_to) REFERENCES users(id),
    INDEX idx_task_no (task_no),
    INDEX idx_order_id (order_id),
    INDEX idx_task_type (task_type),
    INDEX idx_status (status),
    INDEX idx_scheduled_date (scheduled_date),
    INDEX idx_assigned_to (assigned_to)
);

-- è½¦è¾†ç®¡ç†è¡¨
CREATE TABLE vehicles (
    id BIGSERIAL PRIMARY KEY,
    vehicle_no VARCHAR(20) NOT NULL UNIQUE COMMENT 'è½¦ç‰Œå·',
    vehicle_type VARCHAR(20) NOT NULL COMMENT 'è½¦è¾†ç±»å‹ï¼štruck-è´§è½¦,van-é¢åŒ…è½¦,car-è½¿è½¦',
    brand VARCHAR(50) COMMENT 'å“ç‰Œ',
    model VARCHAR(50) COMMENT 'å‹å·',
    capacity DECIMAL(8,2) COMMENT 'è½½é‡é‡(å¨)',
    volume DECIMAL(8,2) COMMENT 'å®¹ç§¯(ç«‹æ–¹ç±³)',
    driver_id BIGINT COMMENT 'é»˜è®¤å¸æœºID',
    status VARCHAR(20) DEFAULT 'available' COMMENT 'çŠ¶æ€ï¼šavailable-å¯ç”¨,busy-å¿™ç¢Œ,maintenance-ç»´ä¿®,retired-æŠ¥åºŸ',
    insurance_expiry DATE COMMENT 'ä¿é™©åˆ°æœŸæ—¥',
    inspection_expiry DATE COMMENT 'å¹´æ£€åˆ°æœŸæ—¥',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (driver_id) REFERENCES users(id),
    INDEX idx_vehicle_no (vehicle_no),
    INDEX idx_vehicle_type (vehicle_type),
    INDEX idx_status (status),
    INDEX idx_driver_id (driver_id)
);
```

## 5. å®¢æˆ·å…³ç³»ç®¡ç†(CRM)æ¨¡å—è®¾è®¡

### 5.1 CRMæ ¸å¿ƒæ¶æ„
```typescript
interface CRMSystem {
  // å®¢æˆ·ç®¡ç†
  customerManagement: {
    customerProfile: "å®¢æˆ·æ¡£æ¡ˆç®¡ç†";
    customerSegmentation: "å®¢æˆ·åˆ†ç¾¤";
    customerLifecycle: "å®¢æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†";
    customerValue: "å®¢æˆ·ä»·å€¼åˆ†æ";
    customerService: "å®¢æˆ·æœåŠ¡ç®¡ç†";
  };
  
  // é”€å”®ç®¡ç†
  salesManagement: {
    salesOpportunity: "é”€å”®æœºä¼šç®¡ç†";
    salesFunnel: "é”€å”®æ¼æ–—åˆ†æ";
    salesForecast: "é”€å”®é¢„æµ‹";
    salesPerformance: "é”€å”®ç»©æ•ˆåˆ†æ";
    territoryManagement: "é”€å”®åŒºåŸŸç®¡ç†";
  };
  
  // è¥é”€ç®¡ç†
  marketingManagement: {
    campaignManagement: "è¥é”€æ´»åŠ¨ç®¡ç†";
    leadNurturing: "çº¿ç´¢åŸ¹è‚²";
    emailMarketing: "é‚®ä»¶è¥é”€";
    socialMediaMarketing: "ç¤¾äº¤åª’ä½“è¥é”€";
    marketingROI: "è¥é”€ROIåˆ†æ";
  };
  
  // å®¢æˆ·æœåŠ¡
  customerService: {
    ticketManagement: "å·¥å•ç®¡ç†";
    knowledgeBase: "çŸ¥è¯†åº“";
    serviceLevel: "æœåŠ¡æ°´å¹³ç®¡ç†";
    customerFeedback: "å®¢æˆ·åé¦ˆç®¡ç†";
    satisfactionSurvey: "æ»¡æ„åº¦è°ƒæŸ¥";
  };
}
```

### 5.2 CRMæ•°æ®æ¨¡å‹
```sql
-- å®¢æˆ·æ¡£æ¡ˆè¡¨
CREATE TABLE customers (
    id BIGSERIAL PRIMARY KEY,
    customer_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'å®¢æˆ·ç¼–å·',
    customer_name VARCHAR(100) NOT NULL COMMENT 'å®¢æˆ·å§“å',
    customer_type VARCHAR(20) DEFAULT 'individual' COMMENT 'å®¢æˆ·ç±»å‹ï¼šindividual-ä¸ªäºº,enterprise-ä¼ä¸š',
    gender VARCHAR(10) COMMENT 'æ€§åˆ«ï¼šmale-ç”·,female-å¥³',
    birth_date DATE COMMENT 'å‡ºç”Ÿæ—¥æœŸ',
    id_card VARCHAR(18) COMMENT 'èº«ä»½è¯å·',
    phone VARCHAR(15) NOT NULL COMMENT 'æ‰‹æœºå·',
    email VARCHAR(100) COMMENT 'é‚®ç®±',
    wechat VARCHAR(50) COMMENT 'å¾®ä¿¡å·',
    address TEXT COMMENT 'åœ°å€',
    company_name VARCHAR(100) COMMENT 'å…¬å¸åç§°',
    position VARCHAR(50) COMMENT 'èŒä½',
    industry VARCHAR(50) COMMENT 'è¡Œä¸š',
    source VARCHAR(30) COMMENT 'å®¢æˆ·æ¥æºï¼šonline-çº¿ä¸Š,offline-çº¿ä¸‹,referral-æ¨è',
    source_detail VARCHAR(100) COMMENT 'æ¥æºè¯¦æƒ…',
    assigned_sales BIGINT COMMENT 'åˆ†é…é”€å”®',
    customer_level VARCHAR(20) DEFAULT 'normal' COMMENT 'å®¢æˆ·ç­‰çº§ï¼švip-VIP,gold-é‡‘ç‰Œ,silver-é“¶ç‰Œ,normal-æ™®é€š',
    credit_limit DECIMAL(15,2) DEFAULT 0 COMMENT 'ä¿¡ç”¨é¢åº¦',
    payment_terms VARCHAR(50) COMMENT 'ä»˜æ¬¾æ¡ä»¶',
    status VARCHAR(20) DEFAULT 'active' COMMENT 'çŠ¶æ€ï¼šactive-æ´»è·ƒ,inactive-ä¸æ´»è·ƒ,blacklist-é»‘åå•',
    tags JSON COMMENT 'å®¢æˆ·æ ‡ç­¾',
    notes TEXT COMMENT 'å¤‡æ³¨',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (assigned_sales) REFERENCES users(id),
    INDEX idx_customer_no (customer_no),
    INDEX idx_phone (phone),
    INDEX idx_email (email),
    INDEX idx_customer_type (customer_type),
    INDEX idx_assigned_sales (assigned_sales),
    INDEX idx_customer_level (customer_level),
    INDEX idx_status (status)
);

-- å®¢æˆ·äº’åŠ¨è®°å½•è¡¨
CREATE TABLE customer_interactions (
    id BIGSERIAL PRIMARY KEY,
    customer_id BIGINT NOT NULL COMMENT 'å®¢æˆ·ID',
    interaction_type VARCHAR(30) NOT NULL COMMENT 'äº’åŠ¨ç±»å‹ï¼šcall-ç”µè¯,email-é‚®ä»¶,meeting-ä¼šé¢,visit-æ‹œè®¿,wechat-å¾®ä¿¡',
    direction VARCHAR(10) NOT NULL COMMENT 'æ–¹å‘ï¼šinbound-æ¥ç”µ,outbound-å¤–å‘¼',
    subject VARCHAR(200) COMMENT 'ä¸»é¢˜',
    content TEXT COMMENT 'å†…å®¹',
    duration INT COMMENT 'æŒç»­æ—¶é—´(åˆ†é’Ÿ)',
    outcome VARCHAR(50) COMMENT 'ç»“æœ',
    next_action VARCHAR(200) COMMENT 'ä¸‹ä¸€æ­¥è¡ŒåŠ¨',
    next_action_date DATE COMMENT 'ä¸‹ä¸€æ­¥è¡ŒåŠ¨æ—¥æœŸ',
    sales_person BIGINT NOT NULL COMMENT 'é”€å”®äººå‘˜',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (customer_id) REFERENCES customers(id),
    FOREIGN KEY (sales_person) REFERENCES users(id),
    INDEX idx_customer_id (customer_id),
    INDEX idx_interaction_type (interaction_type),
    INDEX idx_sales_person (sales_person),
    INDEX idx_created_at (created_at)
);
```

## 6. ä¾›åº”å•†ç®¡ç†æ¨¡å—è®¾è®¡

### 6.1 ä¾›åº”å•†ç®¡ç†æ¶æ„
```typescript
interface SupplierManagementSystem {
  // ä¾›åº”å•†æ¡£æ¡ˆ
  supplierProfile: {
    basicInfo: "åŸºæœ¬ä¿¡æ¯ç®¡ç†";
    qualificationManagement: "èµ„è´¨ç®¡ç†";
    performanceEvaluation: "ç»©æ•ˆè¯„ä¼°";
    riskAssessment: "é£é™©è¯„ä¼°";
    categoryManagement: "ä¾›åº”å•†åˆ†ç±»ç®¡ç†";
  };
  
  // é‡‡è´­ç®¡ç†
  procurementManagement: {
    purchaseRequisition: "é‡‡è´­ç”³è¯·";
    purchaseOrder: "é‡‡è´­è®¢å•";
    receiptManagement: "æ”¶è´§ç®¡ç†";
    qualityInspection: "è´¨é‡æ£€éªŒ";
    invoiceVerification: "å‘ç¥¨æ ¸éªŒ";
  };
  
  // åˆåŒç®¡ç†
  contractManagement: {
    contractNegotiation: "åˆåŒè°ˆåˆ¤";
    contractSigning: "åˆåŒç­¾ç½²";
    contractExecution: "åˆåŒæ‰§è¡Œ";
    contractRenewal: "åˆåŒç»­ç­¾";
    contractTermination: "åˆåŒç»ˆæ­¢";
  };
  
  // ä»˜æ¬¾ç®¡ç†
  paymentManagement: {
    paymentTerms: "ä»˜æ¬¾æ¡ä»¶";
    paymentSchedule: "ä»˜æ¬¾è®¡åˆ’";
    paymentExecution: "ä»˜æ¬¾æ‰§è¡Œ";
    paymentReconciliation: "ä»˜æ¬¾å¯¹è´¦";
  };
}
```

### 6.2 ä¾›åº”å•†æ•°æ®æ¨¡å‹
```sql
-- ä¾›åº”å•†ä¿¡æ¯è¡¨
CREATE TABLE suppliers (
    id BIGSERIAL PRIMARY KEY,
    supplier_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'ä¾›åº”å•†ç¼–å·',
    supplier_name VARCHAR(100) NOT NULL COMMENT 'ä¾›åº”å•†åç§°',
    supplier_type VARCHAR(20) NOT NULL COMMENT 'ä¾›åº”å•†ç±»å‹ï¼šmanufacturer-åˆ¶é€ å•†,distributor-ç»é”€å•†,service-æœåŠ¡å•†',
    legal_name VARCHAR(100) COMMENT 'æ³•å®šåç§°',
    tax_id VARCHAR(30) COMMENT 'ç¨å·',
    business_license VARCHAR(50) COMMENT 'è¥ä¸šæ‰§ç…§å·',
    contact_person VARCHAR(50) COMMENT 'è”ç³»äºº',
    contact_phone VARCHAR(15) COMMENT 'è”ç³»ç”µè¯',
    contact_email VARCHAR(100) COMMENT 'è”ç³»é‚®ç®±',
    address TEXT COMMENT 'åœ°å€',
    website VARCHAR(200) COMMENT 'ç½‘ç«™',
    established_date DATE COMMENT 'æˆç«‹æ—¥æœŸ',
    registered_capital DECIMAL(15,2) COMMENT 'æ³¨å†Œèµ„æœ¬',
    employee_count INT COMMENT 'å‘˜å·¥æ•°é‡',
    annual_revenue DECIMAL(15,2) COMMENT 'å¹´è¥ä¸šé¢',
    main_products TEXT COMMENT 'ä¸»è¥äº§å“',
    certifications JSON COMMENT 'è®¤è¯èµ„è´¨',
    payment_terms VARCHAR(50) COMMENT 'ä»˜æ¬¾æ¡ä»¶',
    credit_limit DECIMAL(15,2) DEFAULT 0 COMMENT 'ä¿¡ç”¨é¢åº¦',
    supplier_level VARCHAR(20) DEFAULT 'normal' COMMENT 'ä¾›åº”å•†ç­‰çº§ï¼šstrategic-æˆ˜ç•¥,preferred-ä¼˜é€‰,normal-æ™®é€š,restricted-é™åˆ¶',
    status VARCHAR(20) DEFAULT 'active' COMMENT 'çŠ¶æ€ï¼šactive-æ´»è·ƒ,inactive-ä¸æ´»è·ƒ,blacklist-é»‘åå•',
    risk_level VARCHAR(20) DEFAULT 'low' COMMENT 'é£é™©ç­‰çº§ï¼šhigh-é«˜,medium-ä¸­,low-ä½',
    performance_score DECIMAL(5,2) DEFAULT 0 COMMENT 'ç»©æ•ˆè¯„åˆ†',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_supplier_no (supplier_no),
    INDEX idx_supplier_name (supplier_name),
    INDEX idx_supplier_type (supplier_type),
    INDEX idx_supplier_level (supplier_level),
    INDEX idx_status (status),
    INDEX idx_risk_level (risk_level)
);

-- é‡‡è´­è®¢å•è¡¨
CREATE TABLE purchase_orders (
    id BIGSERIAL PRIMARY KEY,
    po_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'é‡‡è´­è®¢å•å·',
    supplier_id BIGINT NOT NULL COMMENT 'ä¾›åº”å•†ID',
    order_date DATE NOT NULL COMMENT 'è®¢å•æ—¥æœŸ',
    expected_delivery_date DATE COMMENT 'é¢„æœŸäº¤è´§æ—¥æœŸ',
    total_amount DECIMAL(15,2) NOT NULL COMMENT 'è®¢å•æ€»é‡‘é¢',
    tax_amount DECIMAL(15,2) DEFAULT 0 COMMENT 'ç¨é¢',
    discount_amount DECIMAL(15,2) DEFAULT 0 COMMENT 'æŠ˜æ‰£é‡‘é¢',
    final_amount DECIMAL(15,2) NOT NULL COMMENT 'æœ€ç»ˆé‡‘é¢',
    currency VARCHAR(10) DEFAULT 'CNY' COMMENT 'å¸ç§',
    payment_terms VARCHAR(50) COMMENT 'ä»˜æ¬¾æ¡ä»¶',
    delivery_address TEXT COMMENT 'äº¤è´§åœ°å€',
    contact_person VARCHAR(50) COMMENT 'è”ç³»äºº',
    contact_phone VARCHAR(15) COMMENT 'è”ç³»ç”µè¯',
    status VARCHAR(20) DEFAULT 'draft' COMMENT 'çŠ¶æ€ï¼šdraft-è‰ç¨¿,sent-å·²å‘é€,confirmed-å·²ç¡®è®¤,partial_received-éƒ¨åˆ†æ”¶è´§,received-å·²æ”¶è´§,cancelled-å·²å–æ¶ˆ',
    notes TEXT COMMENT 'å¤‡æ³¨',
    created_by BIGINT NOT NULL COMMENT 'åˆ›å»ºäºº',
    approved_by BIGINT COMMENT 'å®¡æ‰¹äºº',
    approved_at TIMESTAMP COMMENT 'å®¡æ‰¹æ—¶é—´',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (supplier_id) REFERENCES suppliers(id),
    FOREIGN KEY (created_by) REFERENCES users(id),
    FOREIGN KEY (approved_by) REFERENCES users(id),
    INDEX idx_po_no (po_no),
    INDEX idx_supplier_id (supplier_id),
    INDEX idx_order_date (order_date),
    INDEX idx_status (status),
    INDEX idx_created_by (created_by)
);
```

## 7. åˆåŒç®¡ç†æ¨¡å—è®¾è®¡

### 7.1 åˆåŒç®¡ç†æ¶æ„
```typescript
interface ContractManagementSystem {
  // åˆåŒç”Ÿå‘½å‘¨æœŸ
  contractLifecycle: {
    contractCreation: "åˆåŒåˆ›å»º";
    contractNegotiation: "åˆåŒè°ˆåˆ¤";
    contractApproval: "åˆåŒå®¡æ‰¹";
    contractSigning: "åˆåŒç­¾ç½²";
    contractExecution: "åˆåŒæ‰§è¡Œ";
    contractRenewal: "åˆåŒç»­ç­¾";
    contractTermination: "åˆåŒç»ˆæ­¢";
  };
  
  // åˆåŒæ¨¡æ¿
  contractTemplate: {
    templateManagement: "æ¨¡æ¿ç®¡ç†";
    clauseLibrary: "æ¡æ¬¾åº“";
    templateVersioning: "æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶";
    templateApproval: "æ¨¡æ¿å®¡æ‰¹";
  };
  
  // åˆåŒæ‰§è¡Œ
  contractExecution: {
    milestoneTracking: "é‡Œç¨‹ç¢‘è·Ÿè¸ª";
    deliverableManagement: "äº¤ä»˜ç‰©ç®¡ç†";
    performanceMonitoring: "å±¥çº¦ç›‘æ§";
    changeManagement: "å˜æ›´ç®¡ç†";
    disputeResolution: "äº‰è®®è§£å†³";
  };
  
  // åˆåŒåˆ†æ
  contractAnalytics: {
    contractValue: "åˆåŒä»·å€¼åˆ†æ";
    performanceAnalysis: "å±¥çº¦åˆ†æ";
    riskAnalysis: "é£é™©åˆ†æ";
    renewalAnalysis: "ç»­ç­¾åˆ†æ";
  };
}
```

### 7.2 åˆåŒæ•°æ®æ¨¡å‹
```sql
-- åˆåŒä¸»è¡¨
CREATE TABLE contracts (
    id BIGSERIAL PRIMARY KEY,
    contract_no VARCHAR(30) NOT NULL UNIQUE COMMENT 'åˆåŒç¼–å·',
    contract_name VARCHAR(200) NOT NULL COMMENT 'åˆåŒåç§°',
    contract_type VARCHAR(30) NOT NULL COMMENT 'åˆåŒç±»å‹ï¼šsales-é”€å”®åˆåŒ,purchase-é‡‡è´­åˆåŒ,service-æœåŠ¡åˆåŒ,framework-æ¡†æ¶åˆåŒ',
    template_id BIGINT COMMENT 'åˆåŒæ¨¡æ¿ID',
    party_a_type VARCHAR(20) NOT NULL COMMENT 'ç”²æ–¹ç±»å‹ï¼šcompany-å…¬å¸,customer-å®¢æˆ·',
    party_a_id BIGINT COMMENT 'ç”²æ–¹ID',
    party_a_name VARCHAR(100) NOT NULL COMMENT 'ç”²æ–¹åç§°',
    party_b_type VARCHAR(20) NOT NULL COMMENT 'ä¹™æ–¹ç±»å‹ï¼šcompany-å…¬å¸,supplier-ä¾›åº”å•†',
    party_b_id BIGINT COMMENT 'ä¹™æ–¹ID',
    party_b_name VARCHAR(100) NOT NULL COMMENT 'ä¹™æ–¹åç§°',
    contract_amount DECIMAL(15,2) NOT NULL COMMENT 'åˆåŒé‡‘é¢',
    currency VARCHAR(10) DEFAULT 'CNY' COMMENT 'å¸ç§',
    signing_date DATE COMMENT 'ç­¾ç½²æ—¥æœŸ',
    effective_date DATE NOT NULL COMMENT 'ç”Ÿæ•ˆæ—¥æœŸ',
    expiry_date DATE COMMENT 'åˆ°æœŸæ—¥æœŸ',
    auto_renewal BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦è‡ªåŠ¨ç»­ç­¾',
    renewal_period INT COMMENT 'ç»­ç­¾å‘¨æœŸ(æœˆ)',
    payment_terms TEXT COMMENT 'ä»˜æ¬¾æ¡ä»¶',
    delivery_terms TEXT COMMENT 'äº¤è´§æ¡ä»¶',
    warranty_period INT COMMENT 'è´¨ä¿æœŸ(æœˆ)',
    status VARCHAR(20) DEFAULT 'draft' COMMENT 'çŠ¶æ€ï¼šdraft-è‰ç¨¿,negotiating-è°ˆåˆ¤ä¸­,approving-å®¡æ‰¹ä¸­,signed-å·²ç­¾ç½²,executing-æ‰§è¡Œä¸­,completed-å·²å®Œæˆ,terminated-å·²ç»ˆæ­¢',
    risk_level VARCHAR(20) DEFAULT 'low' COMMENT 'é£é™©ç­‰çº§ï¼šhigh-é«˜,medium-ä¸­,low-ä½',
    contract_file_url VARCHAR(500) COMMENT 'åˆåŒæ–‡ä»¶URL',
    notes TEXT COMMENT 'å¤‡æ³¨',
    created_by BIGINT NOT NULL COMMENT 'åˆ›å»ºäºº',
    approved_by BIGINT COMMENT 'å®¡æ‰¹äºº',
    approved_at TIMESTAMP COMMENT 'å®¡æ‰¹æ—¶é—´',
    signed_by BIGINT COMMENT 'ç­¾ç½²äºº',
    signed_at TIMESTAMP COMMENT 'ç­¾ç½²æ—¶é—´',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (template_id) REFERENCES contract_templates(id),
    FOREIGN KEY (created_by) REFERENCES users(id),
    FOREIGN KEY (approved_by) REFERENCES users(id),
    FOREIGN KEY (signed_by) REFERENCES users(id),
    INDEX idx_contract_no (contract_no),
    INDEX idx_contract_type (contract_type),
    INDEX idx_party_a (party_a_type, party_a_id),
    INDEX idx_party_b (party_b_type, party_b_id),
    INDEX idx_status (status),
    INDEX idx_effective_date (effective_date),
    INDEX idx_expiry_date (expiry_date)
);

-- åˆåŒæ¡æ¬¾è¡¨
CREATE TABLE contract_clauses (
    id BIGSERIAL PRIMARY KEY,
    contract_id BIGINT NOT NULL COMMENT 'åˆåŒID',
    clause_type VARCHAR(30) NOT NULL COMMENT 'æ¡æ¬¾ç±»å‹ï¼špayment-ä»˜æ¬¾,delivery-äº¤è´§,warranty-è´¨ä¿,penalty-è¿çº¦,termination-ç»ˆæ­¢',
    clause_title VARCHAR(200) NOT NULL COMMENT 'æ¡æ¬¾æ ‡é¢˜',
    clause_content TEXT NOT NULL COMMENT 'æ¡æ¬¾å†…å®¹',
    clause_order INT NOT NULL COMMENT 'æ¡æ¬¾é¡ºåº',
    is_key_clause BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦å…³é”®æ¡æ¬¾',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (contract_id) REFERENCES contracts(id),
    INDEX idx_contract_id (contract_id),
    INDEX idx_clause_type (clause_type),
    INDEX idx_clause_order (clause_order)
);
```

## 8. æ¨¡å—é›†æˆæ¥å£è®¾è®¡

### 8.1 æ¨¡å—é—´é€šä¿¡æ¥å£
```typescript
interface ModuleIntegrationAPIs {
  // åº“å­˜ä¸è®¢å•é›†æˆ
  inventoryOrderIntegration: {
    checkInventory: "GET /api/inventory/check/{productId}";
    reserveInventory: "POST /api/inventory/reserve";
    releaseInventory: "POST /api/inventory/release";
    allocateInventory: "POST /api/inventory/allocate";
  };
  
  // è´¢åŠ¡ä¸è®¢å•é›†æˆ
  financeOrderIntegration: {
    createPaymentRecord: "POST /api/finance/payments";
    updatePaymentStatus: "PUT /api/finance/payments/{id}/status";
    generateInvoice: "POST /api/finance/invoices";
    processRefund: "POST /api/finance/refunds";
  };
  
  // ç‰©æµä¸è®¢å•é›†æˆ
  logisticsOrderIntegration: {
    createDeliveryTask: "POST /api/logistics/delivery-tasks";
    updateDeliveryStatus: "PUT /api/logistics/delivery-tasks/{id}/status";
    scheduleInstallation: "POST /api/logistics/installation-tasks";
    trackShipment: "GET /api/logistics/tracking/{trackingNo}";
  };
  
  // CRMä¸è®¢å•é›†æˆ
  crmOrderIntegration: {
    updateCustomerInfo: "PUT /api/crm/customers/{id}";
    recordInteraction: "POST /api/crm/interactions";
    updateCustomerLevel: "PUT /api/crm/customers/{id}/level";
    createServiceTicket: "POST /api/crm/tickets";
  };
  
  // ä¾›åº”å•†ä¸åº“å­˜é›†æˆ
  supplierInventoryIntegration: {
    createPurchaseOrder: "POST /api/suppliers/purchase-orders";
    updateReceiptStatus: "PUT /api/suppliers/receipts/{id}/status";
    updateSupplierPerformance: "PUT /api/suppliers/{id}/performance";
  };
  
  // åˆåŒä¸è®¢å•é›†æˆ
  contractOrderIntegration: {
    validateContractTerms: "POST /api/contracts/validate";
    updateContractExecution: "PUT /api/contracts/{id}/execution";
    checkContractCompliance: "GET /api/contracts/{id}/compliance";
  };
}
```

### 8.2 äº‹ä»¶é©±åŠ¨é›†æˆ
```typescript
interface ModuleEvents {
  // è®¢å•äº‹ä»¶
  orderEvents: {
    OrderCreated: "è®¢å•åˆ›å»ºäº‹ä»¶";
    OrderConfirmed: "è®¢å•ç¡®è®¤äº‹ä»¶";
    OrderCancelled: "è®¢å•å–æ¶ˆäº‹ä»¶";
    OrderCompleted: "è®¢å•å®Œæˆäº‹ä»¶";
  };
  
  // åº“å­˜äº‹ä»¶
  inventoryEvents: {
    InventoryReserved: "åº“å­˜é¢„ç•™äº‹ä»¶";
    InventoryAllocated: "åº“å­˜åˆ†é…äº‹ä»¶";
    InventoryShipped: "åº“å­˜å‘è´§äº‹ä»¶";
    InventoryLowStock: "åº“å­˜ä¸è¶³äº‹ä»¶";
  };
  
  // è´¢åŠ¡äº‹ä»¶
  financeEvents: {
    PaymentReceived: "æ”¶æ¬¾äº‹ä»¶";
    PaymentFailed: "ä»˜æ¬¾å¤±è´¥äº‹ä»¶";
    InvoiceGenerated: "å‘ç¥¨ç”Ÿæˆäº‹ä»¶";
    RefundProcessed: "é€€æ¬¾å¤„ç†äº‹ä»¶";
  };
  
  // ç‰©æµäº‹ä»¶
  logisticsEvents: {
    ShipmentCreated: "å‘è´§åˆ›å»ºäº‹ä»¶";
    ShipmentDelivered: "å‘è´§å®Œæˆäº‹ä»¶";
    InstallationScheduled: "å®‰è£…é¢„çº¦äº‹ä»¶";
    InstallationCompleted: "å®‰è£…å®Œæˆäº‹ä»¶";
  };
}
```

## 9. æ•°æ®ä¸€è‡´æ€§ä¿è¯

### 9.1 åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†
```typescript
interface DistributedTransactionStrategy {
  // Sagaæ¨¡å¼
  sagaPattern: {
    orderProcessingSaga: "è®¢å•å¤„ç†Saga";
    inventoryManagementSaga: "åº“å­˜ç®¡ç†Saga";
    paymentProcessingSaga: "æ”¯ä»˜å¤„ç†Saga";
    compensationHandling: "è¡¥å¿å¤„ç†æœºåˆ¶";
  };
  
  // äº‹ä»¶æº¯æº
  eventSourcing: {
    eventStore: "äº‹ä»¶å­˜å‚¨";
    eventReplay: "äº‹ä»¶é‡æ”¾";
    snapshotting: "å¿«ç…§æœºåˆ¶";
    eventVersioning: "äº‹ä»¶ç‰ˆæœ¬æ§åˆ¶";
  };
  
  // æœ€ç»ˆä¸€è‡´æ€§
  eventualConsistency: {
    asyncProcessing: "å¼‚æ­¥å¤„ç†";
    retryMechanism: "é‡è¯•æœºåˆ¶";
    deadLetterQueue: "æ­»ä¿¡é˜Ÿåˆ—";
    reconciliation: "æ•°æ®å¯¹è´¦";
  };
}
```

### 9.2 æ•°æ®åŒæ­¥ç­–ç•¥
```typescript
interface DataSynchronizationStrategy {
  // å®æ—¶åŒæ­¥
  realTimeSync: {
    changeDataCapture: "å˜æ›´æ•°æ®æ•è·";
    messageBroker: "æ¶ˆæ¯ä»£ç†";
    webhooks: "Webhooké€šçŸ¥";
    streamProcessing: "æµå¤„ç†";
  };
  
  // æ‰¹é‡åŒæ­¥
  batchSync: {
    scheduledJobs: "å®šæ—¶ä»»åŠ¡";
    incrementalSync: "å¢é‡åŒæ­¥";
    fullSync: "å…¨é‡åŒæ­¥";
    conflictResolution: "å†²çªè§£å†³";
  };
  
  // æ•°æ®æ ¡éªŒ
  dataValidation: {
    checksumValidation: "æ ¡éªŒå’ŒéªŒè¯";
    businessRuleValidation: "ä¸šåŠ¡è§„åˆ™éªŒè¯";
    crossModuleValidation: "è·¨æ¨¡å—éªŒè¯";
    dataQualityMonitoring: "æ•°æ®è´¨é‡ç›‘æ§";
  };
}
```

## 10. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 10.1 æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ ¸å¿ƒä¸šåŠ¡è¡¨ç´¢å¼•ä¼˜åŒ–
-- è®¢å•è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_orders_customer_status_date ON sales_orders(customer_id, status, order_date);
CREATE INDEX idx_orders_sales_person_date ON sales_orders(sales_person, order_date);

-- åº“å­˜è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_inventory_product_warehouse ON inventory(product_id, warehouse_id);
CREATE INDEX idx_inventory_status_quantity ON inventory(status, available_quantity);

-- è´¢åŠ¡è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_vouchers_type_date ON financial_vouchers(voucher_type, voucher_date);
CREATE INDEX idx_vouchers_business_reference ON financial_vouchers(business_type, reference_id);

-- å®¢æˆ·è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_customers_sales_level ON customers(assigned_sales, customer_level);
CREATE INDEX idx_customers_type_status ON customers(customer_type, status);

-- åˆ†åŒºè¡¨è®¾è®¡ï¼ˆæŒ‰æ—¶é—´åˆ†åŒºï¼‰
CREATE TABLE sales_orders_2024 PARTITION OF sales_orders
FOR VALUES FROM ('2024-01-01') TO ('2025-01-01');

CREATE TABLE financial_vouchers_2024 PARTITION OF financial_vouchers
FOR VALUES FROM ('2024-01-01') TO ('2025-01-01');
```

### 10.2 ç¼“å­˜ç­–ç•¥
```typescript
interface CachingStrategy {
  // Redisç¼“å­˜å±‚æ¬¡
  cacheHierarchy: {
    L1_ApplicationCache: "åº”ç”¨å†…å­˜ç¼“å­˜";
    L2_RedisCache: "Redisåˆ†å¸ƒå¼ç¼“å­˜";
    L3_DatabaseCache: "æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜";
  };
  
  // ç¼“å­˜æ¨¡å¼
  cachePatterns: {
    cacheAside: "æ—è·¯ç¼“å­˜æ¨¡å¼";
    writeThrough: "å†™é€æ¨¡å¼";
    writeBack: "å†™å›æ¨¡å¼";
    refreshAhead: "é¢„åˆ·æ–°æ¨¡å¼";
  };
  
  // ç¼“å­˜ç­–ç•¥
  cacheStrategies: {
    productInfo: "äº§å“ä¿¡æ¯ç¼“å­˜(TTL: 1å°æ—¶)";
    inventoryStatus: "åº“å­˜çŠ¶æ€ç¼“å­˜(TTL: 5åˆ†é’Ÿ)";
    customerProfile: "å®¢æˆ·æ¡£æ¡ˆç¼“å­˜(TTL: 30åˆ†é’Ÿ)";
    priceInfo: "ä»·æ ¼ä¿¡æ¯ç¼“å­˜(TTL: 15åˆ†é’Ÿ)";
  };
}
```

## 11. ç›‘æ§ä¸å‘Šè­¦

### 11.1 ä¸šåŠ¡ç›‘æ§æŒ‡æ ‡
```typescript
interface BusinessMetrics {
  // è®¢å•æŒ‡æ ‡
  orderMetrics: {
    orderCreationRate: "è®¢å•åˆ›å»ºç‡";
    orderConversionRate: "è®¢å•è½¬åŒ–ç‡";
    orderCancellationRate: "è®¢å•å–æ¶ˆç‡";
    averageOrderValue: "å¹³å‡è®¢å•ä»·å€¼";
    orderProcessingTime: "è®¢å•å¤„ç†æ—¶é—´";
  };
  
  // åº“å­˜æŒ‡æ ‡
  inventoryMetrics: {
    stockTurnoverRate: "åº“å­˜å‘¨è½¬ç‡";
    stockoutRate: "ç¼ºè´§ç‡";
    inventoryAccuracy: "åº“å­˜å‡†ç¡®ç‡";
    warehouseUtilization: "ä»“åº“åˆ©ç”¨ç‡";
  };
  
  // è´¢åŠ¡æŒ‡æ ‡
  financeMetrics: {
    revenueGrowthRate: "æ”¶å…¥å¢é•¿ç‡";
    profitMargin: "åˆ©æ¶¦ç‡";
    cashFlowRatio: "ç°é‡‘æµæ¯”ç‡";
    accountsReceivableTurnover: "åº”æ”¶è´¦æ¬¾å‘¨è½¬ç‡";
  };
  
  // å®¢æˆ·æŒ‡æ ‡
  customerMetrics: {
    customerAcquisitionCost: "å®¢æˆ·è·å–æˆæœ¬";
    customerLifetimeValue: "å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼";
    customerSatisfactionScore: "å®¢æˆ·æ»¡æ„åº¦";
    customerRetentionRate: "å®¢æˆ·ä¿ç•™ç‡";
  };
}
```

### 11.2 å‘Šè­¦è§„åˆ™é…ç½®
```yaml
# ä¸šåŠ¡å‘Šè­¦è§„åˆ™
business_alerts:
  - name: "åº“å­˜ä¸è¶³å‘Šè­¦"
    condition: "available_quantity < min_stock_alert"
    severity: "warning"
    notification: ["inventory_manager", "sales_team"]
    
  - name: "è®¢å•å¼‚å¸¸å‘Šè­¦"
    condition: "order_processing_time > 24_hours"
    severity: "critical"
    notification: ["order_manager", "customer_service"]
    
  - name: "æ”¯ä»˜å¤±è´¥å‘Šè­¦"
    condition: "payment_failure_rate > 5%"
    severity: "high"
    notification: ["finance_manager", "technical_team"]
    
  - name: "å®¢æˆ·æŠ•è¯‰å‘Šè­¦"
    condition: "customer_complaint_count > 10/day"
    severity: "high"
    notification: ["customer_service_manager", "quality_manager"]

# æŠ€æœ¯å‘Šè­¦è§„åˆ™
technical_alerts:
  - name: "APIå“åº”æ—¶é—´å‘Šè­¦"
    condition: "api_response_time > 2000ms"
    severity: "warning"
    notification: ["technical_team"]
    
  - name: "æ•°æ®åº“è¿æ¥å‘Šè­¦"
    condition: "db_connection_pool_usage > 80%"
    severity: "critical"
    notification: ["dba_team", "technical_team"]
    
  - name: "ç¼“å­˜å‘½ä¸­ç‡å‘Šè­¦"
    condition: "cache_hit_rate < 70%"
    severity: "warning"
    notification: ["technical_team"]
```

## 12. éƒ¨ç½²ä¸è¿ç»´

### 12.1 å¾®æœåŠ¡éƒ¨ç½²æ¶æ„
```yaml
# Kuberneteséƒ¨ç½²é…ç½®
apiVersion: apps/v1
kind: Deployment
metadata:
  name: inventory-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: inventory-service
  template:
    metadata:
      labels:
        app: inventory-service
    spec:
      containers:
      - name: inventory-service
        image: l2c/inventory-service:v1.0
        ports:
        - containerPort: 8080
        env:
        - name: DB_HOST
          value: "mysql-cluster"
        - name: REDIS_HOST
          value: "redis-cluster"
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
```

### 12.2 æ•°æ®å¤‡ä»½ç­–ç•¥
```bash
#!/bin/bash
# æ•°æ®åº“å¤‡ä»½è„šæœ¬

# MySQLå¤‡ä»½
mysqldump --single-transaction --routines --triggers \
  --host=$DB_HOST --user=$DB_USER --password=$DB_PASSWORD \
  l2c_database > /backup/mysql/l2c_$(date +%Y%m%d_%H%M%S).sql

# Rediså¤‡ä»½
redis-cli --rdb /backup/redis/dump_$(date +%Y%m%d_%H%M%S).rdb

# æ–‡ä»¶å¤‡ä»½
tar -czf /backup/files/files_$(date +%Y%m%d_%H%M%S).tar.gz /app/uploads

# ä¸Šä¼ åˆ°äº‘å­˜å‚¨
aws s3 sync /backup s3://l2c-backup/$(date +%Y%m%d)/
```

---

## æ€»ç»“

æœ¬æ ¸å¿ƒä¸šåŠ¡æ¨¡å—é›†æˆè®¾è®¡æ–¹æ¡ˆä¸ºç½—è±L2Cé”€å”®ç®¡ç†ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„ä¸šåŠ¡æ”¯æ’‘ä½“ç³»ï¼š

### âœ… **è®¾è®¡äº®ç‚¹**

1. **æ¨¡å—åŒ–æ¶æ„** - 6ä¸ªæ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼ŒèŒè´£æ¸…æ™°ï¼Œè¾¹ç•Œæ˜ç¡®
2. **æ•°æ®ä¸€è‡´æ€§** - åˆ†å¸ƒå¼äº‹åŠ¡ã€äº‹ä»¶é©±åŠ¨ã€æœ€ç»ˆä¸€è‡´æ€§ä¿è¯
3. **é«˜æ€§èƒ½è®¾è®¡** - å¤šçº§ç¼“å­˜ã€æ•°æ®åº“ä¼˜åŒ–ã€å¼‚æ­¥å¤„ç†
4. **å®Œæ•´ç›‘æ§** - ä¸šåŠ¡æŒ‡æ ‡ã€æŠ€æœ¯æŒ‡æ ‡ã€å‘Šè­¦æœºåˆ¶
5. **å¯æ‰©å±•æ€§** - å¾®æœåŠ¡æ¶æ„ã€å®¹å™¨åŒ–éƒ¨ç½²ã€å¼¹æ€§ä¼¸ç¼©

### ğŸ¯ **æ ¸å¿ƒä»·å€¼**

- **ä¸šåŠ¡å®Œæ•´æ€§** - è¦†ç›–é”€å”®å…¨æµç¨‹çš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å—
- **æ•°æ®å‡†ç¡®æ€§** - å¼ºä¸€è‡´æ€§å’Œæœ€ç»ˆä¸€è‡´æ€§ç›¸ç»“åˆ
- **ç³»ç»Ÿç¨³å®šæ€§** - å®Œå–„çš„ç›‘æ§å‘Šè­¦å’Œå®¹é”™æœºåˆ¶
- **è¿ç»´ä¾¿åˆ©æ€§** - è‡ªåŠ¨åŒ–éƒ¨ç½²å’Œè¿ç»´å·¥å…·æ”¯æŒ

### ğŸš€ **å®æ–½å»ºè®®**

1. **åˆ†é˜¶æ®µå®æ–½** - æŒ‰æ¨¡å—ä¼˜å…ˆçº§é€æ­¥å®æ–½
2. **æ•°æ®è¿ç§»** - åˆ¶å®šè¯¦ç»†çš„æ•°æ®è¿ç§»è®¡åˆ’
3. **æ€§èƒ½æµ‹è¯•** - å…¨é¢çš„æ€§èƒ½å’Œå‹åŠ›æµ‹è¯•
4. **ç”¨æˆ·åŸ¹è®­** - å®Œå–„çš„ç”¨æˆ·åŸ¹è®­å’Œæ–‡æ¡£æ”¯æŒ

é€šè¿‡è¿™å¥—æ ¸å¿ƒä¸šåŠ¡æ¨¡å—è®¾è®¡ï¼Œç¡®ä¿ç¬¬ä¸€æœŸMVPèƒ½å¤Ÿæ”¯æ’‘å®Œæ•´çš„é”€å”®ä¸šåŠ¡æµç¨‹ï¼Œä¸ºåç»­åŠŸèƒ½æ‰©å±•å¥ å®šåšå®åŸºç¡€ã€‚
