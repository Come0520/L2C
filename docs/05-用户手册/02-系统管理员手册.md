# 罗莱L2C销售管理系统 - 系统管理员手册

## 目录
- [管理员职责概述](#管理员职责概述)
- [用户管理](#用户管理)
- [系统配置管理](#系统配置管理)
- [数据管理](#数据管理)
- [系统监控](#系统监控)
- [故障处理](#故障处理)
- [安全管理](#安全管理)
- [备份与恢复](#备份与恢复)
- [性能优化](#性能优化)
- [日常维护](#日常维护)

## 管理员职责概述

### 主要职责
- **用户管理**：用户账号创建、权限分配、密码重置
- **系统配置**：基础数据维护、参数设置、规则配置
- **数据管理**：数据备份、导入导出、清理维护
- **监控运维**：系统监控、性能优化、故障处理
- **权限控制**：角色管理、功能权限、数据权限
- **安全管理**：系统安全、数据安全、访问控制
- **培训支持**：用户培训、技术支持、问题解答

### 管理员类型
- **超级管理员**：拥有系统所有权限，负责整体管理
- **系统管理员**：负责用户管理、系统配置、技术维护
- **业务管理员**：负责业务数据管理、流程配置、报表分析

## 用户管理

### 用户账号管理

#### 创建用户账号
1. 进入"系统管理" → "用户管理"
2. 点击"新增用户"
3. 填写用户信息：
   - **用户名**：唯一标识，建议使用工号
   - **真实姓名**：员工真实姓名
   - **手机号码**：用于登录和接收通知
   - **邮箱地址**：用于系统通知
   - **所属部门**：销售部、客服部、技术部等
   - **所属城市**：工作城市
   - **门店信息**：所属门店（如适用）
   - **直属上级**：汇报关系
4. 分配用户角色
5. 设置初始密码
6. 保存用户信息

#### 批量导入用户
1. 下载用户导入模板
2. 按模板格式填写用户信息：
   ```
   用户名 | 真实姓名 | 手机号 | 邮箱 | 部门 | 城市 | 门店 | 角色
   ```
3. 上传Excel文件
4. 系统验证数据格式：
   - 检查必填字段
   - 验证手机号格式
   - 检查用户名唯一性
5. 确认导入结果
6. 发送账号信息给用户

#### 用户状态管理
1. **启用/禁用用户**
   - 控制用户登录权限
   - 禁用用户保留数据
   - 可随时重新启用

2. **密码重置**
   - 为用户重置登录密码
   - 生成临时密码
   - 要求用户首次登录修改

3. **强制下线**
   - 踢出当前在线用户
   - 用于安全管控
   - 用户需重新登录

### 角色权限管理

#### 系统角色定义
1. **超级管理员（SUPER_ADMIN）**
   - 系统全部权限
   - 用户管理权限
   - 系统配置权限

2. **系统管理员（ADMIN）**
   - 用户管理、系统配置
   - 数据管理、监控运维
   - 不包含敏感业务数据

3. **业务管理员（BUSINESS_ADMIN）**
   - 业务数据管理
   - 报表查看权限
   - 流程配置权限

4. **销售经理（SALES_MANAGER）**
   - 销售团队管理
   - 业绩查看权限
   - 线索分配权限

5. **销售人员（SALES）**
   - 线索管理、销售单处理
   - 客户跟踪权限
   - 个人业绩查看

6. **测量师（MEASURER）**
   - 测量任务管理
   - 测量数据录入
   - 任务状态更新

7. **安装师（INSTALLER）**
   - 安装任务管理
   - 安装进度更新
   - 完工确认权限

8. **财务人员（FINANCE）**
   - 财务数据查看
   - 回款确认权限
   - 财务报表权限

#### 权限配置矩阵
```
功能模块          超管  系管  业管  销管  销售  测量  安装  财务
用户管理          ✓    ✓    ✗    ✗    ✗    ✗    ✗    ✗
系统配置          ✓    ✓    ✗    ✗    ✗    ✗    ✗    ✗
线索管理          ✓    ✓    ✓    ✓    ✓    ✗    ✗    ✗
销售管理          ✓    ✓    ✓    ✓    ✓    ✗    ✗    ✗
测量管理          ✓    ✓    ✓    ✓    ✗    ✓    ✗    ✗
安装管理          ✓    ✓    ✓    ✓    ✗    ✗    ✓    ✗
积分管理          ✓    ✓    ✓    ✓    ✓    ✓    ✓    ✗
财务管理          ✓    ✓    ✓    ✗    ✗    ✗    ✗    ✓
报表查看          ✓    ✓    ✓    ✓    ✓    ✓    ✓    ✓
```

#### 数据权限控制
1. **全局数据权限**：超级管理员、系统管理员
2. **城市数据权限**：只能查看所属城市数据
3. **门店数据权限**：只能查看所属门店数据
4. **个人数据权限**：只能查看个人相关数据
5. **团队数据权限**：销售经理可查看团队数据

## 系统配置管理

### 基础数据配置

#### 产品品类管理
1. **窗帘类产品**
   - 成品窗帘：现货产品
   - 定制窗帘：按需定制
   - 窗帘配件：轨道、绑带等

2. **墙纸类产品**
   - 无纺布墙纸：环保材质
   - PVC墙纸：防水防潮
   - 纯纸墙纸：透气性好

3. **墙板类产品**
   - 实木墙板：高端产品
   - 复合墙板：性价比高
   - 软包墙板：装饰效果好

#### 门店信息管理
1. 进入"系统配置" → "门店管理"
2. 添加门店信息：
   - **门店编码**：唯一标识
   - **门店名称**：显示名称
   - **门店地址**：详细地址
   - **联系电话**：客服电话
   - **负责人信息**：店长信息
   - **营业状态**：正常/暂停/关闭
   - **服务区域**：覆盖范围

#### 服务区域配置
1. **省市区配置**
   - 三级联动设置
   - 服务范围划分
   - 区域负责人分配

2. **费用标准设置**
   - 配送费用标准
   - 安装费用标准
   - 测量费用标准

### 业务规则配置

#### 积分规则设置
```
操作类型              积分奖励        说明
线索创建              10积分         每创建一个线索
线索跟踪              5积分/次       每次跟踪记录
线索转化              50积分         线索成功转化为销售单
销售单成交            销售单金额×0.1%  按销售单金额比例
测量完成              30积分         完成测量任务
安装完成              50积分         完成安装任务
客户好评              20积分         获得客户好评
推荐新客户            100积分        成功推荐新客户
月度业绩达标          200积分        完成月度目标
```

#### 销售单状态流转规则
1. **状态流转条件**
   - 每个状态的前置条件
   - 状态变更权限控制
   - 必填字段验证

2. **自动流转规则**
   - 定时任务触发
   - 条件满足自动流转
   - 异常情况处理

3. **超时提醒设置**
   - 各状态停留时间限制
   - 超时自动提醒
   - 升级处理机制

#### 提醒通知配置
1. **短信通知模板**
   ```
   【罗莱L2C】您有新的{任务类型}任务，客户：{客户姓名}，地址：{客户地址}，请及时处理。
   ```

2. **邮件通知模板**
   - 任务分配通知
   - 状态变更通知
   - 异常情况通知

3. **系统消息模板**
   - 站内消息格式
   - 推送时机设置
   - 消息优先级

## 数据管理

### 数据备份

#### 自动备份设置
1. **备份策略配置**
   - 备份频率：每日凌晨2:00
   - 备份保留：30天
   - 备份位置：/backup/database/
   - 备份验证：自动校验完整性

2. **备份内容**
   - 数据库完整备份
   - 上传文件备份
   - 系统配置备份
   - 日志文件备份

#### 手动备份操作
1. 进入"系统管理" → "数据备份"
2. 选择备份类型：
   - 完整备份：所有数据
   - 增量备份：变更数据
   - 差异备份：差异数据
3. 设置备份参数
4. 执行备份任务
5. 验证备份完整性

### 数据导入导出

#### 线索数据导入
1. **导入准备**
   - 下载导入模板
   - 整理数据格式
   - 检查数据质量

2. **导入流程**
   - 上传Excel文件
   - 数据格式验证
   - 重复数据检查
   - 确认导入结果

3. **导入验证**
   - 必填字段检查
   - 数据格式验证
   - 业务规则验证
   - 导入结果报告

#### 业绩数据导出
1. **导出条件设置**
   - 时间范围选择
   - 人员范围选择
   - 门店范围选择
   - 数据类型选择

2. **导出格式**
   - Excel格式：便于分析
   - CSV格式：便于处理
   - PDF格式：便于打印

### 数据清理维护

#### 定期清理任务
1. **日志清理**
   ```bash
   # 清理90天前的日志
   find /logs -name "*.log" -mtime +90 -delete
   ```

2. **临时文件清理**
   - 清理上传临时文件
   - 清理缓存文件
   - 清理会话文件

3. **无效数据清理**
   - 清理无效图片
   - 清理重复数据
   - 清理测试数据

#### 数据一致性检查
1. **销售单状态一致性**
   - 检查状态流转逻辑
   - 修复异常状态
   - 更新相关数据

2. **积分计算准确性**
   - 验证积分计算规则
   - 检查积分余额
   - 修复计算错误

3. **关联数据完整性**
   - 检查外键约束
   - 修复孤立数据
   - 更新关联关系

## 系统监控

### 性能监控

#### 服务器监控指标
1. **CPU监控**
   - 使用率阈值：< 80%
   - 负载均衡监控
   - 进程CPU占用

2. **内存监控**
   - 使用率阈值：< 85%
   - 内存泄漏检测
   - 缓存命中率

3. **磁盘监控**
   - 使用率阈值：< 90%
   - I/O性能监控
   - 磁盘健康状态

4. **网络监控**
   - 带宽使用情况
   - 连接数统计
   - 网络延迟监控

#### 数据库监控
1. **连接监控**
   - 连接数：< 100
   - 连接池状态
   - 连接超时监控

2. **性能监控**
   - 查询响应时间：< 2秒
   - 慢查询日志：记录>5秒查询
   - 索引使用情况

3. **锁监控**
   - 锁等待时间
   - 死锁检测
   - 事务监控

#### 应用监控
1. **接口性能**
   - 响应时间统计
   - 吞吐量监控
   - 错误率统计

2. **业务监控**
   - 用户并发数
   - 业务操作统计
   - 功能使用情况

### 告警设置

#### 告警规则配置
1. **系统告警**
   - CPU使用率 > 80%
   - 内存使用率 > 85%
   - 磁盘使用率 > 90%
   - 服务不可用

2. **业务告警**
   - 接口错误率 > 5%
   - 响应时间 > 5秒
   - 数据库连接失败
   - 关键业务异常

#### 告警通知方式
1. **短信通知**：紧急告警
2. **邮件通知**：一般告警
3. **微信通知**：实时告警
4. **系统通知**：内部告警

## 故障处理

### 常见故障及处理

#### 系统无法访问
1. **检查步骤**
   ```bash
   # 检查服务器状态
   systemctl status nginx
   systemctl status postgresql
   systemctl status redis
   
   # 检查端口监听
   netstat -tlnp | grep :3000
   netstat -tlnp | grep :5432
   
   # 检查进程状态
   ps aux | grep node
   ps aux | grep postgres
   ```

2. **处理方法**
   - 重启相关服务
   - 检查配置文件
   - 查看错误日志
   - 恢复备份数据

#### 数据库连接失败
1. **检查PostgreSQL服务**
   ```bash
   systemctl status postgresql
   systemctl restart postgresql
   ```

2. **检查连接配置**
   - 验证连接参数
   - 检查用户权限
   - 测试网络连通性

3. **查看错误日志**
   ```bash
   tail -f /var/log/postgresql/postgresql.log
   ```

#### 性能问题处理
1. **慢查询优化**
   - 分析慢查询日志
   - 优化SQL语句
   - 添加合适索引

2. **内存不足处理**
   - 清理缓存数据
   - 优化内存配置
   - 增加服务器内存

3. **磁盘空间不足**
   - 清理日志文件
   - 清理临时文件
   - 扩展磁盘空间

### 应急响应流程

#### 故障分级
1. **P0级故障**：系统完全不可用
2. **P1级故障**：核心功能不可用
3. **P2级故障**：部分功能异常
4. **P3级故障**：轻微功能问题

#### 响应时间要求
- P0级：15分钟内响应，1小时内解决
- P1级：30分钟内响应，4小时内解决
- P2级：2小时内响应，24小时内解决
- P3级：1天内响应，3天内解决

## 安全管理

### 访问控制

#### 登录安全
1. **密码策略**
   - 最小长度：8位
   - 包含大小写字母、数字、特殊字符
   - 定期强制修改密码
   - 禁止使用弱密码

2. **登录限制**
   - 连续失败5次锁定账户
   - 锁定时间：30分钟
   - 异地登录提醒
   - 单点登录控制

#### 权限控制
1. **最小权限原则**
   - 用户只获得必需权限
   - 定期审查权限
   - 及时回收权限

2. **权限审计**
   - 记录权限变更
   - 定期权限检查
   - 异常权限告警

### 数据安全

#### 数据加密
1. **传输加密**
   - HTTPS协议
   - SSL证书配置
   - 数据传输加密

2. **存储加密**
   - 敏感数据加密存储
   - 密码哈希存储
   - 数据库加密

#### 数据备份安全
1. **备份加密**
   - 备份文件加密
   - 传输过程加密
   - 存储位置安全

2. **备份验证**
   - 定期恢复测试
   - 备份完整性验证
   - 备份可用性检查

## 备份与恢复

### 备份策略

#### 备份类型
1. **完整备份**
   - 频率：每周一次
   - 内容：全部数据
   - 保留：4周

2. **增量备份**
   - 频率：每日一次
   - 内容：变更数据
   - 保留：30天

3. **差异备份**
   - 频率：每12小时
   - 内容：差异数据
   - 保留：7天

#### 备份验证
1. **自动验证**
   - 备份完整性检查
   - 文件大小验证
   - 校验和验证

2. **手动验证**
   - 定期恢复测试
   - 数据一致性检查
   - 业务功能验证

### 数据恢复

#### 恢复场景
1. **数据误删除**
   - 从最近备份恢复
   - 恢复特定表数据
   - 验证数据完整性

2. **系统故障**
   - 完整系统恢复
   - 服务重新部署
   - 数据一致性检查

3. **硬件故障**
   - 迁移到新硬件
   - 恢复系统环境
   - 恢复业务数据

#### 恢复流程
1. **评估损失范围**
2. **选择恢复策略**
3. **执行恢复操作**
4. **验证恢复结果**
5. **恢复业务服务**

## 性能优化

### 数据库优化

#### 查询优化
1. **索引优化**
   ```sql
   -- 创建复合索引
   CREATE INDEX idx_leads_status_time ON leads(status, created_at);
   
   -- 创建覆盖索引
   CREATE INDEX idx_orders_cover ON sales_orders(status, sales_person_id, created_at);
   ```

2. **SQL优化**
   - 避免SELECT *
   - 使用合适的JOIN
   - 优化WHERE条件
   - 使用LIMIT分页

#### 配置优化
1. **PostgreSQL配置**
   ```ini
   # 共享缓冲区大小
   shared_buffers = 2GB
   
   # 工作内存
   work_mem = 64MB
   
   # 连接数
   max_connections = 200
   
   # 有效缓存大小
   effective_cache_size = 6GB
   ```

### 应用优化

#### 缓存策略
1. **Redis缓存**
   - 热点数据缓存
   - 会话数据缓存
   - 计算结果缓存

2. **缓存更新策略**
   - 写入时更新
   - 定时刷新
   - 失效时重建

#### 代码优化
1. **接口优化**
   - 减少数据库查询
   - 优化算法逻辑
   - 异步处理

2. **资源优化**
   - 图片压缩
   - 静态资源CDN
   - 代码压缩

## 日常维护

### 定期维护任务

#### 每日任务
1. **系统监控检查**
   - 查看监控面板
   - 检查告警信息
   - 处理异常情况

2. **备份状态检查**
   - 验证备份完成
   - 检查备份大小
   - 清理过期备份

3. **日志检查**
   - 查看错误日志
   - 分析异常信息
   - 处理问题记录

#### 每周任务
1. **性能分析**
   - 分析性能报告
   - 识别性能瓶颈
   - 制定优化计划

2. **安全检查**
   - 检查安全日志
   - 更新安全补丁
   - 审查用户权限

3. **数据清理**
   - 清理临时数据
   - 归档历史数据
   - 优化数据库

#### 每月任务
1. **系统更新**
   - 更新系统补丁
   - 升级软件版本
   - 测试系统功能

2. **容量规划**
   - 分析资源使用
   - 预测容量需求
   - 制定扩容计划

3. **灾备演练**
   - 测试备份恢复
   - 验证应急流程
   - 更新应急预案

### 维护文档

#### 操作记录
1. **变更记录**
   - 记录系统变更
   - 记录配置修改
   - 记录问题处理

2. **维护日志**
   - 记录维护活动
   - 记录问题解决
   - 记录经验教训

#### 知识库维护
1. **更新文档**
   - 更新操作手册
   - 更新故障处理指南
   - 更新最佳实践

2. **培训材料**
   - 制作培训课件
   - 录制操作视频
   - 组织培训活动

---

**文档版本**：v1.0  
**最后更新时间**：2025年1月  
**适用系统版本**：L2C销售管理系统 v1.0+  
**维护责任人**：系统管理员团队