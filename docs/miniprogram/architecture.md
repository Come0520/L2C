# 小程序架构设计方案 (Unified Mini Program Architecture)

## 1. 核心目标

1.  **统一入口**：所有角色（租户管理员、员工、客户）使用同一个小程序 (AppID)。
2.  **角色隔离**：基于用户身份动态展示功能模块。
3.  **私域闭环**：以业务分享为触点，自然沉淀零售客户。

## 2. 用户角色定义 (Role Definitions)

- **租户 (Tenant)**: 使用系统卖窗帘的商家/企业。
- **员工 (Employee/Admin)**: 租户内部人员，负责销售、管理。
- **客户 (Customer)**: **零售买家** (真正花钱买窗帘的人)、私域流量。

## 3. 用户旅程与状态流转

### A. 初始状态：营销落地页 (Marketing Landing)

- **页面**: `pages/landing/landing`
- **触发条件**: 访客、未注册用户、未绑定租户的用户。
- **内容**:
  - **轮播图 (Carousel)**: 展示产品亮点、品牌实力、营销活动。
  - **介绍文案**: 核心价值主张。
  - **行动点**: [登录/注册] (主), [我是商家-创建企业] (副)。

### B. 活跃状态：业务工作台 (Active Workspace)

- **页面**: `pages/index/index` (承载 TabBar)
- **触发条件**: 已登录且已绑定租户的用户。
- **视图区分**:
  - **B端 (员工)**: 侧重管理、跟单、客户列表。
  - **C端 (客户)**: 侧重浏览、订单状态、联系人。

## 4. 获客与绑定机制

### 场景 A：员工入职

- 管理员在小程序生成 "员工邀请卡"。
- 员工点击 -> 确认 -> 加入团队。

### 场景 B：客户绑定 (无感沉淀)

- 销售分享 **报价单**、**案例库**、**电子名片**。
- 客户点击浏览 -> 系统静默/弹窗绑定 -> 成为该租户客户。
- _优势_: 无需发硬广邀请，业务往来即留存。

## 5. 技术架构要点

### Custom TabBar (动态导航)

由于 B端和 C端 菜单完全不同，必须使用微信自定义 TabBar。

- `stores/auth-store`: 存储 `role`。
- `custom-tab-bar`: 监听 `auth-store`，渲染对应 list。

### 路由拦截

- `app.ts`: `onLaunch` 检查 Token。
- `utils/router.ts`: 封装跳转逻辑，未登录强制重定向到 `landing`。
