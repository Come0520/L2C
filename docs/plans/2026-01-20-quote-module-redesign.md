# 报价模块 UI/UX 重设计方案

## 设计背景

基于 2026-01-20 的模块审计和头脑风暴讨论，确定报价模块存在以下核心问题：
1. 缺少添加空间/商品的入口
2. UI 头重脚轻，客户信息区域占用过多空间
3. 品类视图未实现
4. 缺乏聚焦式编辑体验

## 设计决策总览

| 设计项 | 决定 |
|--------|------|
| **整体布局** | 顶部栏 → 客户抽屉 → 品类Tabs → 内容区 → 底部吸底汇总 |
| **品类选择器** | 顶部 Tabs（窗帘/墙布/墙纸/墙咔/标品） |
| **视图切换** | 品类优先（默认） ⇄ 空间优先 |
| **客户信息** | 抽屉式，默认收起，仅显示姓名/电话/地址 |
| **空间分组** | 抽屉式，聚焦当前编辑的空间 |
| **商品行** | 快速/高级字段抽屉，附件从属但列对齐 |
| **四层汇总** | 商品小计 → 空间小计 → 品类小计 → 总计 |
| **添加入口** | 左上角"+ 添加空间"，空间内"+ 添加商品" |
| **金额汇总** | 底部吸底栏 |
| **操作日志** | ❌ 移除 |
| **版本管理** | 保留，支持"激活为Active" |
| **版本对比** | 保留"苹果风"对比视图 |
| **报价套餐** | 暂时隐藏入口 |
| **提交校验** | 至少1条商品 + 金额>0 |
| **导出格式** | PDF + Excel + 图片 |
| **打印模板** | 完整版（所有字段） |

---

## 详细设计

### 1. 整体页面布局

```
┌─────────────────────────────────────────────────┐
│ 顶部栏：返回 | 报价单号 | V1▼ | 状态 | 操作按钮   │
├─────────────────────────────────────────────────┤
│ 客户信息栏（抽屉式）：姓名 | 电话 | 地址 [展开▼]  │
├─────────────────────────────────────────────────┤
│ 品类 Tabs：[ 窗帘 | 墙布 | 墙纸 | 墙咔 | 标品 ]   │
│ 右侧：[品类视图 ⇄ 空间视图] 切换按钮             │
├─────────────────────────────────────────────────┤
│                                                 │
│  主内容区（选中品类的空间列表）                    │
│  - [+ 添加空间] 按钮在左上角                      │
│  - 空间采用抽屉式，聚焦当前编辑空间                │
│  - 每个空间内有 [+ 添加商品] 按钮                  │
│                                                 │
├─────────────────────────────────────────────────┤
│ 底部吸底栏：商品合计 ¥XX | 折扣 -¥XX | 最终 ¥XX   │
└─────────────────────────────────────────────────┘
```

### 2. 三层抽屉设计

#### 2.1 客户信息抽屉
- **默认收起**：仅显示 `姓名 | 电话 | 地址` 一行
- **展开后**：显示完整客户信息（来源、项目、备注等）

#### 2.2 空间分组抽屉
- **聚焦模式**：当前编辑的空间展开，其他空间收起
- **收起显示**：空间名称 + 商品数量 + 小计金额
- **支持手动展开多个**：方便对比

#### 2.3 商品行字段抽屉
- **快速模式（默认）**：空间、商品型号、图片、宽度、高度、拉动形式、数量、单价、金额
- **高级模式（展开）**：幅宽、材质、克重、花距、安装位置、离地高度、褶皱倍数、折扣、备注、附件

### 3. 商品行详细结构

```
┌─────────────────────────────────────────────────────────────────┐
│ 商品型号        | 图片 | 宽度  | 高度  | 拉动  | 数量 | 单价 | 金额  │
│ 遮光布-米白LC01 | [📷] | 280   | 260   | 对开  | 5.6m | ¥120 | ¥672  │
├─────────────────────────────────────────────────────────────────┤
│ ▼ 高级参数（上下结构）                                            │
│ ┌──────────┬──────────┬──────────┬──────────┐                    │
│ │  幅宽     │  材质     │  克重     │  花距    │                    │
│ │  280cm   │  涤纶     │  180g/㎡  │  无      │                    │
│ ├──────────┼──────────┼──────────┼──────────┤                    │
│ │ 安装位置  │ 离地高度  │ 褶皱倍数  │  折扣    │                    │
│ │ 窗帘盒    │  2cm     │  2.0     │  无      │                    │
│ └──────────┴──────────┴──────────┴──────────┘                    │
│ 备注: ___________________________                                │
├─────────────────────────────────────────────────────────────────┤
│ ▼ 附件（列对齐）                                                  │
│   └─ 本布绑带           |      |       |       | 0.15m | ¥120 | ¥18 │
│   └─ 抱枕 45×45         |      |       |       |   2个 |  ¥80 | ¥160│
│   └─ [+ 添加附件]                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                        商品小计（含附件）: ¥850   │
└─────────────────────────────────────────────────────────────────┘
```

### 4. 四层汇总结构

```
品类：窗帘
├── 空间：客厅
│   ├── 遮光布 ¥672 + 附件 ¥178 → 商品小计: ¥850
│   ├── 窗纱 ¥560                → 商品小计: ¥560
│   └── 空间小计: ¥1,410
├── 空间：主卧
│   ├── ... → 商品小计: ¥xxx
│   └── 空间小计: ¥xxx
└── 品类小计: ¥xxx

底部吸底栏 → 总计: ¥xxx
```

### 5. 功能变更清单

| 功能 | 变更 |
|------|------|
| 右侧边栏 | ❌ 移除 |
| 操作日志面板 | ❌ 移除 |
| 金额汇总 | 移至底部吸底栏 |
| 报价套餐入口 | 暂时隐藏 |
| 品类 Tabs | ✅ 新增实现 |
| 空间视图切换 | ✅ 新增实现 |
| 添加空间/商品按钮 | ✅ 新增实现 |
| 商品行抽屉 | ✅ 新增实现 |
| 附件录入 | ✅ 完善实现 |
| 四层汇总 | ✅ 新增实现 |
| 提交校验 | ✅ 新增实现 |

### 6. 导出与打印

- **导出格式**：PDF + Excel + 图片（用于微信分享）
- **打印模板**：完整版（显示所有字段）

---

## 实现范围排除

以下功能本次迭代**不实现**：
1. 报价套餐模块（预设方案模板）
2. 损耗参数配置 UI（暂用默认值）
3. 快速/高级模式的租户级字段配置

---

## 相关文档

- [报价模块需求文档](file:///c:/Users/bigey/Documents/Antigravity/L2C/docs/02-requirements/modules/%E6%8A%A5%E4%BB%B7%E5%8D%95/%E6%8A%A5%E4%BB%B7%E5%8D%95.md)
- [报价模块审计报告 20260120](file:///C:/Users/bigey/.gemini/antigravity/brain/5970f6ee-e5fd-4fa7-85a3-aadbe0a4745c/walkthrough.md)
- [报价模块审计报告 20260116](file:///c:/Users/bigey/Documents/Antigravity/L2C/docs/02-requirements/modules/%E6%8A%A5%E4%BB%B7%E5%8D%95/quote-module-audit-20260116.md)

---

**设计确认日期**: 2026-01-20
