# 产品策略配置页面设计文档

## 1. 概述

### 1.1 页面定位

| 维度 | `/supply-chain/products` | `/settings/products` |
|---|---|---|
| **定位** | 商品日常管理 | 商品策略配置 |
| **权限** | 销售、店长可看（只读） | 仅店长可见可编辑 |
| **敏感信息** | 隐藏成本价、供应商 | 可见成本价、供应商 |

### 1.2 页面结构

```
/settings/products（产品策略配置页面）
├── [Tab 1] 套餐管理
├── [Tab 2] 渠道专属价
├── [Tab 3] 组合商品
├── [Tab 4] 渠道等级折扣
└── [Tab 5] 属性模板
```

---

## 2. Tab 1：套餐管理

### 2.1 功能概述

管理4种类型的套餐：数量套餐、组合套餐、品类套餐、限时套餐。

### 2.2 套餐类型

| 类型 | 说明 | 示例 |
|---|---|---|
| **数量套餐** | 基于商品数量 | 18米布 = ¥1999 |
| **组合套餐** | 基于商品组合 | 窗帘布 + 轨道 + 配件 = ¥2999 |
| **品类套餐** | 基于品类 | 所有墙布类享受套餐价 |
| **限时套餐** | 有时间限制 | 活动期间特价 |

### 2.3 UI 布局

```
┌─────────────────────────────────────────────────────────┐
│ [+ 新建套餐]                          [搜索] [筛选: 类型▼] │
├─────────────────────────────────────────────────────────┤
│ ┌─────┬──────────┬─────────┬────────┬────────┬────────┐ │
│ │套餐号│ 套餐名称  │ 类型    │ 套餐价  │ 状态   │ 操作   │ │
│ ├─────┼──────────┼─────────┼────────┼────────┼────────┤ │
│ │TC001│18米布套餐 │数量套餐 │ ¥1999  │ 启用   │编辑 禁用│ │
│ │TC002│窗帘全包   │组合套餐 │ ¥2999  │ 启用   │编辑 禁用│ │
│ └─────┴──────────┴─────────┴────────┴────────┴────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 2.4 商品关联方式

在套餐配置中关联商品，支持三种方式：
- **指定商品** — 精确匹配具体商品
- **按品类** — 范围匹配，如"所有窗帘布料"
- **按标签** — 如"特价布料"、"新品系列"

### 2.5 套餐标签机制

- 被套餐关联的商品自动打上标签（如 🏷️18米套餐）
- 商品列表支持按套餐标签搜索和筛选
- 一个商品可属于多个套餐，显示多个标签

### 2.6 特殊规则

- ✅ 套餐商品可标记为"不参与渠道折扣"
- ✅ 支持设置套餐优先级

---

## 3. Tab 2：渠道专属价

### 3.1 功能概述

为特定渠道设置单独的商品结算价，覆盖标准渠道价。

### 3.2 UI 布局

```
┌─────────────────────────────────────────────────────────┐
│ [+ 新增渠道专属价]               [搜索商品/渠道] [品类▼] │
├─────────────────────────────────────────────────────────┤
│ ┌────────┬──────────────┬────────┬────────┬────────────┐│
│ │ 渠道    │ 商品         │ 标准价  │ 专属价  │ 操作      ││
│ ├────────┼──────────────┼────────┼────────┼────────────┤│
│ │ 圣都武汉│ 高密度遮光布  │ ¥80/米 │ ¥72/米 │ 编辑 删除  ││
│ │ 设计师A │ 电动轨道      │ ¥150/米│ ¥130/米│ 编辑 删除  ││
│ └────────┴──────────────┴────────┴────────┴────────────┘│
└─────────────────────────────────────────────────────────┘
```

### 3.3 操作方式

新增渠道专属价：
1. 选择渠道（从客户/渠道模块拉取）
2. 选择商品（可批量选择）
3. 设置专属价（可按百分比或固定金额）

---

## 4. Tab 3：组合商品

### 4.1 功能概述

管理组合SKU，用于**报价简化**和**成本核算**。

### 4.2 使用场景

| 环节 | 处理方式 |
|---|---|
| **报价** | 以组合形式显示 |
| **成本核算** | 汇总子商品成本 |
| **订单** | 记录组合商品，展开显示子商品明细 |
| **采购** | ⚠️ **自动拆分**，按子商品供应商生成独立采购单 |

### 4.3 UI 布局

```
┌─────────────────────────────────────────────────────────┐
│ [+ 新建组合商品]                    [搜索] [品类▼]      │
├─────────────────────────────────────────────────────────┤
│ ┌───────┬────────────┬────────┬────────┬───────┬──────┐│
│ │组合SKU │ 组合名称    │ 子商品数│ 组合成本│ 零售价│ 操作 ││
│ ├───────┼────────────┼────────┼────────┼───────┼──────┤│
│ │BDL001 │ 窗帘基础套装│ 3件    │ ¥360  │ ¥720  │编辑  ││
│ └───────┴────────────┴────────┴────────┴───────┴──────┘│
└─────────────────────────────────────────────────────────┘
```

### 4.4 组合商品编辑

- 子商品列表：商品名称、数量、单位、成本
- 定价方式：自动计算 或 手动设置
- 组合零售价、组合渠道价

---

## 5. Tab 4：渠道等级折扣

### 5.1 功能概述

配置 S/A/B/C 级渠道的默认折扣率，支持三级覆盖。

### 5.2 折扣优先级

```
商品级覆盖 > 品类级覆盖 > 全局默认
```

### 5.3 UI 布局

```
┌─────────────────────────────────────────────────────────┐
│ ┌─── 全局默认折扣 ──────────────────────────────────────┐│
│ │ S级: [95]%   A级: [98]%   B级: [100]%   C级: [102]%  ││
│ └───────────────────────────────────────────────────────┘│
│                                                         │
│ ┌─── 品类/商品覆盖规则 ─────────────────────────────────┐│
│ │ [+ 新增覆盖规则]                                     ││
│ │ ┌────────┬────────┬────┬────┬────┬────┬────────────┐ ││
│ │ │ 范围    │ 对象    │ S级│ A级│ B级│ C级│ 操作      │ ││
│ │ ├────────┼────────┼────┼────┼────┼────┼────────────┤ ││
│ │ │ 品类   │窗帘布料 │ 93%│ 96%│100%│102%│ 编辑 删除  │ ││
│ │ └────────┴────────┴────┴────┴────┴────┴────────────┘ ││
│ └───────────────────────────────────────────────────────┘│
│                                                         │
│ ┌─── 特殊规则 ──────────────────────────────────────────┐│
│ │ ☑️ 套餐商品不参与渠道折扣                              ││
│ │ ☑️ 组合商品按子商品分别计算折扣                        ││
│ └───────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────┘
```

---

## 6. Tab 5：属性模板

### 6.1 功能概述

配置各品类商品的动态属性字段，并设置快速报价字段。

### 6.2 UI 布局

```
┌─────────────────────────────────────────────────────────────┐
│ 选择品类: [窗帘布料 ▼]                                        │
│                                                             │
│ ┌─── 字段列表 ─────────────────────────────────────────────┐ │
│ │ ┌──────┬──────────┬────────┬────────┬────────┬─────────┐ │ │
│ │ │ 排序 │ 字段名    │ 字段类型│ 必填   │快速报价 │ 操作    │ │ │
│ │ ├──────┼──────────┼────────┼────────┼────────┼─────────┤ │ │
│ │ │ ↑↓  │ 空间      │ 枚举   │ ✓      │ ☑️     │ 编辑    │ │ │
│ │ │ ↑↓  │ 商品型号   │ 搜索   │ ✓      │ ☑️     │ 编辑    │ │ │
│ │ │ ↑↓  │ 测量宽度   │ 数字   │ ✓      │ ☑️     │ 编辑    │ │ │
│ │ │ ↑↓  │ 测量高度   │ 数字   │ ✓      │ ☑️     │ 编辑    │ │ │
│ │ │ ↑↓  │ 幅宽      │ 数字   │ ✓      │ ☐      │ 编辑    │ │ │
│ │ │ ↑↓  │ 材质      │ 枚举   │ ✗      │ ☐      │ 编辑    │ │ │
│ │ └──────┴──────────┴────────┴────────┴────────┴─────────┘ │ │
│ │                                        [+ 新增自定义字段]  │ │
│ └───────────────────────────────────────────────────────────┘ │
│                                                              │
│ [重置为系统默认]                              [保存配置]       │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 字段类型

| 类型 | 说明 | 配置项 |
|---|---|---|
| **文本** | 单行文本输入 | 最大长度 |
| **数字** | 数值输入 | 最小值、最大值、单位 |
| **布尔** | 开关选择 | — |
| **枚举** | 下拉单选 | 选项列表 |
| **多选** | 复选框组 | 选项列表 |

### 6.4 快速报价配置

- **快速报价** 列：☑️ 勾选后，该字段在快速报价模式下显示
- 参考报价单需求文档中定义的默认字段

---

## 7. 权限控制

| 角色 | 可见性 | 操作权限 |
|---|---|---|
| **店长/管理员** | ✅ 可见 | 完整读写权限 |
| **销售** | ❌ 不可见 | 无法访问此页面 |

---

## 8. 技术实现要点

### 8.1 数据库表

| 表名 | 用途 |
|---|---|
| `product_packages` | 套餐表 |
| `package_products` | 套餐商品关联表 |
| `channel_specific_prices` | 渠道专属价表 |
| `product_bundles` | 组合商品表 |
| `product_bundle_items` | 组合商品明细表 |
| `attribute_templates` | 属性模板表 |
| `tenants.settings` | 渠道等级折扣配置（JSONB） |

### 8.2 与其他模块的关联

- **报价单模块**：套餐自动识别、快速报价字段配置
- **供应链模块**：商品列表显示套餐标签
- **采购模块**：组合商品自动拆分生成采购单
