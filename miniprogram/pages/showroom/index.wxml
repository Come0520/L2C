<!--pages/showroom/index.wxml-->
<view class="container">
  <!-- Search Header -->
  <view class="search-header">
    <view class="search-bar">
      <icon type="search" size="14" color="#64748b"></icon>
      <input 
        class="search-input" 
        placeholder="æœç´¢å•†å“ / æ¡ˆä¾‹..." 
        placeholder-class="search-placeholder"
        bindinput="onSearchInput"
        disabled="{{isSelectionMode}}"
      />
    </view>
    
    <!-- ç­›é€‰æŒ‰é’® -->
    <view class="filter-btn" bindtap="toggleFilter" wx:if="{{!isSelectionMode}}">
        <text class="filter-icon"><image src="/assets/icons/filter-active.svg" style="width:28rpx;height:28rpx;vertical-align:middle;"/></text>
    </view>

    <!-- é€‰æ‹©æŒ‰é’® (Selection Mode Toggle) -->
    <view class="select-btn" bindtap="toggleSelectionMode">
        {{isSelectionMode ? 'å–æ¶ˆ' : 'é€‰æ‹©'}}
    </view>
  </view>

  <!-- Filter Drawer -->
  <view class="filter-drawer {{isFilterOpen ? 'open' : ''}}">
      <view class="drawer-mask" bindtap="toggleFilter"></view>
      <view class="drawer-content">
          <view class="drawer-header">é«˜çº§ç­›é€‰</view>
          
          <scroll-view class="drawer-body" scroll-y="true">
              <block wx:for="{{filterOptions.details}}" wx:key="key">
                  <view class="filter-section">
                      <view class="filter-label">{{item.label}}</view>
                      <view class="filter-options">
                          <view 
                            class="option-tag {{activeFilters[item.key] === option ? 'active' : ''}}" 
                            wx:for="{{item.options}}" 
                            wx:key="*this" 
                            wx:for-item="option"
                            bindtap="selectFilterOption"
                            data-key="{{item.key}}"
                            data-value="{{option}}"
                          >
                            {{option}}
                          </view>
                      </view>
                  </view>
              </block>
          </scroll-view>

          <view class="drawer-footer">
              <button class="reset-btn" bindtap="resetFilter">é‡ç½®</button>
              <button class="confirm-btn" bindtap="confirmFilter">ç¡®è®¤</button>
          </view>
      </view>
  </view>

  <!-- Tabs (Hidden in Selection Mode) -->
  <view class="tabs" style="height: {{isSelectionMode ? 0 : 'auto'}}; opacity: {{isSelectionMode ? 0 : 1}}; overflow: hidden;">
    <view 
      class="tab-item {{activeTab === 'featured' ? 'active' : ''}}" 
      bindtap="onTabChange" 
      data-tab="featured"
    >
      âœ¨ ç²¾é€‰
    </view>
    <view 
      class="tab-item {{activeTab === 'products' ? 'active' : ''}}" 
      bindtap="onTabChange" 
      data-tab="products"
    >
      ğŸ·ï¸ å•†å“
    </view>
    <view 
      class="tab-item {{activeTab === 'cases' ? 'active' : ''}}" 
      bindtap="onTabChange" 
      data-tab="cases"
    >
      ğŸ  æ¡ˆä¾‹
    </view>
  </view>

  <!-- Content Grid (Masonry-like) -->
  <scroll-view class="content-scroll" scroll-y="true">
    <view class="masonry-grid">
      <block wx:for="{{resources}}" wx:key="id">
        <view 
            class="resource-card animate-slide-up {{item.selected ? 'selected' : ''}}" 
            bindtap="onResourceTap" 
            data-id="{{item.id}}" 
            style="animation-delay: {{index * 0.05}}s"
        >
          <!-- Checkbox Overlay -->
          <view class="checkbox-overlay" wx:if="{{isSelectionMode}}">
              <view class="checkbox {{item.selected ? 'checked' : ''}}"></view>
          </view>
          
          <image class="resource-img" src="{{item.image}}" mode="widthFix" lazy-load="true"></image>
          <view class="card-body">
            <view class="resource-title">{{item.title}}</view>
            <view class="resource-meta">
              <text wx:if="{{item.price}}" class="price tag">{{item.price}}</text>
              <text wx:if="{{item.tag}}" class="tag">{{item.tag}}</text>
              <text wx:if="{{item.views}}" class="views">{{item.views}} æµè§ˆ</text>
            </view>
          </view>
        </view>
      </block>
    </view>
    <view class="empty-state" wx:if="{{resources.length === 0 && !loading}}">
        æš‚æ— å†…å®¹
    </view>
    <view style="height: 120rpx;"></view> <!-- Bottom spacer -->
  </scroll-view>

  <!-- Bottom Share Bar -->
  <view class="share-bar animate-slide-up" wx:if="{{isSelectionMode}}">
      <view class="selected-count">å·²é€‰ {{selectedCount}} ä¸ªçµæ„Ÿ</view>
      <button 
        class="share-btn" 
        open-type="share" 
        disabled="{{selectedCount === 0}}"
      >
        ç”Ÿæˆåˆ†äº«èƒ¶å›Š ğŸ’Š
      </button>
  </view>
</view>
