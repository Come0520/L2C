{"numTotalTestSuites":98,"numPassedTestSuites":95,"numFailedTestSuites":3,"numPendingTestSuites":0,"numTotalTests":146,"numPassedTests":143,"numFailedTests":0,"numPendingTests":3,"numTodoTests":0,"snapshot":{"added":0,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0,"didUpdate":false},"startTime":1771864639143,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["配件联动服务 (Accessory Linkage Service)"],"fullName":"配件联动服务 (Accessory Linkage Service) 窗帘主材联动 (Curtain linkage - Track & Service & Accessory)","status":"passed","title":"窗帘主材联动 (Curtain linkage - Track & Service & Accessory)","duration":6.778500000000349,"failureMessages":[],"meta":{}},{"ancestorTitles":["配件联动服务 (Accessory Linkage Service)"],"fullName":"配件联动服务 (Accessory Linkage Service) 墙纸主材联动 (Wallpaper linkage - Glue & Service proportional)","status":"passed","title":"墙纸主材联动 (Wallpaper linkage - Glue & Service proportional)","duration":1.5007999999997992,"failureMessages":[],"meta":{}},{"ancestorTitles":["配件联动服务 (Accessory Linkage Service)"],"fullName":"配件联动服务 (Accessory Linkage Service) 没有对应规则的分类返回空 (Empty for no rules)","status":"passed","title":"没有对应规则的分类返回空 (Empty for no rules)","duration":0.7646000000004278,"failureMessages":[],"meta":{}}],"startTime":1771864651902,"endTime":1771864651910.7646,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/accessory-linkage.service.test.ts"},{"assertionResults":[{"ancestorTitles":["报价单 Actions 集成测试","createQuote - 创建报价单"],"fullName":"报价单 Actions 集成测试 createQuote - 创建报价单 应成功创建报价单并设置 rootQuoteId","status":"passed","title":"应成功创建报价单并设置 rootQuoteId","duration":3126.692799999999,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","deleteQuoteItem - 删除行项目"],"fullName":"报价单 Actions 集成测试 deleteQuoteItem - 删除行项目 应删除行项目并重新计算报价总额","status":"passed","title":"应删除行项目并重新计算报价总额","duration":33.285799999999654,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","deleteQuoteItem - 删除行项目"],"fullName":"报价单 Actions 集成测试 deleteQuoteItem - 删除行项目 行项目不存在时应返回失败","status":"passed","title":"行项目不存在时应返回失败","duration":2.860399999999572,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","submitQuote - 提交报价单"],"fullName":"报价单 Actions 集成测试 submitQuote - 提交报价单 应调用 QuoteLifecycleService.submit","status":"passed","title":"应调用 QuoteLifecycleService.submit","duration":19.658699999999953,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","approveQuote - 审批报价单"],"fullName":"报价单 Actions 集成测试 approveQuote - 审批报价单 应传入租户 ID 调用 QuoteLifecycleService.approve","status":"passed","title":"应传入租户 ID 调用 QuoteLifecycleService.approve","duration":3.0671999999995023,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","rejectQuote - 拒绝报价单"],"fullName":"报价单 Actions 集成测试 rejectQuote - 拒绝报价单 应传入租户 ID 调用 QuoteLifecycleService.reject","status":"passed","title":"应传入租户 ID 调用 QuoteLifecycleService.reject","duration":2.917199999999866,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单 Actions 集成测试","deleteRoom - 删除房间"],"fullName":"报价单 Actions 集成测试 deleteRoom - 删除房间 应删除房间及其行项目并重算总额","status":"passed","title":"应删除房间及其行项目并重算总额","duration":8.399999999999636,"failureMessages":[],"meta":{}}],"startTime":1771864649275,"endTime":1771864652473.4,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/actions.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Bundle Aggregation"],"fullName":"Quote Bundle Aggregation should aggregate totals when adding quotes","status":"passed","title":"should aggregate totals when adding quotes","duration":3.7216000000003078,"failureMessages":[],"meta":{}}],"startTime":1771864642995,"endTime":1771864642998.7217,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/aggregation.test.ts"},{"assertionResults":[{"ancestorTitles":["Bundle Aggregation Logic"],"fullName":"Bundle Aggregation Logic should correctly sum up amounts from linked quotes","status":"passed","title":"should correctly sum up amounts from linked quotes","duration":4.70069999999987,"failureMessages":[],"meta":{}},{"ancestorTitles":["Bundle Aggregation Logic"],"fullName":"Bundle Aggregation Logic should handle bundles with no quotes","status":"passed","title":"should handle bundles with no quotes","duration":0.7979000000000269,"failureMessages":[],"meta":{}}],"startTime":1771864642224,"endTime":1771864642229.7979,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/bundle-aggregator.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Bundle Flow"],"fullName":"Quote Bundle Flow should create a quote bundle","status":"skipped","title":"should create a quote bundle","failureMessages":[],"meta":{}}],"startTime":1771864639143,"endTime":1771864639143,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/bundle-flow.test.ts"},{"assertionResults":[{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","CurtainStrategy (窗帘策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) CurtainStrategy (窗帘策略) 计算高度正常时无预警 (No warning on normal height)","status":"passed","title":"计算高度正常时无预警 (No warning on normal height)","duration":3.6220999999986816,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","CurtainStrategy (窗帘策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) CurtainStrategy (窗帘策略) 超高预警：建议让渡帘头 (Warning: Adjust header)","status":"passed","title":"超高预警：建议让渡帘头 (Warning: Adjust header)","duration":0.6911000000000058,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","CurtainStrategy (窗帘策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) CurtainStrategy (窗帘策略) 超高预警：让渡帘头工艺 (Warning: Limit 13cm)","status":"passed","title":"超高预警：让渡帘头工艺 (Warning: Limit 13cm)","duration":0.3194999999996071,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","CurtainStrategy (窗帘策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) CurtainStrategy (窗帘策略) 定宽工艺计算检验 (Fixed Width Algorithm)","status":"passed","title":"定宽工艺计算检验 (Fixed Width Algorithm)","duration":0.8981000000003405,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","WallpaperStrategy (墙纸墙布策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) WallpaperStrategy (墙纸墙布策略) 墙布计算包含额外对花损耗 (Wallcloth with match pattern loss)","status":"passed","title":"墙布计算包含额外对花损耗 (Wallcloth with match pattern loss)","duration":0.9027000000005501,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","WallpaperStrategy (墙纸墙布策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) WallpaperStrategy (墙纸墙布策略) 标准墙纸使用卷数计算核心逻辑 (Wallpaper Roll count)","status":"passed","title":"标准墙纸使用卷数计算核心逻辑 (Wallpaper Roll count)","duration":0.576600000000326,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","WallpaperStrategy (墙纸墙布策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) WallpaperStrategy (墙纸墙布策略) 墙布超高异常预警 (Wallcloth Over-height exception warning)","status":"passed","title":"墙布超高异常预警 (Wallcloth Over-height exception warning)","duration":0.6322999999993044,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","WallpaperStrategy (墙纸墙布策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) WallpaperStrategy (墙纸墙布策略) 零元计算边界 (Zero Price or Dimension boundary)","status":"passed","title":"零元计算边界 (Zero Price or Dimension boundary)","duration":0.41129999999975553,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StandardProductStrategy (标品策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StandardProductStrategy (标品策略) 正常数量与单价计算 (Normal calculation)","status":"passed","title":"正常数量与单价计算 (Normal calculation)","duration":0.8506999999990512,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StandardProductStrategy (标品策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StandardProductStrategy (标品策略) 数量缺省默认计算 (Missing quantity defaulting)","status":"passed","title":"数量缺省默认计算 (Missing quantity defaulting)","duration":0.505699999999706,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StandardProductStrategy (标品策略)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StandardProductStrategy (标品策略) 浮点数精度测试 (Floating point precision)","status":"passed","title":"浮点数精度测试 (Floating point precision)","duration":0.22530000000006112,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StrategyFactory (策略工厂)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StrategyFactory (策略工厂) 返回 WALLPAPER 对应的 WallpaperStrategy","status":"passed","title":"返回 WALLPAPER 对应的 WallpaperStrategy","duration":0.2541000000001077,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StrategyFactory (策略工厂)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StrategyFactory (策略工厂) 返回 CURTAIN 对应的 CurtainStrategy","status":"passed","title":"返回 CURTAIN 对应的 CurtainStrategy","duration":0.13980000000083237,"failureMessages":[],"meta":{}},{"ancestorTitles":["calc-strategies 边界和异常测试 (Boundary & Exception Tests)","StrategyFactory (策略工厂)"],"fullName":"calc-strategies 边界和异常测试 (Boundary & Exception Tests) StrategyFactory (策略工厂) 默认异常类型返回 StandardProductStrategy","status":"passed","title":"默认异常类型返回 StandardProductStrategy","duration":0.12080000000059954,"failureMessages":[],"meta":{}}],"startTime":1771864650129,"endTime":1771864650140.2542,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/calc-strategies-boundary.test.ts"},{"assertionResults":[{"ancestorTitles":["报价计算服务 (Calculation Service)"],"fullName":"报价计算服务 (Calculation Service) 报价单项不存在时应抛出异常 (Throw on not found)","status":"passed","title":"报价单项不存在时应抛出异常 (Throw on not found)","duration":6.763800000000629,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价计算服务 (Calculation Service)"],"fullName":"报价计算服务 (Calculation Service) 能够根据分类正常派发到标品策略 (Dispatch standard strategy)","status":"passed","title":"能够根据分类正常派发到标品策略 (Dispatch standard strategy)","duration":1.451600000000326,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价计算服务 (Calculation Service)"],"fullName":"报价计算服务 (Calculation Service) 窗帘计算策略处理 (Dispatch curtain strategy)","status":"passed","title":"窗帘计算策略处理 (Dispatch curtain strategy)","duration":1.2939000000005763,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价计算服务 (Calculation Service)"],"fullName":"报价计算服务 (Calculation Service) 墙纸计算策略处理 (Dispatch wallpaper strategy)","status":"passed","title":"墙纸计算策略处理 (Dispatch wallpaper strategy)","duration":1.669499999999971,"failureMessages":[],"meta":{}}],"startTime":1771864652269,"endTime":1771864652280.6694,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/calculation-service.test.ts"},{"assertionResults":[],"startTime":1771864639143,"endTime":1771864639143,"status":"failed","message":" DATABASE_URL is not defined","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/concurrency-protection.test.ts"},{"assertionResults":[],"startTime":1771864639143,"endTime":1771864639143,"status":"failed","message":" DATABASE_URL is not defined","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/e2e-business-flow.test.ts"},{"assertionResults":[],"startTime":1771864639143,"endTime":1771864639143,"status":"failed","message":"Failed to resolve import \"../services/quote-lifecycle.service\" from \"src/features/quotes/__tests__/exception-scenarios.test.ts\". Does the file exist?","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/exception-scenarios.test.ts"},{"assertionResults":[{"ancestorTitles":["尺量匹配服务 (Measure Matcher Service)"],"fullName":"尺量匹配服务 (Measure Matcher Service) 精确匹配：房间名完全相同 (Exact room match fallback to NEW if threshold unmet)","status":"passed","title":"精确匹配：房间名完全相同 (Exact room match fallback to NEW if threshold unmet)","duration":4.795000000000073,"failureMessages":[],"meta":{}},{"ancestorTitles":["尺量匹配服务 (Measure Matcher Service)"],"fullName":"尺量匹配服务 (Measure Matcher Service) 模糊匹配：房间名包含 (Fuzzy room match)","status":"passed","title":"模糊匹配：房间名包含 (Fuzzy room match)","duration":0.616199999998571,"failureMessages":[],"meta":{}},{"ancestorTitles":["尺量匹配服务 (Measure Matcher Service)"],"fullName":"尺量匹配服务 (Measure Matcher Service) 无匹配项自动生成新项目 (New generation when no match)","status":"passed","title":"无匹配项自动生成新项目 (New generation when no match)","duration":0.674300000000585,"failureMessages":[],"meta":{}},{"ancestorTitles":["尺量匹配服务 (Measure Matcher Service)"],"fullName":"尺量匹配服务 (Measure Matcher Service) 防止同一个报价单项目被重复匹配 (Prevent duplicate matching)","status":"passed","title":"防止同一个报价单项目被重复匹配 (Prevent duplicate matching)","duration":1.0599999999994907,"failureMessages":[],"meta":{}}],"startTime":1771864649843,"endTime":1771864649850.06,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/measure-matcher.service.test.ts"},{"assertionResults":[{"ancestorTitles":["Multi-Category Quoting"],"fullName":"Multi-Category Quoting should allow adding items of different categories to the same quote","status":"skipped","title":"should allow adding items of different categories to the same quote","failureMessages":[],"meta":{}}],"startTime":1771864639143,"endTime":1771864639143,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/multi-category-quote.test.ts"},{"assertionResults":[{"ancestorTitles":["快捷报价流程 (Quick Quote Flow)"],"fullName":"快捷报价流程 (Quick Quote Flow) 线索不存在时应返回错误 (Return error when lead missing)","status":"passed","title":"线索不存在时应返回错误 (Return error when lead missing)","duration":3.0820000000003347,"failureMessages":[],"meta":{}},{"ancestorTitles":["快捷报价流程 (Quick Quote Flow)"],"fullName":"快捷报价流程 (Quick Quote Flow) 缺乏必填参数：套餐类型 (Missing Plan Type)","status":"passed","title":"缺乏必填参数：套餐类型 (Missing Plan Type)","duration":0.7665999999990163,"failureMessages":[],"meta":{}},{"ancestorTitles":["快捷报价流程 (Quick Quote Flow)"],"fullName":"快捷报价流程 (Quick Quote Flow) 成功执行正常报价流程并创建客户 (Success flow with customer creation)","status":"passed","title":"成功执行正常报价流程并创建客户 (Success flow with customer creation)","duration":0.43959999999970023,"failureMessages":[],"meta":{}},{"ancestorTitles":["快捷报价流程 (Quick Quote Flow)"],"fullName":"快捷报价流程 (Quick Quote Flow) 跳过未勾选的配项 (Skip unchecked items like sheer/fabric)","status":"passed","title":"跳过未勾选的配项 (Skip unchecked items like sheer/fabric)","duration":1.1926999999996042,"failureMessages":[],"meta":{}}],"startTime":1771864652811,"endTime":1771864652816.1926,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/quick-quote-flow.test.ts"},{"assertionResults":[{"ancestorTitles":["Quick Quote - 编号生成"],"fullName":"Quick Quote - 编号生成 编号格式应为 QQ + 8位时间戳 + UUID 前缀","status":"passed","title":"编号格式应为 QQ + 8位时间戳 + UUID 前缀","duration":3.1288000000004104,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quick Quote - 编号生成"],"fullName":"Quick Quote - 编号生成 两次生成的编号不应重复","status":"passed","title":"两次生成的编号不应重复","duration":2.0503000000007887,"failureMessages":[],"meta":{}}],"startTime":1771864649126,"endTime":1771864649131.0503,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/quick-quote.test.ts"},{"assertionResults":[{"ancestorTitles":["createMeasureFromQuote - 验证报价转量尺"],"fullName":"createMeasureFromQuote - 验证报价转量尺 应验证报价单是否存在","status":"passed","title":"应验证报价单是否存在","duration":14.58770000000004,"failureMessages":[],"meta":{}},{"ancestorTitles":["createMeasureFromQuote - 验证报价转量尺"],"fullName":"createMeasureFromQuote - 验证报价转量尺 应正确创建测量任务","status":"passed","title":"应正确创建测量任务","duration":4.172999999998865,"failureMessages":[],"meta":{}}],"startTime":1771864650697,"endTime":1771864650716.173,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/quote-to-measure.test.ts"},{"assertionResults":[{"ancestorTitles":["报价单版本与生命周期服务 (Quote Version & Lifecycle Service)","createNewVersion (创建新版本)"],"fullName":"报价单版本与生命周期服务 (Quote Version & Lifecycle Service) createNewVersion (创建新版本) 当报价单不存在时抛出异常 (Throw error if quote not found)","status":"passed","title":"当报价单不存在时抛出异常 (Throw error if quote not found)","duration":7.6568999999999505,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单版本与生命周期服务 (Quote Version & Lifecycle Service)","createNewVersion (创建新版本)"],"fullName":"报价单版本与生命周期服务 (Quote Version & Lifecycle Service) createNewVersion (创建新版本) 成功创建新版本并增加版本号 (Successfully create and increment version)","status":"passed","title":"成功创建新版本并增加版本号 (Successfully create and increment version)","duration":2.0278999999991356,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单版本与生命周期服务 (Quote Version & Lifecycle Service)","checkExpirations (过期处理自动化)"],"fullName":"报价单版本与生命周期服务 (Quote Version & Lifecycle Service) checkExpirations (过期处理自动化) 应将超期且状态为PENDING_CUSTOMER的报价单标记为已过期 (Mark expired quotes)","status":"passed","title":"应将超期且状态为PENDING_CUSTOMER的报价单标记为已过期 (Mark expired quotes)","duration":0.9616000000005442,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单版本与生命周期服务 (Quote Version & Lifecycle Service)","activate (设置为主版本)"],"fullName":"报价单版本与生命周期服务 (Quote Version & Lifecycle Service) activate (设置为主版本) 当报价单不存在时抛出异常 (Throw error if quote not found)","status":"passed","title":"当报价单不存在时抛出异常 (Throw error if quote not found)","duration":1.8078999999997905,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单版本与生命周期服务 (Quote Version & Lifecycle Service)","activate (设置为主版本)"],"fullName":"报价单版本与生命周期服务 (Quote Version & Lifecycle Service) activate (设置为主版本) 应成功激活报价单并降级同家族所有版本 (Successfully activate)","status":"passed","title":"应成功激活报价单并降级同家族所有版本 (Successfully activate)","duration":1.7230999999992491,"failureMessages":[],"meta":{}}],"startTime":1771864651681,"endTime":1771864651695.7231,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/quote-version.service.test.ts"},{"assertionResults":[{"ancestorTitles":["Discount Risk Control"],"fullName":"Discount Risk Control should pass valid quote","status":"passed","title":"should pass valid quote","duration":5.338000000000648,"failureMessages":[],"meta":{}},{"ancestorTitles":["Discount Risk Control"],"fullName":"Discount Risk Control should detect high discount (Soft Stop)","status":"passed","title":"should detect high discount (Soft Stop)","duration":1.4132999999992535,"failureMessages":[],"meta":{}},{"ancestorTitles":["Discount Risk Control"],"fullName":"Discount Risk Control should detect low margin (Soft Stop)","status":"passed","title":"should detect low margin (Soft Stop)","duration":1.0091000000002168,"failureMessages":[],"meta":{}},{"ancestorTitles":["Discount Risk Control"],"fullName":"Discount Risk Control should block negative margin (Hard Stop)","status":"passed","title":"should block negative margin (Hard Stop)","duration":1.1446999999998297,"failureMessages":[],"meta":{}}],"startTime":1771864647666,"endTime":1771864647675.1448,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/risk-control.test.ts"},{"assertionResults":[{"ancestorTitles":["Version Management with Bundles"],"fullName":"Version Management with Bundles should maintain bundleId when creating a new version","status":"skipped","title":"should maintain bundleId when creating a new version","failureMessages":[],"meta":{}}],"startTime":1771864639143,"endTime":1771864639143,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/version-bundle.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Version Flow Integration"],"fullName":"Quote Version Flow Integration should set version to ACTIVE and demote others to DRAFT","status":"passed","title":"should set version to ACTIVE and demote others to DRAFT","duration":10.3174999999992,"failureMessages":[],"meta":{}}],"startTime":1771864651897,"endTime":1771864651907.3174,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/version-flow.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Lifecycle Workflow"],"fullName":"Quote Lifecycle Workflow submit should trigger risk check","status":"passed","title":"submit should trigger risk check","duration":2.292199999999866,"failureMessages":[],"meta":{}}],"startTime":1771864650195,"endTime":1771864650197.2922,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/workflow.test.ts"},{"assertionResults":[{"ancestorTitles":["Comprehensive Calculation Engine Verification","Curtain Strategy Edge Cases"],"fullName":"Comprehensive Calculation Engine Verification Curtain Strategy Edge Cases 定高模式：高度刚好达到临界点 (fabric=280, cutHeight=280) - 不应报警","status":"passed","title":"定高模式：高度刚好达到临界点 (fabric=280, cutHeight=280) - 不应报警","duration":3.0533000000014,"failureMessages":[],"meta":{}},{"ancestorTitles":["Comprehensive Calculation Engine Verification","Curtain Strategy Edge Cases"],"fullName":"Comprehensive Calculation Engine Verification Curtain Strategy Edge Cases 定高模式：高度略微超过临界点 (diff <= 13cm) - 应提示让渡帘头","status":"passed","title":"定高模式：高度略微超过临界点 (diff <= 13cm) - 应提示让渡帘头","duration":0.9698000000007596,"failureMessages":[],"meta":{}},{"ancestorTitles":["Comprehensive Calculation Engine Verification","Curtain Strategy Edge Cases"],"fullName":"Comprehensive Calculation Engine Verification Curtain Strategy Edge Cases 定宽模式：极宽窗户 (12米) - 应正确计算幅数","status":"passed","title":"定宽模式：极宽窗户 (12米) - 应正确计算幅数","duration":0.4969999999993888,"failureMessages":[],"meta":{}},{"ancestorTitles":["Comprehensive Calculation Engine Verification","Wallpaper Strategy Edge Cases"],"fullName":"Comprehensive Calculation Engine Verification Wallpaper Strategy Edge Cases 墙纸对花逻辑：花距极大 (64cm) 导致每卷可切条数减少","status":"passed","title":"墙纸对花逻辑：花距极大 (64cm) 导致每卷可切条数减少","duration":1.2756000000008498,"failureMessages":[],"meta":{}},{"ancestorTitles":["Comprehensive Calculation Engine Verification","Wallpaper Strategy Edge Cases"],"fullName":"Comprehensive Calculation Engine Verification Wallpaper Strategy Edge Cases 墙纸逻辑：高度正好是 2.5m (10m 卷理应切 4 条，但考虑 cutLoss 只能切 3 条)","status":"passed","title":"墙纸逻辑：高度正好是 2.5m (10m 卷理应切 4 条，但考虑 cutLoss 只能切 3 条)","duration":0.7466999999996915,"failureMessages":[],"meta":{}}],"startTime":1771864649819,"endTime":1771864649826.7466,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/calc-strategies/__tests__/comprehensive-calc.test.ts"},{"assertionResults":[{"ancestorTitles":["CurtainStrategy"],"fullName":"CurtainStrategy Calculate Fixed Height - Exact Match","status":"passed","title":"Calculate Fixed Height - Exact Match","duration":3.5234999999993306,"failureMessages":[],"meta":{}},{"ancestorTitles":["CurtainStrategy"],"fullName":"CurtainStrategy Calculate Fixed Height - Warning (Header Yield)","status":"passed","title":"Calculate Fixed Height - Warning (Header Yield)","duration":1.085799999998926,"failureMessages":[],"meta":{}},{"ancestorTitles":["CurtainStrategy"],"fullName":"CurtainStrategy Calculate Fixed Width","status":"passed","title":"Calculate Fixed Width","duration":0.45280000000093423,"failureMessages":[],"meta":{}},{"ancestorTitles":["CurtainStrategy"],"fullName":"CurtainStrategy Calculate Single Opening Loss","status":"passed","title":"Calculate Single Opening Loss","duration":1.1629999999986467,"failureMessages":[],"meta":{}}],"startTime":1771864649797,"endTime":1771864649804.163,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/calc-strategies/__tests__/curtain-strategy.test.ts"},{"assertionResults":[{"ancestorTitles":["WallpaperStrategy","墙纸计算 (WALLPAPER - 卷数计算)"],"fullName":"WallpaperStrategy 墙纸计算 (WALLPAPER - 卷数计算) 应正确计算基础墙纸卷数 - 单墙面","status":"passed","title":"应正确计算基础墙纸卷数 - 单墙面","duration":3.092899999999645,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","墙纸计算 (WALLPAPER - 卷数计算)"],"fullName":"WallpaperStrategy 墙纸计算 (WALLPAPER - 卷数计算) 应正确计算多墙段墙纸卷数","status":"passed","title":"应正确计算多墙段墙纸卷数","duration":0.5357000000003609,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","墙纸计算 (WALLPAPER - 卷数计算)"],"fullName":"WallpaperStrategy 墙纸计算 (WALLPAPER - 卷数计算) 应正确处理花距对花逻辑","status":"passed","title":"应正确处理花距对花逻辑","duration":0.35600000000158616,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","墙布计算 (WALLCLOTH - 面积计算)"],"fullName":"WallpaperStrategy 墙布计算 (WALLCLOTH - 面积计算) 应正确计算墙布面积 - 单墙面","status":"passed","title":"应正确计算墙布面积 - 单墙面","duration":1.1178999999992811,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","墙布计算 (WALLCLOTH - 面积计算)"],"fullName":"WallpaperStrategy 墙布计算 (WALLCLOTH - 面积计算) 应正确计算多墙段墙布用量","status":"passed","title":"应正确计算多墙段墙布用量","duration":0.4621000000006461,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","墙布计算 (WALLCLOTH - 面积计算)"],"fullName":"WallpaperStrategy 墙布计算 (WALLCLOTH - 面积计算) 应在墙高超过幅宽时发出警告","status":"passed","title":"应在墙高超过幅宽时发出警告","duration":0.6318000000010215,"failureMessages":[],"meta":{}},{"ancestorTitles":["WallpaperStrategy","默认配置"],"fullName":"WallpaperStrategy 默认配置 应正确设置默认损耗参数","status":"passed","title":"应正确设置默认损耗参数","duration":0.7476999999998952,"failureMessages":[],"meta":{}}],"startTime":1771864649797,"endTime":1771864649805.7478,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/calc-strategies/__tests__/wallpaper-strategy.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Actions Audit Integration","createQuote"],"fullName":"Quote Actions Audit Integration createQuote 创建报价单时应记录审计日志","status":"passed","title":"创建报价单时应记录审计日志","duration":15.476800000000367,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","updateQuote"],"fullName":"Quote Actions Audit Integration updateQuote 更新报价单折扣应记录审计日志","status":"passed","title":"更新报价单折扣应记录审计日志","duration":5.650100000000748,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","copyQuote"],"fullName":"Quote Actions Audit Integration copyQuote 复制报价单应记录审计日志","status":"passed","title":"复制报价单应记录审计日志","duration":2.0909999999985303,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 提交报价单应记录审计日志","status":"passed","title":"提交报价单应记录审计日志","duration":2.9578999999994267,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 拒绝报价单应记录审计日志","status":"passed","title":"拒绝报价单应记录审计日志","duration":1.7034999999996217,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 锁定报价单应记录审计日志","status":"passed","title":"锁定报价单应记录审计日志","duration":3.0666000000001077,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 解锁报价单应记录审计日志","status":"passed","title":"解锁报价单应记录审计日志","duration":1.9839999999985594,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 审批报价单应记录审计日志","status":"passed","title":"审批报价单应记录审计日志","duration":1.242099999999482,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 转订单应记录审计日志","status":"passed","title":"转订单应记录审计日志","duration":2.165399999999863,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Actions Audit Integration","Lifecycle Actions"],"fullName":"Quote Actions Audit Integration Lifecycle Actions 创建新版本应记录审计日志","status":"passed","title":"创建新版本应记录审计日志","duration":1.5379000000011729,"failureMessages":[],"meta":{}}],"startTime":1771864651945,"endTime":1771864651983.5378,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/audit-integration.test.ts"},{"assertionResults":[{"ancestorTitles":["Calc Actions (L5)"],"fullName":"Calc Actions (L5) getCalcPreview 应当调用对应的计算策略并返回结果","status":"passed","title":"getCalcPreview 应当调用对应的计算策略并返回结果","duration":1517.6013000000003,"failureMessages":[],"meta":{}},{"ancestorTitles":["Calc Actions (L5)"],"fullName":"Calc Actions (L5) getCalcPreview 缺少登录信息时抛出异常","status":"passed","title":"getCalcPreview 缺少登录信息时抛出异常","duration":3.799699999999575,"failureMessages":[],"meta":{}},{"ancestorTitles":["Calc Actions (L5)"],"fullName":"Calc Actions (L5) recalculateQuote 应当遍历所有明细项并重新计算总计，同时更新 DB","status":"passed","title":"recalculateQuote 应当遍历所有明细项并重新计算总计，同时更新 DB","duration":6.433199999999488,"failureMessages":[],"meta":{}},{"ancestorTitles":["Calc Actions (L5)"],"fullName":"Calc Actions (L5) recalculateQuote 当查询不到报价单时应报错返回","status":"passed","title":"recalculateQuote 当查询不到报价单时应报错返回","duration":1.2914999999993597,"failureMessages":[],"meta":{}},{"ancestorTitles":["Calc Actions (L5)"],"fullName":"Calc Actions (L5) recalculateQuote 缺少登录信息时应被拦截","status":"passed","title":"recalculateQuote 缺少登录信息时应被拦截","duration":0.7651000000005297,"failureMessages":[],"meta":{}}],"startTime":1771864649435,"endTime":1771864650965.7651,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/calc-actions.test.ts"},{"assertionResults":[{"ancestorTitles":["Calculation Engine Integration (recalculateQuote)"],"fullName":"Calculation Engine Integration (recalculateQuote) should calculate Curtain quantity and update DB","status":"passed","title":"should calculate Curtain quantity and update DB","duration":7.428799999999683,"failureMessages":[],"meta":{}},{"ancestorTitles":["Calculation Engine Integration (recalculateQuote)"],"fullName":"Calculation Engine Integration (recalculateQuote) should calculate Wallcloth usage (Perimeter) and update DB","status":"passed","title":"should calculate Wallcloth usage (Perimeter) and update DB","duration":2.400000000001455,"failureMessages":[],"meta":{}}],"startTime":1771864651490,"endTime":1771864651499.4,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/calc-integration.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuote 应当验证租户隔离并返回报价详情","status":"passed","title":"getQuote 应当验证租户隔离并返回报价详情","duration":2545.532,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuotes 应当支持分页和租户隔离","status":"passed","title":"getQuotes 应当支持分页和租户隔离","duration":5.2203000000008615,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuoteBundleById 应当处理未授权访问并返回带有 subQuotes 的数据","status":"passed","title":"getQuoteBundleById 应当处理未授权访问并返回带有 subQuotes 的数据","duration":2.4067999999988388,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuoteVersions 应当隔离租户并返回关联根节点的所有版本","status":"passed","title":"getQuoteVersions 应当隔离租户并返回关联根节点的所有版本","duration":1.8922999999995227,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuoteAuditLogs 应当先验证报价单归属然后再查询日志","status":"passed","title":"getQuoteAuditLogs 应当先验证报价单归属然后再查询日志","duration":1.7170999999998457,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Queries (L5)"],"fullName":"Quote Queries (L5) getQuoteAuditLogs 如果报价单不属于当前租户应当抛出异常","status":"passed","title":"getQuoteAuditLogs 如果报价单不属于当前租户应当抛出异常","duration":3.4589000000014494,"failureMessages":[],"meta":{}}],"startTime":1771864647290,"endTime":1771864649850.459,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/queries.test.ts"},{"assertionResults":[{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) createQuoteBundle 应创建报价套餐并指定 rootQuoteId","status":"passed","title":"createQuoteBundle 应创建报价套餐并指定 rootQuoteId","duration":1941.2052000000003,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) createQuote 应创建报价单并触发更新套餐总额 (如果带 bundleId)","status":"passed","title":"createQuote 应创建报价单并触发更新套餐总额 (如果带 bundleId)","duration":4.278899999999339,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) updateQuote 应根据折扣和原价计算出 finalAmount","status":"passed","title":"updateQuote 应根据折扣和原价计算出 finalAmount","duration":7.32760000000053,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) copyQuote 应当调用 QuoteService 委托处理新复制","status":"passed","title":"copyQuote 应当调用 QuoteService 委托处理新复制","duration":4.1810999999997875,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) 在查询不到报价单时 updateQuote 会被阻拦并抛出错误","status":"passed","title":"在查询不到报价单时 updateQuote 会被阻拦并抛出错误","duration":6.960800000000745,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) updateQuote 版本冲突：传入旧 version 时应抛出 CONCURRENCY_CONFLICT","status":"passed","title":"updateQuote 版本冲突：传入旧 version 时应抛出 CONCURRENCY_CONFLICT","duration":2.447700000000623,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quotes CRUD Actions (L5)"],"fullName":"Quotes CRUD Actions (L5) updateQuote 正常版本更新：传入正确 version 应更新成功且 set 含 version 自增表达式","status":"passed","title":"updateQuote 正常版本更新：传入正确 version 应更新成功且 set 含 version 自增表达式","duration":1.9487000000008265,"failureMessages":[],"meta":{}}],"startTime":1771864649568,"endTime":1771864651536.9487,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/quote-crud.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Items CRUD Actions (L5)"],"fullName":"Quote Items CRUD Actions (L5) createQuoteItem 应当成功记录并在通过计算策略获取到用量","status":"passed","title":"createQuoteItem 应当成功记录并在通过计算策略获取到用量","duration":1779.6527000000006,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Items CRUD Actions (L5)"],"fullName":"Quote Items CRUD Actions (L5) updateQuoteItem 应当成功读取旧数据合并计算并更新","status":"passed","title":"updateQuoteItem 应当成功读取旧数据合并计算并更新","duration":5.2783999999992375,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Items CRUD Actions (L5)"],"fullName":"Quote Items CRUD Actions (L5) deleteQuoteItem 应当记录审计日志并删除","status":"passed","title":"deleteQuoteItem 应当记录审计日志并删除","duration":4.207300000000032,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Items CRUD Actions (L5)"],"fullName":"Quote Items CRUD Actions (L5) reorderQuoteItems 应在事务内批量刷新排序","status":"passed","title":"reorderQuoteItems 应在事务内批量刷新排序","duration":3.7026000000005297,"failureMessages":[],"meta":{}}],"startTime":1771864649692,"endTime":1771864651485.7026,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/quote-item-crud.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) submitQuote 应检查编辑权限并调用生命周期服务","status":"passed","title":"submitQuote 应检查编辑权限并调用生命周期服务","duration":3321.7382,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) rejectQuote 应检查审批权限并带上拒绝理由","status":"passed","title":"rejectQuote 应检查审批权限并带上拒绝理由","duration":2.89259999999922,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) lockQuote 应检查编辑权限和当前锁定状态，并直接更新 DB","status":"passed","title":"lockQuote 应检查编辑权限和当前锁定状态，并直接更新 DB","duration":5.484900000001289,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) lockQuote 遇到已锁定的报价单会抛出异常","status":"passed","title":"lockQuote 遇到已锁定的报价单会抛出异常","duration":4.547200000000885,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) unlockQuote 应清除锁定标记","status":"passed","title":"unlockQuote 应清除锁定标记","duration":2.3927999999996246,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) approveQuote 应验证审批权限并调用生命周期服务","status":"passed","title":"approveQuote 应验证审批权限并调用生命周期服务","duration":1.3996999999999389,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) convertQuoteToOrder 应验证新建订单权限并调用生命周期服务","status":"passed","title":"convertQuoteToOrder 应验证新建订单权限并调用生命周期服务","duration":2.8101999999998952,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) createNextVersion 应当验证创建报价单权限并交由 QuoteService 创建新版本","status":"passed","title":"createNextVersion 应当验证创建报价单权限并交由 QuoteService 创建新版本","duration":2.884200000000419,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) 执行缺少权限操作时应被阻断","status":"passed","title":"执行缺少权限操作时应被阻断","duration":1.5807000000004336,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) lockQuote 版本冲突：传入旧 version 后 db.update 返回空时应抛出并发错误","status":"passed","title":"lockQuote 版本冲突：传入旧 version 后 db.update 返回空时应抛出并发错误","duration":1.6069000000006781,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) lockQuote 正常锁定时 set 调用应包含 version 自增表达式","status":"passed","title":"lockQuote 正常锁定时 set 调用应包含 version 自增表达式","duration":1.9013000000013562,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) unlockQuote 应同步递增 version","status":"passed","title":"unlockQuote 应同步递增 version","duration":1.1283999999996013,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) submitQuote 正常版本检查：传入 version 时应先调用 preflightVersionCheck（即触发 db.update）","status":"passed","title":"submitQuote 正常版本检查：传入 version 时应先调用 preflightVersionCheck（即触发 db.update）","duration":3.764500000001135,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) submitQuote 版本冲突：传入 version 但 db.update 未找到记录时应抛出错误","status":"passed","title":"submitQuote 版本冲突：传入 version 但 db.update 未找到记录时应抛出错误","duration":1.4077999999990425,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) approveQuote 正常版本检查逻辑同 submitQuote","status":"passed","title":"approveQuote 正常版本检查逻辑同 submitQuote","duration":2.073500000000422,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle Actions (L5)"],"fullName":"Quote Lifecycle Actions (L5) rejectQuote 正常版本检查逻辑同 submitQuote","status":"passed","title":"rejectQuote 正常版本检查逻辑同 submitQuote","duration":1.6797999999998865,"failureMessages":[],"meta":{}}],"startTime":1771864647403,"endTime":1771864650763.6797,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/quote-lifecycle-actions.test.ts"},{"assertionResults":[{"ancestorTitles":["报价单模块 - 租户隔离安全测试","getQuote - 查询隔离"],"fullName":"报价单模块 - 租户隔离安全测试 getQuote - 查询隔离 应该阻止租户 A 访问租户 B 的报价单","status":"passed","title":"应该阻止租户 A 访问租户 B 的报价单","duration":3369.341700000001,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 租户隔离安全测试","getQuote - 查询隔离"],"fullName":"报价单模块 - 租户隔离安全测试 getQuote - 查询隔离 应该允许访问同租户的报价单","status":"passed","title":"应该允许访问同租户的报价单","duration":1.2957000000005792,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 租户隔离安全测试","未认证用户访问"],"fullName":"报价单模块 - 租户隔离安全测试 未认证用户访问 应该拒绝未登录用户的请求","status":"passed","title":"应该拒绝未登录用户的请求","duration":3.589400000000751,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 租户隔离安全测试","未认证用户访问"],"fullName":"报价单模块 - 租户隔离安全测试 未认证用户访问 应该拒绝没有 tenantId 的用户","status":"passed","title":"应该拒绝没有 tenantId 的用户","duration":1.4655000000002474,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 状态流转安全测试"],"fullName":"报价单模块 - 状态流转安全测试 不应允许非 DRAFT/REJECTED 状态的报价单提交","status":"passed","title":"不应允许非 DRAFT/REJECTED 状态的报价单提交","duration":0.3408999999992375,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 状态流转安全测试"],"fullName":"报价单模块 - 状态流转安全测试 不应允许非 PENDING_CUSTOMER/APPROVED 状态的报价单转订单","status":"passed","title":"不应允许非 PENDING_CUSTOMER/APPROVED 状态的报价单转订单","duration":0.2430000000003929,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 数据防泄露 (Data Leakage Prevention)"],"fullName":"报价单模块 - 数据防泄露 (Data Leakage Prevention) getQuote 不应请求 costPrice 字段","status":"passed","title":"getQuote 不应请求 costPrice 字段","duration":2.142700000000332,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 跨租户操作防护"],"fullName":"报价单模块 - 跨租户操作防护 reorderQuoteItems 应该验证报价单归属","status":"passed","title":"reorderQuoteItems 应该验证报价单归属","duration":1177.9763000000003,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 跨租户操作防护"],"fullName":"报价单模块 - 跨租户操作防护 updateQuoteItem 应该验证行项目归属","status":"passed","title":"updateQuoteItem 应该验证行项目归属","duration":3751.0182999999997,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 跨租户操作防护"],"fullName":"报价单模块 - 跨租户操作防护 lockQuote 应该从 context 获取 tenantId","status":"passed","title":"lockQuote 应该从 context 获取 tenantId","duration":6.061700000000201,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 跨租户操作防护"],"fullName":"报价单模块 - 跨租户操作防护 createRoom 应该验证 quoteId 归属 (防止 IDOR)","status":"passed","title":"createRoom 应该验证 quoteId 归属 (防止 IDOR)","duration":6.471199999999953,"failureMessages":[],"meta":{}},{"ancestorTitles":["报价单模块 - 跨租户操作防护"],"fullName":"报价单模块 - 跨租户操作防护 createQuoteItem 应该验证 quoteId 归属 (防止 IDOR)","status":"passed","title":"createQuoteItem 应该验证 quoteId 归属 (防止 IDOR)","duration":5.6995999999999185,"failureMessages":[],"meta":{}}],"startTime":1771864647662,"endTime":1771864655989.6997,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/actions/__tests__/security.test.ts"},{"assertionResults":[{"ancestorTitles":["Attachment Calculation"],"fullName":"Attachment Calculation should pass placeholder test","status":"passed","title":"should pass placeholder test","duration":2.8994000000002416,"failureMessages":[],"meta":{}}],"startTime":1771864649125,"endTime":1771864649127.8994,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/logic/__tests__/attachment-calc.test.ts"},{"assertionResults":[{"ancestorTitles":["Curtain Calculation Warnings"],"fullName":"Curtain Calculation Warnings should pass placeholder test","status":"passed","title":"should pass placeholder test","duration":2.4671999999991385,"failureMessages":[],"meta":{}}],"startTime":1771864649846,"endTime":1771864649848.4673,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/logic/__tests__/curtain-calc-warnings.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Version Compare Logic"],"fullName":"Quote Version Compare Logic should detect no changes for identical items","status":"passed","title":"should detect no changes for identical items","duration":4.650799999999435,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Version Compare Logic"],"fullName":"Quote Version Compare Logic should detect changes in basic fields (quantity, price)","status":"passed","title":"should detect changes in basic fields (quantity, price)","duration":1.30239999999867,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Version Compare Logic"],"fullName":"Quote Version Compare Logic should detect changes in specs (fabricDirection)","status":"passed","title":"should detect changes in specs (fabricDirection)","duration":0.7726000000002387,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Version Compare Logic"],"fullName":"Quote Version Compare Logic should handle missing specs gracefully","status":"passed","title":"should handle missing specs gracefully","duration":0.6925000000010186,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Version Compare Logic"],"fullName":"Quote Version Compare Logic should treat null and undefined as equal for optional fields","status":"passed","title":"should treat null and undefined as equal for optional fields","duration":1.3479999999999563,"failureMessages":[],"meta":{}}],"startTime":1771864649358,"endTime":1771864649366.348,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/logic/__tests__/quote-version-compare.test.ts"},{"assertionResults":[{"ancestorTitles":["Quote Lifecycle E2E Integration","Scenario A: Standard Lifecycle (Happy Path)"],"fullName":"Quote Lifecycle E2E Integration Scenario A: Standard Lifecycle (Happy Path) should successfully submit and convert a low-risk quote to an order","status":"passed","title":"should successfully submit and convert a low-risk quote to an order","duration":11.49120000000039,"failureMessages":[],"meta":{}},{"ancestorTitles":["Quote Lifecycle E2E Integration","Scenario B: High Risk Workflow"],"fullName":"Quote Lifecycle E2E Integration Scenario B: High Risk Workflow should block or require approval for high risk quotes","status":"passed","title":"should block or require approval for high risk quotes","duration":2.390799999999217,"failureMessages":[],"meta":{}}],"startTime":1771864652728,"endTime":1771864652742.3909,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/integration/lifecycle.test.ts"},{"assertionResults":[{"ancestorTitles":["QuoteService.refreshExpiredQuotePrices"],"fullName":"QuoteService.refreshExpiredQuotePrices should batch fetch products and update items with changed prices","status":"passed","title":"should batch fetch products and update items with changed prices","duration":12.279599999999846,"failureMessages":[],"meta":{}},{"ancestorTitles":["QuoteService.refreshExpiredQuotePrices"],"fullName":"QuoteService.refreshExpiredQuotePrices should throw error if quote is not expired or draft","status":"passed","title":"should throw error if quote is not expired or draft","duration":3.7430999999996857,"failureMessages":[],"meta":{}}],"startTime":1771864651990,"endTime":1771864652005.7432,"status":"passed","message":"","name":"C:/Users/bigey/Documents/Antigravity/L2C/src/features/quotes/__tests__/unit/expiration.test.ts"}]}