[{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\channel-actions.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1734,1737],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1734,1737],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2258,2261],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2258,2261],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":85,"column":93,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":96,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2650,2653],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2650,2653],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":91,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":94,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3264,3267],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3264,3267],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5051,5054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5051,5054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":82,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":85,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5138,5141],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5138,5141],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5796,5799],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5796,5799],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { describe, it, expect, vi, beforeEach } from 'vitest';\r\nimport {\r\n    getChannelCategories,\r\n    getChannels,\r\n    createChannel,\r\n    deleteChannel\r\n} from '../actions';\r\nimport { db } from '@/shared/api/db';\r\nimport * as authLib from '@/shared/lib/auth';\r\nimport { AuditService } from '@/shared/services/audit-service';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// Mock dependencies\r\nvi.mock('@/shared/api/db', () => ({\r\n    db: {\r\n        query: {\r\n            marketChannels: {\r\n                findFirst: vi.fn(),\r\n                findMany: vi.fn(),\r\n            },\r\n        },\r\n        insert: vi.fn(() => ({ values: vi.fn(() => ({ returning: vi.fn() })) })),\r\n        update: vi.fn(() => ({ set: vi.fn(() => ({ where: vi.fn(() => ({ returning: vi.fn() })) })) })),\r\n        delete: vi.fn(() => ({ where: vi.fn() })),\r\n    },\r\n}));\r\n\r\nvi.mock('@/shared/lib/auth', () => ({\r\n    auth: vi.fn(),\r\n    checkPermission: vi.fn(),\r\n}));\r\n\r\nvi.mock('@/shared/services/audit-service', () => ({\r\n    AuditService: {\r\n        log: vi.fn(),\r\n    },\r\n}));\r\n\r\nvi.mock('next/cache', () => ({\r\n    revalidatePath: vi.fn(),\r\n}));\r\n\r\nvi.mock('@/shared/config/permissions', () => ({\r\n    PERMISSIONS: {\r\n        SETTINGS: {\r\n            MANAGE: 'settings:manage',\r\n        },\r\n    },\r\n}));\r\n\r\ndescribe('Channel Actions - Task 4: Channel CRUD & Cascade Delete', () => {\r\n    const mockTenantId = 'tenant-1';\r\n    const mockUserId = 'user-1';\r\n    const mockSession = {\r\n        user: {\r\n            id: mockUserId,\r\n            tenantId: mockTenantId,\r\n        },\r\n    };\r\n\r\n    beforeEach(() => {\r\n        vi.resetAllMocks();\r\n\r\n        // Setup default behaviors\r\n        vi.mocked(authLib.auth).mockResolvedValue(mockSession as any);\r\n        vi.mocked(authLib.checkPermission).mockResolvedValue(true);\r\n\r\n        // Setup DB defaults\r\n        vi.mocked(db.query.marketChannels.findMany).mockResolvedValue([]);\r\n        vi.mocked(db.query.marketChannels.findFirst).mockResolvedValue(null);\r\n\r\n        // Setup Insert default\r\n        const returnMock = vi.fn().mockResolvedValue([{ id: 'new-id' }]);\r\n        const valuesMock = vi.fn().mockReturnValue({ returning: returnMock });\r\n        vi.mocked(db.insert).mockReturnValue({ values: valuesMock } as any);\r\n    });\r\n\r\n    describe('getChannelCategories', () => {\r\n        it('搴旇杩斿洖鎵€鏈夐《绾ф笭閬撳垎绫?, async () => {\r\n            const mockCategories = [\r\n                { id: 'cat1', name: 'Category 1', parentId: null },\r\n                { id: 'cat2', name: 'Category 2', parentId: 'cat1' },\r\n            ];\r\n            vi.mocked(db.query.marketChannels.findMany).mockResolvedValue(mockCategories as any);\r\n\r\n            const result = await getChannelCategories();\r\n\r\n            expect(result.success).toBe(true);\r\n            expect(result.data).toHaveLength(1);\r\n            expect(result.data[0].id).toBe('cat1');\r\n        });\r\n    });\r\n\r\n    describe('getChannels', () => {\r\n        it('搴旇杩斿洖褰撳墠绉熸埛鐨勬笭閬撳垪琛?, async () => {\r\n            const mockChannels = [\r\n                { id: 'c1', name: 'Channel 1', tenantId: mockTenantId },\r\n                { id: 'c2', name: 'Channel 2', tenantId: mockTenantId },\r\n            ];\r\n            vi.mocked(db.query.marketChannels.findMany).mockResolvedValue(mockChannels as any);\r\n\r\n            const result = await getChannels();\r\n\r\n            expect(result.success).toBe(true);\r\n            expect(result.data).toEqual(mockChannels);\r\n        });\r\n    });\r\n\r\n    describe('createChannel', () => {\r\n        const newChannelData = {\r\n            name: 'New Channel',\r\n            category: 'Category 1' as const,\r\n            type: 'DIRECT' as const,\r\n            isActive: true,\r\n        };\r\n\r\n        it('鏈夋晥鏁版嵁搴旀垚鍔熷垱寤烘笭閬?, async () => {\r\n            const result = await createChannel(newChannelData);\r\n            // Wrapper success\r\n            expect(result.success).toBe(true);\r\n            // Handler success\r\n            expect(result.data).toBeDefined();\r\n            expect(result.data?.success).toBe(true);\r\n\r\n            expect(db.insert).toHaveBeenCalled();\r\n            expect(revalidatePath).toHaveBeenCalled();\r\n        });\r\n\r\n        it('鏃犳潈闄愬簲杩斿洖閿欒', async () => {\r\n            vi.mocked(authLib.checkPermission).mockRejectedValue(new Error('Unauthorized'));\r\n\r\n            const result = await createChannel(newChannelData);\r\n\r\n            // Handler catches error and returns { success: false }, so wrapper sees success\r\n            expect(result.success).toBe(true);\r\n            expect(result.data?.success).toBe(false);\r\n            expect(result.data?.error).toMatch(/鏃犳潈闄恷Unauthorized/);\r\n        });\r\n    });\r\n\r\n    describe('deleteChannel', () => {\r\n        const channelId = 'channel-to-delete';\r\n\r\n        it('瀛樺湪瀛愭笭閬撴椂搴旂姝㈠垹闄?, async () => {\r\n            // Mock findFirst sequence:\r\n            // 1. Existing channel check -> returns channel\r\n            // 2. Child channel check -> returns child\r\n            vi.mocked(db.query.marketChannels.findFirst)\r\n                .mockResolvedValueOnce({ id: channelId, tenantId: mockTenantId } as any)\r\n                .mockResolvedValueOnce({ id: 'child-1', parentId: channelId } as any);\r\n\r\n            const result = await deleteChannel({ id: channelId });\r\n\r\n            expect(result.success).toBe(true);\r\n            expect(result.data?.success).toBe(false);\r\n            expect(result.data?.error).toBe('璇ユ笭閬撲笅瀛樺湪瀛愭笭閬擄紝鏃犳硶鍒犻櫎');\r\n            expect(db.delete).not.toHaveBeenCalled();\r\n        });\r\n\r\n        it('鏃犲瓙娓犻亾涓斿瓨鍦ㄦ椂搴旀垚鍔熷垹闄?, async () => {\r\n            // Mock findFirst sequence:\r\n            // 1. Existing channel check -> returns channel\r\n            // 2. Child channel check -> returns null\r\n            vi.mocked(db.query.marketChannels.findFirst)\r\n                .mockResolvedValueOnce({ id: channelId, tenantId: mockTenantId } as any)\r\n                .mockResolvedValueOnce(null);\r\n\r\n            const result = await deleteChannel({ id: channelId });\r\n\r\n            expect(result.success).toBe(true);\r\n            expect(result.data?.success).toBe(true);\r\n            expect(db.delete).toHaveBeenCalled();\r\n            expect(AuditService.log).toHaveBeenCalledWith(db, expect.objectContaining({\r\n                action: 'DELETE',\r\n                recordId: channelId,\r\n            }));\r\n        });\r\n\r\n        it('娓犻亾涓嶅瓨鍦ㄦ椂搴旇繑鍥為敊璇?, async () => {\r\n            // Mock findFirst sequence:\r\n            // 1. Existing channel check -> returns null\r\n            vi.mocked(db.query.marketChannels.findFirst).mockResolvedValueOnce(null);\r\n\r\n            const result = await deleteChannel({ id: 'non-existent' });\r\n\r\n            expect(result.success).toBe(true);\r\n            expect(result.data?.success).toBe(false);\r\n            expect(result.data?.error).toBe('娓犻亾涓嶅瓨鍦ㄦ垨鏃犳潈鎿嶄綔');\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\preference-actions.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'z' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[786,789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[786,789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[800,803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[800,803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[839,842],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[839,842],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, vi, beforeEach } from 'vitest';\r\nimport { z } from 'zod';\r\n\r\n// 浣跨敤 vi.hoisted 鎻愬崌 mock 瀹氫箟\r\nconst mocks = vi.hoisted(() => ({\r\n    auth: vi.fn(),\r\n    revalidatePath: vi.fn(),\r\n    logAudit: vi.fn(),\r\n    dbFindFirst: vi.fn(),\r\n    dbUpdate: vi.fn(),\r\n    // Drizzle ORM mocks\r\n    eq: vi.fn(),\r\n}));\r\n\r\n// Mock 渚濊禆 - 椤哄簭寰堥噸瑕乗r\nvi.mock('@/shared/lib/auth', () => ({\r\n    auth: mocks.auth,\r\n}));\r\nvi.mock('next/cache', () => ({ revalidatePath: mocks.revalidatePath }));\r\nvi.mock('@/shared/services/audit-service', () => ({\r\n    AuditService: { log: mocks.logAudit },\r\n}));\r\n\r\n// Mock drizzle-orm\r\nvi.mock('drizzle-orm', () => ({\r\n    eq: mocks.eq,\r\n}));\r\n\r\n// Mock createSafeAction\r\nvi.mock('@/shared/lib/server-action', () => ({\r\n    createSafeAction: (schema: any, handler: any) => {\r\n        return async (data: any) => {\r\n            const parsed = schema.safeParse(data);\r\n            if (!parsed.success) {\r\n                return { success: false, error: 'Validation Error' };\r\n            }\r\n            const ctx = { session: await mocks.auth() };\r\n            return handler(parsed.data, ctx);\r\n        }\r\n    }\r\n}));\r\n\r\n// Mock DB\r\nvi.mock('@/shared/api/db', () => {\r\n    const createUpdateChain = () => ({\r\n        set: vi.fn().mockReturnValue({\r\n            where: vi.fn().mockResolvedValue({}),\r\n        }),\r\n    });\r\n\r\n    return {\r\n        db: {\r\n            query: {\r\n                users: {\r\n                    findFirst: mocks.dbFindFirst,\r\n                },\r\n            },\r\n            update: vi.fn().mockReturnValue(createUpdateChain()),\r\n        },\r\n    };\r\n});\r\n\r\n// Mock schema\r\nvi.mock('@/shared/api/schema', () => ({\r\n    users: { id: 'users-id-column' },\r\n}));\r\n\r\nimport { getUserPreferences, updateUserPreferences } from '../actions/preference-actions';\r\n\r\ndescribe('PreferenceActions', () => {\r\n    const mockUserId = 'user-current';\r\n    const mockTenantId = 'tenant-1';\r\n    const mockSession = {\r\n        user: { id: mockUserId, tenantId: mockTenantId },\r\n    };\r\n\r\n    beforeEach(() => {\r\n        vi.clearAllMocks();\r\n        mocks.auth.mockResolvedValue(mockSession);\r\n        // 璁剧疆 eq 杩斿洖涓€涓爣璇嗗璞★紝鐢ㄤ簬楠岃瘉璋冪敤\r\n        mocks.eq.mockImplementation((col, val) => ({ col, val }));\r\n    });\r\n\r\n    // === getUserPreferences 娴嬭瘯 ===\r\n    describe('getUserPreferences', () => {\r\n        it('搴旀垚鍔熻幏鍙栫敤鎴峰亸濂?, async () => {\r\n            mocks.dbFindFirst.mockResolvedValue({\r\n                preferences: { quoteMode: 'SPACE_FIRST' },\r\n            });\r\n\r\n            const result = await getUserPreferences();\r\n            expect(result).toEqual({ quoteMode: 'SPACE_FIRST' });\r\n        });\r\n\r\n        it('褰撶敤鎴锋棤鍋忓ソ鏃跺簲杩斿洖榛樿鍊?, async () => {\r\n            mocks.dbFindFirst.mockResolvedValue({ preferences: null });\r\n            const result = await getUserPreferences();\r\n            expect(result).toEqual({ quoteMode: 'PRODUCT_FIRST' });\r\n        });\r\n\r\n        it('鏈櫥褰曟椂搴旇繑鍥為粯璁ゅ€?, async () => {\r\n            mocks.auth.mockResolvedValue(null);\r\n            const result = await getUserPreferences();\r\n            expect(result).toEqual({ quoteMode: 'PRODUCT_FIRST' });\r\n        });\r\n\r\n        it('DB 鏌ヨ寮傚父鏃跺簲杩斿洖榛樿鍊煎苟璁板綍閿欒', async () => {\r\n            const consoleSpy = vi.spyOn(console, 'error').mockImplementation(() => { });\r\n            mocks.dbFindFirst.mockRejectedValue(new Error('DB Error'));\r\n\r\n            const result = await getUserPreferences();\r\n\r\n            expect(result).toEqual({ quoteMode: 'PRODUCT_FIRST' });\r\n            expect(consoleSpy).toHaveBeenCalled();\r\n            consoleSpy.mockRestore();\r\n        });\r\n    });\r\n\r\n    // === updateUserPreferences 娴嬭瘯 ===\r\n    describe('updateUserPreferences', () => {\r\n        it('搴旀垚鍔熸洿鏂扮敤鎴峰亸濂藉苟璁板綍瀹¤', async () => {\r\n            // 妯℃嫙鐜版湁鍋忓ソ\r\n            mocks.dbFindFirst.mockResolvedValue({\r\n                preferences: { quoteMode: 'PRODUCT_FIRST' },\r\n            });\r\n\r\n            const result = await updateUserPreferences({ quoteMode: 'SPACE_FIRST' });\r\n\r\n            expect(result.success).toBe(true);\r\n            // 楠岃瘉瀹¤鏃ュ織\r\n            expect(mocks.logAudit).toHaveBeenCalledWith(\r\n                expect.anything(),\r\n                expect.objectContaining({\r\n                    action: 'UPDATE',\r\n                    recordId: mockUserId,\r\n                    tableName: 'users',\r\n                    userId: mockUserId,\r\n                    oldValues: { preferences: { quoteMode: 'PRODUCT_FIRST' } },\r\n                    newValues: { preferences: { quoteMode: 'SPACE_FIRST' } },\r\n                })\r\n            );\r\n        });\r\n\r\n        it('鏈櫥褰曟椂搴旇繑鍥炴湭鎺堟潈閿欒', async () => {\r\n            mocks.auth.mockResolvedValue(null);\r\n            const result = await updateUserPreferences({ quoteMode: 'SPACE_FIRST' });\r\n\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toContain('鎺堟潈');\r\n        });\r\n\r\n        it('杈撳叆鍙傛暟鏍煎紡閿欒搴旇 Zod 鎷︽埅', async () => {\r\n            // @ts-expect-error 娴嬭瘯鏃犳晥鏋氫妇鍊糪r\n            const result = await updateUserPreferences({ quoteMode: 'INVALID_MODE' });\r\n\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toBeDefined();\r\n        });\r\n\r\n        it('鏇存柊澶辫触鏃跺簲杩斿洖閿欒淇℃伅', async () => {\r\n            mocks.dbFindFirst.mockRejectedValue(new Error('Update failed'));\r\n\r\n            const consoleSpy = vi.spyOn(console, 'error').mockImplementation(() => { });\r\n            const result = await updateUserPreferences({ quoteMode: 'SPACE_FIRST' });\r\n\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toContain('澶辫触');\r\n            consoleSpy.mockRestore();\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\reminder-actions.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\roles-management.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\system-settings-actions.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4692,4695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4692,4695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":162,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":162,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5507,5510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5507,5510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5915,5918],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5915,5918],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6584,6587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6584,6587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6987,6990],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6987,6990],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, vi, beforeEach } from 'vitest';\r\n\r\n// 浣跨敤 vi.hoisted 鎻愬崌 mock 瀹氫箟\r\nconst mocks = vi.hoisted(() => ({\r\n    auth: vi.fn(),\r\n    checkPermission: vi.fn(),\r\n    revalidatePath: vi.fn(),\r\n}));\r\n\r\n// Mock 渚濊禆\r\nvi.mock('@/shared/lib/auth', () => ({\r\n    auth: mocks.auth,\r\n    checkPermission: mocks.checkPermission,\r\n}));\r\nvi.mock('next/cache', () => ({ revalidatePath: mocks.revalidatePath }));\r\n\r\n// Mock DB\r\nvi.mock('@/shared/api/db', () => {\r\n    const mockTx = {\r\n        query: {\r\n            systemSettings: {\r\n                findFirst: vi.fn(),\r\n                findMany: vi.fn(),\r\n            },\r\n        },\r\n        insert: vi.fn(() => ({\r\n            values: vi.fn(() => ({\r\n                onConflictDoNothing: vi.fn().mockResolvedValue({}),\r\n                returning: vi.fn().mockResolvedValue([{ id: 'setting-1' }]),\r\n            })),\r\n        })),\r\n        update: vi.fn(() => ({\r\n            set: vi.fn(() => ({\r\n                where: vi.fn().mockResolvedValue({}),\r\n            })),\r\n        })),\r\n    };\r\n    return {\r\n        db: {\r\n            query: {\r\n                systemSettings: {\r\n                    findFirst: vi.fn(),\r\n                    findMany: vi.fn(),\r\n                },\r\n            },\r\n            transaction: vi.fn(async (callback) => await callback(mockTx)),\r\n        },\r\n    };\r\n});\r\n\r\nimport {\r\n    parseSettingValue,\r\n    validateValueType,\r\n} from '../actions/setting-utils';\r\nimport {\r\n    getSettingsByCategory,\r\n    getSettingInternal,\r\n    getSetting,\r\n    initTenantSettings,\r\n    getAllSettings,\r\n} from '../actions/system-settings-actions';\r\nimport { db } from '@/shared/api/db';\r\n\r\ndescribe('SystemSettingsActions - Task 1: 绾嚱鏁板崟鍏冩祴璇?, () => {\r\n    const mockTenantId = 'tenant-1';\r\n    const mockUserId = 'user-1';\r\n    const mockSession = {\r\n        user: { id: mockUserId, tenantId: mockTenantId, role: 'ADMIN' },\r\n    };\r\n\r\n    beforeEach(() => {\r\n        vi.clearAllMocks();\r\n        mocks.auth.mockResolvedValue(mockSession);\r\n    });\r\n\r\n    // === parseSettingValue 娴嬭瘯 ===\r\n    describe('parseSettingValue', () => {\r\n        it('搴斿皢 \"true\" 瑙ｆ瀽涓?boolean true', () => {\r\n            expect(parseSettingValue('true', 'BOOLEAN')).toBe(true);\r\n        });\r\n        it('搴斿皢 \"false\" 瑙ｆ瀽涓?boolean false', () => {\r\n            expect(parseSettingValue('false', 'BOOLEAN')).toBe(false);\r\n        });\r\n        it('搴斿皢鏁板瓧瀛楃涓茶В鏋愪负 INTEGER', () => {\r\n            expect(parseSettingValue('42', 'INTEGER')).toBe(42);\r\n        });\r\n        it('搴斿皢灏忔暟瀛楃涓茶В鏋愪负 DECIMAL', () => {\r\n            expect(parseSettingValue('3.14', 'DECIMAL')).toBeCloseTo(3.14);\r\n        });\r\n        it('搴斿皢 JSON 瀛楃涓茶В鏋愪负瀵硅薄', () => {\r\n            expect(parseSettingValue('{\"a\":1}', 'JSON')).toEqual({ a: 1 });\r\n        });\r\n        it('搴斿湪 JSON 瑙ｆ瀽澶辫触鏃惰繑鍥炲師濮嬪瓧绗︿覆', () => {\r\n            expect(parseSettingValue('not-json', 'JSON')).toBe('not-json');\r\n        });\r\n        it('搴斿皢 ENUM 鍊煎師鏍疯繑鍥?, () => {\r\n            expect(parseSettingValue('ROUND_ROBIN', 'ENUM')).toBe('ROUND_ROBIN');\r\n        });\r\n        it('搴斿皢鏈煡绫诲瀷鍘熸牱杩斿洖', () => {\r\n            expect(parseSettingValue('anything', 'UNKNOWN')).toBe('anything');\r\n        });\r\n    });\r\n\r\n    // === validateValueType 娴嬭瘯 ===\r\n    describe('validateValueType', () => {\r\n        it('搴旀帴鍙?boolean 绫诲瀷鐨?BOOLEAN 鍊?, () => {\r\n            expect(validateValueType(true, 'BOOLEAN')).toBe(true);\r\n        });\r\n        it('搴旀嫆缁濋潪 boolean 绫诲瀷鐨?BOOLEAN 鍊?, () => {\r\n            expect(validateValueType('true', 'BOOLEAN')).toBe(false);\r\n        });\r\n        it('搴旀帴鍙楁暣鏁扮殑 INTEGER 鍊?, () => {\r\n            expect(validateValueType(42, 'INTEGER')).toBe(true);\r\n        });\r\n        it('搴旀嫆缁濆皬鏁扮殑 INTEGER 鍊?, () => {\r\n            expect(validateValueType(3.14, 'INTEGER')).toBe(false);\r\n        });\r\n        it('搴旀帴鍙楁暟瀛楃殑 DECIMAL 鍊?, () => {\r\n            expect(validateValueType(3.14, 'DECIMAL')).toBe(true);\r\n        });\r\n        it('搴旀嫆缁濋潪鏁板瓧鐨?DECIMAL 鍊?, () => {\r\n            expect(validateValueType('abc', 'DECIMAL')).toBe(false);\r\n        });\r\n        it('搴旀帴鍙楀璞″拰瀛楃涓茬殑 JSON 鍊?, () => {\r\n            expect(validateValueType({}, 'JSON')).toBe(true);\r\n            expect(validateValueType('str', 'JSON')).toBe(true);\r\n        });\r\n        it('搴旀帴鍙楀瓧绗︿覆鐨?ENUM 鍊?, () => {\r\n            expect(validateValueType('OPTION_A', 'ENUM')).toBe(true);\r\n        });\r\n        it('搴斿鏈煡绫诲瀷杩斿洖 true', () => {\r\n            expect(validateValueType(123, 'UNKNOWN')).toBe(true);\r\n        });\r\n    });\r\n\r\n    // === Server Actions 娴嬭瘯鍑嗗 ===\r\n    // const mockTenantId = 'tenant-1'; // 宸插湪椤跺眰澹版槑\r\n\r\n    // === getSettingsByCategory 娴嬭瘯 ===\r\n    describe('getSettingsByCategory', () => {\r\n        it('搴旇繑鍥炴寜 key 鍒嗙粍鐨勯厤缃?, async () => {\r\n            (db.query.systemSettings.findMany as any).mockResolvedValue([\r\n                { key: 'ENABLE_LEAD_AUTO_RECYCLE', value: 'true', valueType: 'BOOLEAN' },\r\n                { key: 'LEAD_DAILY_CLAIM_LIMIT', value: '10', valueType: 'INTEGER' },\r\n            ]);\r\n            const result = await getSettingsByCategory('LEAD');\r\n            expect(result).toEqual({\r\n                ENABLE_LEAD_AUTO_RECYCLE: true,\r\n                LEAD_DAILY_CLAIM_LIMIT: 10,\r\n            });\r\n        });\r\n\r\n        it('鏈巿鏉冩椂搴旀姏鍑洪敊璇?, async () => {\r\n            mocks.auth.mockResolvedValue(null);\r\n            await expect(getSettingsByCategory('LEAD')).rejects.toThrow('鏈巿鏉?);\r\n        });\r\n    });\r\n\r\n    // === getSettingInternal 娴嬭瘯 ===\r\n    describe('getSettingInternal', () => {\r\n        it('搴旇繑鍥炲凡瀛樺湪鐨勯厤缃€?, async () => {\r\n            (db.query.systemSettings.findFirst as any).mockResolvedValue({\r\n                key: 'ENABLE_LEAD_AUTO_RECYCLE',\r\n                value: 'true',\r\n                valueType: 'BOOLEAN',\r\n            });\r\n            const result = await getSettingInternal('ENABLE_LEAD_AUTO_RECYCLE', mockTenantId);\r\n            expect(result).toBe(true);\r\n        });\r\n\r\n        it('閰嶇疆涓嶅瓨鍦ㄦ椂搴斿洖閫€鍒伴粯璁ゅ€?, async () => {\r\n            (db.query.systemSettings.findFirst as any).mockResolvedValue(null);\r\n            const result = await getSettingInternal('ENABLE_LEAD_AUTO_RECYCLE', mockTenantId);\r\n            // 鍋囪榛樿鍊兼槸 'true'\r\n            expect(result).toBe(true);\r\n        });\r\n    });\r\n\r\n    // === getSetting 娴嬭瘯 ===\r\n    describe('getSetting', () => {\r\n        it('鏈巿鏉冩椂搴旀姏鍑洪敊璇?, async () => {\r\n            mocks.auth.mockResolvedValue({ user: {} }); // 鏃?tenantId\r\n            await expect(getSetting('ANY_KEY')).rejects.toThrow('鏈巿鏉冭闂?);\r\n        });\r\n    });\r\n\r\n    // === initTenantSettings 娴嬭瘯 ===\r\n    describe('initTenantSettings', () => {\r\n        it('宸叉湁閰嶇疆鏃跺簲璺宠繃鍒濆鍖?, async () => {\r\n            (db.query.systemSettings.findFirst as any).mockResolvedValue({ id: 'existing' });\r\n            const result = await initTenantSettings(mockTenantId);\r\n            expect(result?.success).toBe(true);\r\n            expect(result?.message).toBe('閰嶇疆鍒濆鍖栧畬鎴?);\r\n        });\r\n    });\r\n\r\n    // === getAllSettings 娴嬭瘯 ===\r\n    describe('getAllSettings', () => {\r\n        it('搴旀寜鍒嗙被鍒嗙粍杩斿洖閰嶇疆', async () => {\r\n            (db.query.systemSettings.findMany as any).mockResolvedValue([\r\n                { category: 'LEAD', key: 'K1', value: 'true', valueType: 'BOOLEAN' },\r\n                { category: 'LEAD', key: 'K2', value: '10', valueType: 'INTEGER' },\r\n                { category: 'ORDER', key: 'K3', value: 'false', valueType: 'BOOLEAN' },\r\n            ]);\r\n            const result = await getAllSettings();\r\n            expect(result).toEqual({\r\n                LEAD: { K1: true, K2: 10 },\r\n                ORDER: { K3: false },\r\n            });\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\tenant-config.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":135,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4678,4681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4678,4681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, vi, beforeEach } from 'vitest';\r\n\r\nconst mocks = vi.hoisted(() => ({\r\n    auth: vi.fn(),\r\n    checkPermission: vi.fn(),\r\n    revalidatePath: vi.fn(),\r\n    logAudit: vi.fn(),\r\n}));\r\n\r\nvi.mock('@/shared/lib/auth', () => ({\r\n    auth: mocks.auth,\r\n    checkPermission: mocks.checkPermission,\r\n}));\r\nvi.mock('next/cache', () => ({ revalidatePath: mocks.revalidatePath }));\r\nvi.mock('@/shared/services/audit-service', () => ({\r\n    AuditService: { log: mocks.logAudit },\r\n}));\r\n\r\nvi.mock('@/shared/api/db', () => {\r\n    const mockTx = {\r\n        select: vi.fn().mockReturnThis(),\r\n        from: vi.fn().mockReturnThis(),\r\n        where: vi.fn().mockReturnThis(),\r\n        for: vi.fn().mockResolvedValue([{ settings: {} }]),\r\n        update: vi.fn(() => ({\r\n            set: vi.fn(() => ({\r\n                where: vi.fn().mockResolvedValue({}),\r\n            })),\r\n        })),\r\n    };\r\n    return {\r\n        db: {\r\n            query: {\r\n                tenants: { findFirst: vi.fn().mockResolvedValue({ settings: {} }) },\r\n            },\r\n            transaction: vi.fn(async (callback) => await callback(mockTx)),\r\n        },\r\n    };\r\n});\r\n\r\nimport {\r\n    getTenantBusinessConfig,\r\n    updateARPaymentConfig,\r\n    updateAPPaymentConfig,\r\n    updateWorkflowModeConfig,\r\n} from '../actions/tenant-config';\r\n\r\ndescribe('TenantConfig Actions - Task 3: Zod 鏍￠獙娴嬭瘯', () => {\r\n    const mockSession = {\r\n        user: { id: 'u1', tenantId: 't1', role: 'ADMIN' },\r\n    };\r\n\r\n    beforeEach(() => {\r\n        vi.clearAllMocks();\r\n        mocks.auth.mockResolvedValue(mockSession);\r\n        mocks.checkPermission.mockResolvedValue(undefined);\r\n    });\r\n\r\n    describe('getTenantBusinessConfig', () => {\r\n        it('鏈巿鏉冩椂搴旇繑鍥為粯璁ら厤缃?, async () => {\r\n            mocks.auth.mockResolvedValue(null);\r\n            const config = await getTenantBusinessConfig();\r\n            expect(config.arPayment.minDepositRatio).toBe(0.30);\r\n            expect(config.apPayment.prepaidBonusType).toBe('BALANCE');\r\n            expect(config.workflowMode.measureDispatchMode).toBe('DISPATCHER');\r\n        });\r\n    });\r\n\r\n    describe('updateARPaymentConfig', () => {\r\n        it('鍚堟硶閰嶇疆搴旀洿鏂版垚鍔?, async () => {\r\n            const result = await updateARPaymentConfig({\r\n                enableInstallment: true,\r\n                minDepositRatio: 0.30,\r\n                minDepositAmount: 500,\r\n                depositCalcRule: 'HIGHER',\r\n                allowDebtInstallCash: false,\r\n                requireDebtInstallApproval: true,\r\n            });\r\n            expect(result.success).toBe(true);\r\n        });\r\n\r\n        it('姣斾緥瓒呭嚭鑼冨洿搴旀牎楠屽け璐?, async () => {\r\n            const result = await updateARPaymentConfig({\r\n                enableInstallment: true,\r\n                minDepositRatio: 1.5, // 瓒呭嚭 0-1 鑼冨洿\r\n                minDepositAmount: 500,\r\n                depositCalcRule: 'HIGHER',\r\n                allowDebtInstallCash: false,\r\n                requireDebtInstallApproval: true,\r\n            });\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toContain('姣斾緥涓嶈兘澶т簬 1');\r\n        });\r\n\r\n        it('鏈巿鏉冩椂搴旇繑鍥為敊璇?, async () => {\r\n            mocks.auth.mockResolvedValue(null);\r\n            const result = await updateARPaymentConfig({\r\n                enableInstallment: true,\r\n                minDepositRatio: 0.3,\r\n                minDepositAmount: 500,\r\n                depositCalcRule: 'HIGHER',\r\n                allowDebtInstallCash: false,\r\n                requireDebtInstallApproval: true,\r\n            });\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toBe('鏈巿鏉?);\r\n        });\r\n\r\n        it('鏃犳潈闄愭椂搴旇繑鍥為敊璇?, async () => {\r\n            mocks.checkPermission.mockRejectedValue(new Error('鏃犳潈闄?));\r\n            const result = await updateARPaymentConfig({\r\n                enableInstallment: true,\r\n                minDepositRatio: 0.3,\r\n                minDepositAmount: 500,\r\n                depositCalcRule: 'HIGHER',\r\n                allowDebtInstallCash: false,\r\n                requireDebtInstallApproval: true,\r\n            });\r\n            expect(result.success).toBe(false);\r\n            expect(result.error).toBe('鏃犳潈闄愭墽琛屾鎿嶄綔');\r\n        });\r\n    });\r\n\r\n    describe('updateAPPaymentConfig', () => {\r\n        it('鍚堟硶 AP 閰嶇疆搴旀洿鏂版垚鍔?, async () => {\r\n            const result = await updateAPPaymentConfig({\r\n                prepaidBonusType: 'GOODS',\r\n                prepaidBonusRatio: 0.15,\r\n            });\r\n            expect(result.success).toBe(true);\r\n        });\r\n\r\n        it('闈炴硶鏋氫妇鍊煎簲鏍￠獙澶辫触', async () => {\r\n            const result = await updateAPPaymentConfig({\r\n                prepaidBonusType: 'INVALID' as any,\r\n                prepaidBonusRatio: 0.15,\r\n            });\r\n            expect(result.success).toBe(false);\r\n        });\r\n    });\r\n\r\n    describe('updateWorkflowModeConfig', () => {\r\n        it('鍚堟硶宸ヤ綔娴侀厤缃簲鏇存柊鎴愬姛', async () => {\r\n            const result = await updateWorkflowModeConfig({\r\n                enableLeadAssignment: true,\r\n                measureDispatchMode: 'SELF',\r\n                installDispatchMode: 'DISPATCHER',\r\n                enableLaborFeeCalc: true,\r\n                enableOutsourceProcessing: false,\r\n                enablePurchaseApproval: true,\r\n            });\r\n            expect(result.success).toBe(true);\r\n        });\r\n    });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\tenant-info.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\__tests__\\user-actions.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\audit-logs.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\invite.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\preference-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\profile-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\quote-config-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\role-override-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\roles-management.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\roles.ts","messages":[{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":33,"column":7,"nodeType":"MemberExpression","messageId":"limited","endLine":33,"endColumn":18,"suggestions":[{"fix":{"range":[776,855],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server';\r\n\r\nimport { auth } from '@/shared/lib/auth';\r\nimport { db } from '@/shared/api/db';\r\nimport { roles } from '@/shared/api/schema';\r\nimport { eq, asc } from 'drizzle-orm';\r\nimport { ROLES } from '@/shared/config/roles';\r\n\r\n\r\nexport type RoleOption = {\r\n  label: string;\r\n  value: string;\r\n  description?: string;\r\n  isSystem: boolean;\r\n};\r\n\r\n\r\n\r\nexport async function getAvailableRoles(): Promise<RoleOption[]> {\r\n  const session = await auth();\r\n  if (!session?.user?.tenantId) {\r\n    return [];\r\n  }\r\n\r\n  try {\r\n    const dbRoles = await db.query.roles.findMany({\r\n      where: eq(roles.tenantId, session.user.tenantId),\r\n      orderBy: [asc(roles.code)],\r\n    });\r\n\r\n    if (dbRoles.length === 0) {\r\n      // Auto-initialize default roles for the tenant\r\n      console.log(`Initializing default roles for tenant: ${session.user.tenantId}`);\r\n\r\n      const newRoles = Object.values(ROLES).map((role) => ({\r\n        tenantId: session.user.tenantId,\r\n        name: role.name,\r\n        code: role.code,\r\n        description: role.description,\r\n        permissions: role.permissions, // Include permissions for completeness, though schema defaults might vary\r\n        isSystem: role.isSystem,\r\n      }));\r\n\r\n      // Insert default roles (浣跨敤 onConflictDoNothing 闃叉骞跺彂鍒濆鍖栫珵鎬?\r\n      await db.insert(roles).values(newRoles).onConflictDoNothing();\r\n\r\n      // Fetch again to get IDs and correct types\r\n      const initializedRoles = await db.query.roles.findMany({\r\n        where: eq(roles.tenantId, session.user.tenantId),\r\n        orderBy: [asc(roles.code)],\r\n      });\r\n\r\n      return initializedRoles.map((r) => ({\r\n        label: `${r.name} (${r.code})`,\r\n        value: r.code,\r\n        description: r.description || '',\r\n        isSystem: r.isSystem || false,\r\n      }));\r\n    }\r\n\r\n    return dbRoles.map((r) => ({\r\n      label: `${r.name} (${r.code})`,\r\n      value: r.code,\r\n      description: r.description || '',\r\n      isSystem: r.isSystem || false,\r\n    }));\r\n  } catch (error) {\r\n    console.warn('鑾峰彇鍙敤瑙掕壊澶辫触:', error);\r\n    return [];\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\room-groups-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\setting-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\system-settings-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\tenant-config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\tenant-info.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\actions\\user-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\approval-flow-designer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\approval-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\audit-log-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\business-rules-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\channel-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\channel-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\curtain-calc-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\curtain-calc-settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\curtain-quick-quote-config.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useForm } from 'react-hook-form';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/shared/ui/card';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { Form } from '@/shared/ui/form';\r\n\r\nexport function CurtainQuickQuoteConfig() {\r\n    const form = useForm();\r\n    return (\r\n        <Form {...form}>\r\n            <form>\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Curtain Quote Config</CardTitle>\r\n                        <CardDescription>Configure quick quote parameters for curtains.</CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"py-4 text-center text-muted-foreground\">\r\n                            Configuration not available in recovery mode.\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </form>\r\n        </Form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\finance-base-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\invite-user-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\labor-pricing-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\lead-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\measure-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\notification-preferences-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\notification-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\order-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\password-change-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\payment-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\permission-matrix.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport * as React from 'react';\r\nimport { useState, useMemo, useCallback } from 'react';\r\nimport { ChevronDown, ChevronRight, RotateCcw, Save } from 'lucide-react';\r\nimport { cn } from '@/shared/lib/utils';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { TriStateCheckbox, TriState, TriStateLabel } from '@/shared/ui/tri-state-checkbox';\r\nimport {\r\n    saveAllRoleOverrides,\r\n    type PermissionMatrixData,\r\n    type RoleOverrideData\r\n} from '@/features/settings/actions/role-override-actions';\r\nimport { toast } from 'sonner';\r\n\r\n/**\r\n * 鏉冮檺鐭╅樀缁勪欢\r\n * \r\n * 妯酱锛氳鑹诧紙7涓級\r\n * 绾佃酱锛氭潈闄愶紙鎸夋ā鍧楀垎缁勶紝鍙姌鍙狅級\r\n * 鍗曞厓鏍硷細涓夋€佸閫夋\r\n */\r\n\r\ninterface PermissionMatrixProps {\r\n    data: PermissionMatrixData;\r\n}\r\n\r\n// 鍐呴儴鐘舵€佺被鍨嬶細roleCode -> permission -> TriState\r\ntype PermissionStateMap = Record<string, Record<string, TriState>>;\r\n\r\nexport function PermissionMatrix({ data }: PermissionMatrixProps) {\r\n    // 鎶樺彔鐘舵€侊細groupKey -> boolean\r\n    const [expandedGroups, setExpandedGroups] = useState<Record<string, boolean>>(() => {\r\n        // 榛樿灞曞紑鍓?涓垎缁刓r\n        const initial: Record<string, boolean> = {};\r\n        data.permissionGroups.forEach((group, index) => {\r\n            initial[group.key] = index < 3;\r\n        });\r\n        return initial;\r\n    });\r\n\r\n    // 鏉冮檺鐘舵€乗r\n    const [permissionStates, setPermissionStates] = useState<PermissionStateMap>(() => {\r\n        return buildInitialStates(data.roles);\r\n    });\r\n\r\n    // 鍘熷鐘舵€侊紙鐢ㄤ簬姣旇緝鏄惁淇敼锛塡r\n    const originalStates = useMemo(() => buildInitialStates(data.roles), [data.roles]);\r\n\r\n    // 鏄惁鏈夋湭淇濆瓨鐨勪慨鏀筡r\n    const hasChanges = useMemo(() => {\r\n        return JSON.stringify(permissionStates) !== JSON.stringify(originalStates);\r\n    }, [permissionStates, originalStates]);\r\n\r\n    // 姝ｅ湪淇濆瓨\r\n    const [isSaving, setIsSaving] = useState(false);\r\n\r\n    // 鍒囨崲鍒嗙粍灞曞紑/鎶樺彔\r\n    const toggleGroup = (groupKey: string) => {\r\n        setExpandedGroups(prev => ({\r\n            ...prev,\r\n            [groupKey]: !prev[groupKey],\r\n        }));\r\n    };\r\n\r\n    // 鏇存柊鏉冮檺鐘舵€乗r\n    const handlePermissionChange = useCallback((\r\n        roleCode: string,\r\n        permission: string,\r\n        value: TriState\r\n    ) => {\r\n        setPermissionStates(prev => ({\r\n            ...prev,\r\n            [roleCode]: {\r\n                ...prev[roleCode],\r\n                [permission]: value,\r\n            },\r\n        }));\r\n    }, []);\r\n\r\n    // 妫€鏌ユ槸鍚﹁淇敼\r\n    const isModified = (roleCode: string, permission: string): boolean => {\r\n        return permissionStates[roleCode]?.[permission] !== originalStates[roleCode]?.[permission];\r\n    };\r\n\r\n    // 淇濆瓨鎵€鏈夋洿鏀筡r\n    const handleSave = async () => {\r\n        setIsSaving(true);\r\n\r\n        try {\r\n            // 鏋勫缓瑕嗙洊鏁版嵁\r\n            const overrides = data.roles.map(role => {\r\n                const basePermissions = new Set(role.basePermissions);\r\n                const added: string[] = [];\r\n                const removed: string[] = [];\r\n\r\n                // 閬嶅巻鎵€鏈夋潈闄怽r\n                for (const [permission, state] of Object.entries(permissionStates[role.roleCode] || {})) {\r\n                    const wasInBase = basePermissions.has(permission) ||\r\n                        basePermissions.has(permission.replace('.view', '.edit'));\r\n\r\n                    if (state === 'EDIT') {\r\n                        // 鍙紪杈戠姸鎬侊細濡傛灉鍘熸潵娌℃湁edit鏉冮檺锛屾坊鍔燶r\n                        const editPerm = permission.includes('.view')\r\n                            ? permission.replace('.view', '.edit')\r\n                            : permission;\r\n                        if (!basePermissions.has(editPerm)) {\r\n                            added.push(editPerm);\r\n                        }\r\n                        // 纭繚view鏉冮檺涔熸湁\r\n                        const viewPerm = permission.includes('.edit')\r\n                            ? permission.replace('.edit', '.view')\r\n                            : permission;\r\n                        if (!basePermissions.has(viewPerm)) {\r\n                            added.push(viewPerm);\r\n                        }\r\n                    } else if (state === 'VIEW') {\r\n                        // 鍙煡鐪嬬姸鎬侊細绉婚櫎edit鏉冮檺锛堝鏋滄湁锛塡r\n                        const editPerm = permission.includes('.view')\r\n                            ? permission.replace('.view', '.edit')\r\n                            : permission + '.edit';\r\n                        if (basePermissions.has(editPerm)) {\r\n                            removed.push(editPerm);\r\n                        }\r\n                        // 纭繚鏈塿iew鏉冮檺\r\n                        const viewPerm = permission.includes('.edit')\r\n                            ? permission.replace('.edit', '.view')\r\n                            : permission;\r\n                        if (!basePermissions.has(viewPerm)) {\r\n                            added.push(viewPerm);\r\n                        }\r\n                    } else if (state === 'NONE') {\r\n                        // 涓嶅彲瑙侊細绉婚櫎鐩稿叧鏉冮檺\r\n                        if (wasInBase) {\r\n                            removed.push(permission);\r\n                            // 涔熺Щ闄ょ浉鍏崇殑view/edit鏉冮檺\r\n                            if (permission.includes('.view')) {\r\n                                const editPerm = permission.replace('.view', '.edit');\r\n                                if (basePermissions.has(editPerm)) {\r\n                                    removed.push(editPerm);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return {\r\n                    roleCode: role.roleCode,\r\n                    addedPermissions: [...new Set(added)],\r\n                    removedPermissions: [...new Set(removed)],\r\n                };\r\n            });\r\n\r\n            const result = await saveAllRoleOverrides(overrides);\r\n\r\n            if (result.success) {\r\n                toast.success(result.message);\r\n            } else {\r\n                toast.error(result.message);\r\n            }\r\n        } catch (error) {\r\n            console.error('淇濆瓨鏉冮檺閰嶇疆澶辫触:', error);\r\n            toast.error('淇濆瓨澶辫触锛岃绋嶅悗閲嶈瘯');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    // 閲嶇疆鎵€鏈夋洿鏀筡r\n    const handleReset = () => {\r\n        setPermissionStates(buildInitialStates(data.roles));\r\n        toast.info('宸查噸缃负褰撳墠淇濆瓨鐨勭姸鎬?);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {/* 宸ュ叿鏍?*/}\r\n            <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <span className=\"text-sm text-muted-foreground\">鍥句緥锛?/span>\r\n                    <TriStateLabel state=\"EDIT\" />\r\n                    <TriStateLabel state=\"VIEW\" />\r\n                    <TriStateLabel state=\"NONE\" />\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        onClick={handleReset}\r\n                        disabled={!hasChanges || isSaving}\r\n                    >\r\n                        <RotateCcw className=\"w-4 h-4 mr-1\" />\r\n                        閲嶇疆\r\n                    </Button>\r\n                    <Button\r\n                        size=\"sm\"\r\n                        onClick={handleSave}\r\n                        disabled={!hasChanges || isSaving}\r\n                    >\r\n                        <Save className=\"w-4 h-4 mr-1\" />\r\n                        {isSaving ? '淇濆瓨涓?..' : '淇濆瓨鏇存敼'}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* 鐭╅樀琛ㄦ牸 */}\r\n            <div className=\"border rounded-lg overflow-auto\">\r\n                <table className=\"w-full min-w-[800px]\">\r\n                    <thead className=\"bg-muted/50\">\r\n                        <tr>\r\n                            <th className=\"text-left p-3 sticky left-0 bg-muted/50 min-w-[200px] font-medium\">\r\n                                鏉冮檺妯″潡\r\n                            </th>\r\n                            {data.roles.map(role => (\r\n                                <th\r\n                                    key={role.roleCode}\r\n                                    className=\"p-3 text-center min-w-[80px] font-medium\"\r\n                                >\r\n                                    <div className=\"flex flex-col items-center gap-1\">\r\n                                        <span>{role.roleName}</span>\r\n                                        <span className=\"text-xs text-muted-foreground font-normal\">\r\n                                            {role.roleCode}\r\n                                        </span>\r\n                                    </div>\r\n                                </th>\r\n                            ))}\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {data.permissionGroups.map(group => (\r\n                            <React.Fragment key={group.key}>\r\n                                {/* 鍒嗙粍鏍囬琛?*/}\r\n                                <tr\r\n                                    className=\"bg-muted/30 cursor-pointer hover:bg-muted/50\"\r\n                                    onClick={() => toggleGroup(group.key)}\r\n                                >\r\n                                    <td\r\n                                        colSpan={data.roles.length + 1}\r\n                                        className=\"p-2 sticky left-0\"\r\n                                    >\r\n                                        <div className=\"flex items-center gap-2\">\r\n                                            {expandedGroups[group.key] ? (\r\n                                                <ChevronDown className=\"w-4 h-4\" />\r\n                                            ) : (\r\n                                                <ChevronRight className=\"w-4 h-4\" />\r\n                                            )}\r\n                                            <span className=\"font-medium\">{group.label}</span>\r\n                                            {group.description && (\r\n                                                <span className=\"text-xs text-muted-foreground\">\r\n                                                    - {group.description}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </td>\r\n                                </tr>\r\n\r\n                                {/* 鏉冮檺琛?*/}\r\n                                {expandedGroups[group.key] && group.permissions.map(perm => (\r\n                                    <tr key={perm.code} className=\"border-t hover:bg-muted/20\">\r\n                                        <td className=\"p-2 pl-8 sticky left-0 bg-background\">\r\n                                            <span className=\"text-sm\">{perm.label}</span>\r\n                                        </td>\r\n                                        {data.roles.map(role => (\r\n                                            <td key={role.roleCode} className=\"p-2 text-center\">\r\n                                                <div className=\"flex justify-center\">\r\n                                                    <TriStateCheckbox\r\n                                                        value={permissionStates[role.roleCode]?.[perm.code] || 'NONE'}\r\n                                                        onChange={(value) => handlePermissionChange(\r\n                                                            role.roleCode,\r\n                                                            perm.code,\r\n                                                            value\r\n                                                        )}\r\n                                                        isModified={isModified(role.roleCode, perm.code)}\r\n                                                        disabled={role.roleCode === 'ADMIN'}\r\n                                                    />\r\n                                                </div>\r\n                                            </td>\r\n                                        ))}\r\n                                    </tr>\r\n                                ))}\r\n                            </React.Fragment>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {/* 淇敼鎻愮ず */}\r\n            {hasChanges && (\r\n                <div className=\"fixed bottom-4 right-4 bg-amber-100 border border-amber-300 text-amber-800 px-4 py-2 rounded-lg shadow-lg flex items-center gap-2\">\r\n                    <span className=\"text-sm\">鏈夋湭淇濆瓨鐨勬洿鏀?/span>\r\n                    <Button size=\"sm\" onClick={handleSave} disabled={isSaving}>\r\n                        淇濆瓨\r\n                    </Button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/**\r\n * 鏋勫缓鍒濆鏉冮檺鐘舵€乗r\n */\r\nfunction buildInitialStates(roles: RoleOverrideData[]): PermissionStateMap {\r\n    const states: PermissionStateMap = {};\r\n\r\n    for (const role of roles) {\r\n        states[role.roleCode] = {};\r\n\r\n        // 鍩轰簬鏈夋晥鏉冮檺鏋勫缓鐘舵€乗r\n        const effectivePerms = new Set(role.effectivePermissions);\r\n\r\n        // 閬嶅巻鎵€鏈夊凡鐭ユ潈闄怽r\n        // 鍒ゆ柇姣忎釜鏉冮檺鐨勭姸鎬乗r\n        for (const perm of effectivePerms) {\r\n            if (perm === '**' || perm === '*') {\r\n                // 瓒呯骇鏉冮檺锛屾墍鏈夐兘鏄?EDIT\r\n                continue;\r\n            }\r\n\r\n            // 妫€鏌ユ槸鍚︽湁 edit 鏉冮檺\r\n            if (perm.includes('.edit')) {\r\n                const viewPerm = perm.replace('.edit', '.view');\r\n                states[role.roleCode][perm] = 'EDIT';\r\n                states[role.roleCode][viewPerm] = 'EDIT';\r\n            } else if (perm.includes('.view')) {\r\n                const editPerm = perm.replace('.view', '.edit');\r\n                // 鍙湁 view 娌℃湁 edit\r\n                if (!effectivePerms.has(editPerm)) {\r\n                    states[role.roleCode][perm] = 'VIEW';\r\n                }\r\n            } else {\r\n                // 鐗规畩鏉冮檺锛堝 approve, dispatch 绛夛級\r\n                states[role.roleCode][perm] = 'EDIT';\r\n            }\r\n        }\r\n    }\r\n\r\n    return states;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\permission-tree.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\quick-quote-field-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\reminder-rule-form.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Form' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onSuccess' is defined but never used. Allowed unused args must match /^_/u.","line":24,"column":69,"nodeType":null,"messageId":"unusedVar","endLine":24,"endColumn":78},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'form' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":25,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":25,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useForm } from 'react-hook-form';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/shared/ui/dialog';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { Form } from '@/shared/ui/form';\r\n\r\n/** 鎻愰啋瑙勫垯琛ㄥ崟鍒濆鏁版嵁绫诲瀷 */\r\ninterface ReminderRuleData {\r\n    id?: string;\r\n    name: string;\r\n    triggerType: string;\r\n    triggerValue: number;\r\n    notificationChannels: string[];\r\n}\r\n\r\ninterface ReminderRuleFormProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    initialData?: ReminderRuleData;\r\n    onSuccess: () => void;\r\n}\r\n\r\nexport function ReminderRuleForm({ open, onOpenChange, initialData, onSuccess }: ReminderRuleFormProps) {\r\n    const form = useForm();\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent>\r\n                <DialogHeader>\r\n                    <DialogTitle>{initialData ? 'Edit Rule' : 'Create Rule'}</DialogTitle>\r\n                </DialogHeader>\r\n                <div className=\"py-4\">\r\n                    <p className=\"text-muted-foreground\">Reminder rule form not available in recovery mode.</p>\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\reminder-rule-list.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/shared/ui/card';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { Plus } from 'lucide-react';\r\n\r\nexport function ReminderRuleList() {\r\n    return (\r\n        <div className=\"space-y-4\">\r\n             <div className=\"flex justify-between items-center\">\r\n                <h3 className=\"text-lg font-medium\">Reminder Rules</h3>\r\n                <Button>\r\n                    <Plus className=\"mr-2 h-4 w-4\" /> Add Rule\r\n                </Button>\r\n            </div>\r\n            <Card>\r\n                <CardContent>\r\n                    <div className=\"py-4 text-center text-muted-foreground\">\r\n                        Reminder rules list not available in recovery mode.\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\report-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\role-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\role-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\role-selector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\roles-settings-actions.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":63,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":63,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used. Allowed unused caught errors must match /^_/u.","line":88,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { RefreshCw, Plus, Loader2, ChevronDown } from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { syncSystemRoles, createRole } from '@/features/settings/actions/roles-management';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/shared/ui/dialog';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '@/shared/ui/dropdown-menu';\r\nimport { Input } from '@/shared/ui/input';\r\nimport { Label } from '@/shared/ui/label';\r\nimport { Textarea } from '@/shared/ui/textarea';\r\nimport { useForm } from 'react-hook-form';\r\n\r\n/** 鍒涘缓瑙掕壊琛ㄥ崟鏁版嵁绫诲瀷 */\r\ninterface CreateRoleFormValues {\r\n  code: string;\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\nexport function RolesSettingsActions() {\r\n  const [syncing, setSyncing] = useState(false);\r\n  const [createOpen, setCreateOpen] = useState(false);\r\n  const [creating, setCreating] = useState(false);\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    reset,\r\n    formState: { errors },\r\n  } = useForm<CreateRoleFormValues>({\r\n    defaultValues: {\r\n      code: '',\r\n      name: '',\r\n      description: '',\r\n    },\r\n  });\r\n\r\n  const handleSync = async () => {\r\n    setSyncing(true);\r\n    try {\r\n      const result = await syncSystemRoles();\r\n      if (result.success) {\r\n        toast.success(result.message);\r\n      } else {\r\n        toast.error(result.message);\r\n      }\r\n    } catch (error) {\r\n      toast.error('鍚屾澶辫触');\r\n    } finally {\r\n      setSyncing(false);\r\n    }\r\n  };\r\n\r\n  const handleCreate = async (data: CreateRoleFormValues) => {\r\n    setCreating(true);\r\n    try {\r\n      // uppercase code\r\n      const code = data.code.toUpperCase().trim();\r\n      const result = await createRole({\r\n        code,\r\n        name: data.name,\r\n        description: data.description,\r\n      });\r\n\r\n      if (result.success) {\r\n        toast.success('瑙掕壊鍒涘缓鎴愬姛');\r\n        setCreateOpen(false);\r\n        reset();\r\n      } else {\r\n        toast.error(result.message);\r\n      }\r\n    } catch (error) {\r\n      toast.error('鍒涘缓澶辫触');\r\n    } finally {\r\n      setCreating(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={createOpen} onOpenChange={setCreateOpen}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>鍒涘缓鏂拌鑹?/DialogTitle>\r\n            <DialogDescription>\r\n              鍒涘缓涓€涓柊鐨勮嚜瀹氫箟瑙掕壊锛屼箣鍚庡彲浠ュ湪鏉冮檺鐭╅樀涓厤缃叾鏉冮檺銆俓r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          <form onSubmit={handleSubmit(handleCreate)} className=\"space-y-4 py-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label>瑙掕壊浠ｇ爜 (Code)</Label>\r\n              <Input\r\n                {...register('code', { required: true, pattern: /^[A-Za-z0-9_]+$/ })}\r\n                placeholder=\"渚嬪: INTERN\"\r\n              />\r\n              {errors.code && (\r\n                <p className=\"text-xs text-red-500\">璇疯緭鍏ユ湁鏁堢殑浠ｇ爜锛堝瓧姣嶃€佹暟瀛椼€佷笅鍒掔嚎锛?/p>\r\n              )}\r\n              <p className=\"text-muted-foreground text-xs\">\r\n                绯荤粺灏嗚嚜鍔ㄨ浆鎹负澶у啓锛屽垱寤哄悗涓嶅彲淇敼銆俓r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>瑙掕壊鍚嶇О</Label>\r\n              <Input {...register('name', { required: true })} placeholder=\"渚嬪: 瀹炰範鐢焅" />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>鎻忚堪</Label>\r\n              <Textarea {...register('description')} placeholder=\"瑙掕壊鐨勮亴璐ｆ弿杩?..\" />\r\n            </div>\r\n\r\n            <DialogFooter>\r\n              <Button type=\"button\" variant=\"ghost\" onClick={() => setCreateOpen(false)}>\r\n                鍙栨秷\r\n              </Button>\r\n              <Button type=\"submit\" disabled={creating}>\r\n                {creating && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                鍒涘缓\r\n              </Button>\r\n            </DialogFooter>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <DropdownMenu>\r\n        <DropdownMenuTrigger asChild>\r\n          <Button variant=\"outline\">\r\n            鎿嶄綔 <ChevronDown className=\"ml-2 h-4 w-4\" />\r\n          </Button>\r\n        </DropdownMenuTrigger>\r\n        <DropdownMenuContent align=\"end\">\r\n          <DropdownMenuLabel>瑙掕壊绠＄悊</DropdownMenuLabel>\r\n          <DropdownMenuSeparator />\r\n          <DropdownMenuItem onClick={() => setCreateOpen(true)}>\r\n            <Plus className=\"mr-2 h-4 w-4\" />\r\n            鍒涘缓瑙掕壊\r\n          </DropdownMenuItem>\r\n          <DropdownMenuItem onClick={handleSync} disabled={syncing}>\r\n            {syncing ? (\r\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n            ) : (\r\n              <RefreshCw className=\"mr-2 h-4 w-4\" />\r\n            )}\r\n            鍚屾绯荤粺瑙掕壊\r\n          </DropdownMenuItem>\r\n        </DropdownMenuContent>\r\n      </DropdownMenu>\r\n    </>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\roles\\role-dialog.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'form', 'role?.code', 'role?.description', 'role?.name', and 'role?.permissions'. Either include them or remove the dependency array.","line":90,"column":8,"nodeType":"ArrayExpression","endLine":90,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [form, role?.code, role?.description, role.id, role?.name, role?.permissions]","fix":{"range":[2829,2839],"text":"[form, role?.code, role?.description, role.id, role?.name, role?.permissions]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\roles\\role-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\room-types-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\settings-sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserCog' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":47}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport Link from 'next/link';\r\nimport { usePathname } from 'next/navigation';\r\nimport { cn } from '@/shared/utils';\r\nimport { Building2, Settings2, Wallet, UserCog, User, Shield } from 'lucide-react';\r\n\r\nconst settingsNav = [\r\n    {\r\n        title: 'General',\r\n        items: [\r\n            { href: '/settings/general', title: 'Basic Info', icon: Building2 },\r\n            { href: '/settings/workflow', title: 'Workflow', icon: Settings2 },\r\n        ],\r\n    },\r\n    {\r\n        title: 'Team',\r\n        items: [\r\n            { href: '/settings/users', title: 'Users', icon: User },\r\n            { href: '/settings/roles', title: 'Roles', icon: Shield },\r\n        ],\r\n    },\r\n    {\r\n        title: 'Finance',\r\n        items: [\r\n             { href: '/settings/finance', title: 'Finance Settings', icon: Wallet },\r\n        ],\r\n    },\r\n];\r\n\r\nexport function SettingsSidebar() {\r\n    const pathname = usePathname();\r\n    return (\r\n        <nav className=\"w-64 shrink-0 border-r border-border bg-card/50 p-6 space-y-8\">\r\n            {settingsNav.map((group, index) => (\r\n                <div key={index}>\r\n                    <h4 className=\"mb-2 px-3 text-xs font-semibold uppercase tracking-wider text-muted-foreground\">\r\n                        {group.title}\r\n                    </h4>\r\n                    <div className=\"space-y-1\">\r\n                        {group.items.map((item) => {\r\n                             const isActive = pathname === item.href;\r\n                             return (\r\n                                <Link\r\n                                    key={item.href}\r\n                                    href={item.href}\r\n                                    className={cn(\r\n                                        'flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground',\r\n                                        isActive ? 'bg-accent text-accent-foreground' : 'transparent'\r\n                                    )}\r\n                                >\r\n                                    <item.icon className=\"h-4 w-4\" />\r\n                                    <span>{item.title}</span>\r\n                                </Link>\r\n                             );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            ))}\r\n        </nav>\r\n    );\r\n}\r\n\r\nexport { settingsNav };\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\settings-tab-nav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\showroom-settings-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\split-rules-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\system-params-config.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\system-settings-index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\system-settings-panel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\tenant-feature-control.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\tenant-info-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\theme-preview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\theme-settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\user-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\user-list.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\user-preference-settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\user-profile-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\users-settings-client.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\verification-form.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\components\\wallpaper-quick-quote-config.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useForm } from 'react-hook-form';\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/shared/ui/card';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { Form } from '@/shared/ui/form';\r\n\r\nexport function WallpaperQuickQuoteConfig() {\r\n    const form = useForm();\r\n    return (\r\n        <Form {...form}>\r\n            <form>\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle>Wallpaper Quote Config</CardTitle>\r\n                        <CardDescription>Configure quick quote parameters for wallpaper.</CardDescription>\r\n                    </CardHeader>\r\n                     <CardContent>\r\n                        <div className=\"py-4 text-center text-muted-foreground\">\r\n                            Configuration not available in recovery mode.\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </form>\r\n        </Form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\config\\reminder-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\lib\\quote-mode-constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\reminder-actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\split-rules\\actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\workflow\\actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\workflow\\schema.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\bigey\\Documents\\Antigravity\\L2C\\src\\features\\settings\\workflow\\workflow-config-form.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useForm } from 'react-hook-form';\r\nimport { Button } from '@/shared/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/shared/ui/card';\r\nimport { Form } from '@/shared/ui/form';\r\n\r\nexport function WorkflowConfigForm() {\r\n    const form = useForm();\r\n    return (\r\n        <Form {...form}>\r\n            <form>\r\n                <Card>\r\n                    <CardHeader>\r\n                         <CardTitle>Workflow Configuration</CardTitle>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        <div className=\"py-4 text-center text-muted-foreground\">\r\n                            Workflow configuration not available in recovery mode.\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </form> \r\n        </Form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]}]
