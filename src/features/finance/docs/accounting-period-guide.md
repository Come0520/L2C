# 财务账期规则说明

> 版本：v1.0 | 最后更新：2026-02-23

---

## 一、账期定义

**账期**：记账和结算的时间周期，本系统以**自然月**为基本账期单位。

---

## 二、期初建账规则

首次使用财务模块时，需要进行期初建账：

| 步骤 | 操作 | 说明 |
|:---:|:---|:---|
| 1 | 设定起始账期 | 通常为系统上线当月 |
| 2 | 录入期初应收账款 | 历史尚未回款的 AR 余额 |
| 3 | 录入期初应付账款 | 历史尚未付款的 AP 余额 |
| 4 | 录入期初资金余额 | 各账户（银行/现金）的余额 |

> [!IMPORTANT]
> 期初数据一旦确认提交，不可删除，只能通过调整凭证纠正。系统会记录期初录入操作的审计日志。

---

## 三、结账规则

| 规则 | 说明 |
|:---|:---|
| **结账时间** | 次月 5 日前完成上月结账 |
| **结账条件** | 所有收付款单据已对账 (Reconciled) |
| **结账操作** | 标记 `period_status = CLOSED`，关闭本期编辑权限 |
| **跨期追溯** | 已关闭账期内的数据只能通过跨期调整凭证修改 |

---

## 四、并发账户安全

> [!WARNING]
> 当前版本的同账户高并发写入未实现数据库行级排他锁。大流量情况下建议：
> 1. 避免同一账户的同时多笔收付款操作
> 2. 事后通过对账报告核对数字完整性

---

## 五、金额计算规则

- 所有金额统一以**人民币（CNY）**为基准
- 金额精度：**分（0.01元）**
- 数据库存储为字符串 `Decimal`，避免浮点精度丢失
- 计算时应使用 `parseFloat()` 并在输出时 `.toFixed(2)`
